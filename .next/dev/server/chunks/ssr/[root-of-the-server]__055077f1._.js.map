{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/harsh/Downloads/PulseBank-main/PulseBank-main/hooks/useSocket.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useRef } from \"react\"\r\nimport { io, Socket } from \"socket.io-client\"\r\n\r\nlet globalSocket: Socket | null = null\r\n\r\nexport function useSocket() {\r\n  const socketRef = useRef<Socket | null>(null)\r\n\r\n  useEffect(() => {\r\n    // Reuse global socket instance to avoid multiple connections\r\n    if (!globalSocket) {\r\n      globalSocket = io(\"http://localhost:5000\", {\r\n        reconnection: true,\r\n        reconnectionDelay: 1000,\r\n        reconnectionDelayMax: 5000,\r\n        reconnectionAttempts: 5,\r\n      })\r\n\r\n      globalSocket.on(\"connect\", () => {\r\n        console.log(\"✅ Socket connected:\", globalSocket?.id)\r\n      })\r\n\r\n      globalSocket.on(\"disconnect\", () => {\r\n        console.log(\"❌ Socket disconnected\")\r\n      })\r\n\r\n      globalSocket.on(\"error\", (error) => {\r\n        console.error(\"Socket error:\", error)\r\n      })\r\n    }\r\n\r\n    socketRef.current = globalSocket\r\n\r\n    return () => {\r\n      // Don't disconnect here; keep the socket alive for reuse\r\n    }\r\n  }, [])\r\n\r\n  return socketRef\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAKA,IAAI,eAA8B;AAE3B,SAAS;IACd,MAAM,YAAY,IAAA,+MAAM,EAAgB;IAExC,IAAA,kNAAS,EAAC;QACR,6DAA6D;QAC7D,IAAI,CAAC,cAAc;YACjB,eAAe,IAAA,8LAAE,EAAC,yBAAyB;gBACzC,cAAc;gBACd,mBAAmB;gBACnB,sBAAsB;gBACtB,sBAAsB;YACxB;YAEA,aAAa,EAAE,CAAC,WAAW;gBACzB,QAAQ,GAAG,CAAC,uBAAuB,cAAc;YACnD;YAEA,aAAa,EAAE,CAAC,cAAc;gBAC5B,QAAQ,GAAG,CAAC;YACd;YAEA,aAAa,EAAE,CAAC,SAAS,CAAC;gBACxB,QAAQ,KAAK,CAAC,iBAAiB;YACjC;QACF;QAEA,UAAU,OAAO,GAAG;QAEpB,OAAO;QACL,yDAAyD;QAC3D;IACF,GAAG,EAAE;IAEL,OAAO;AACT","debugId":null}},
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/harsh/Downloads/PulseBank-main/PulseBank-main/components/LeafletMap.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { MapContainer, TileLayer, Marker, Popup } from \"react-leaflet\";\r\nimport L from \"leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\n\r\n// Create a custom red marker icon (no external PNG needed)\r\nconst createMarkerIcon = () => {\r\n  return L.divIcon({\r\n    html: `<div style=\"\r\n      background-color: #ef4444;\r\n      border: 2px solid white;\r\n      border-radius: 50%;\r\n      width: 24px;\r\n      height: 24px;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      box-shadow: 0 2px 6px rgba(0,0,0,0.3);\r\n      font-weight: bold;\r\n      color: white;\r\n      font-size: 12px;\r\n    \">♥</div>`,\r\n    className: \"custom-marker\",\r\n    iconSize: [24, 24],\r\n    iconAnchor: [12, 12],\r\n    popupAnchor: [0, -12],\r\n  });\r\n};\r\n\r\nexport default function LeafletMap({ activeDonors }: any) {\r\n  const [isClient, setIsClient] = useState(false);\r\n  const idRef = useState(() => `leaflet-${Math.random().toString(36).slice(2)}`)[0];\r\n  const mapRefKey = idRef; // key used to store map on window\r\n\r\n  useEffect(() => {\r\n    setIsClient(true);\r\n  }, []);\r\n\r\n  // Ensure any previously created map under this id is removed before creating a new one.\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return;\r\n    (window as any).__leaflet_map_instances = (window as any).__leaflet_map_instances || {};\r\n    const instances = (window as any).__leaflet_map_instances;\r\n    if (instances[mapRefKey]) {\r\n      try {\r\n        instances[mapRefKey].remove();\r\n      } catch (e) {\r\n        // ignore cleanup errors\r\n      }\r\n      delete instances[mapRefKey];\r\n    }\r\n\r\n    return () => {\r\n      if (instances[mapRefKey]) {\r\n        try {\r\n          instances[mapRefKey].remove();\r\n        } catch (e) {}\r\n        delete instances[mapRefKey];\r\n      }\r\n    };\r\n  }, [mapRefKey]);\r\n\r\n  const center =\r\n    activeDonors?.length > 0\r\n      ? ([activeDonors[0].location.latitude, activeDonors[0].location.longitude] as [number, number])\r\n      : ([21.1466, 79.0889] as [number, number]);\r\n\r\n  // Only render map on client side to prevent hydration mismatch\r\n  if (!isClient) {\r\n    return <div className=\"w-full h-full bg-gray-200\" />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"w-full h-full relative\">\r\n      <MapContainer\r\n        id={idRef}\r\n        center={center}\r\n        zoom={12}\r\n        style={{ height: \"100%\", width: \"100%\", position: \"absolute\", top: 0, left: 0 }}\r\n        whenCreated={(map) => {\r\n          (window as any).__leaflet_map_instances = (window as any).__leaflet_map_instances || {};\r\n          (window as any).__leaflet_map_instances[mapRefKey] = map;\r\n        }}\r\n      >\r\n        <TileLayer url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\" />\r\n\r\n        {(activeDonors || []).map((d: any, i: number) => (\r\n          <Marker \r\n            key={i} \r\n            position={[d.location.latitude, d.location.longitude]}\r\n            icon={createMarkerIcon()}\r\n          >\r\n            <Popup>\r\n              <div>\r\n                <b>{d.fullName}</b> <br />\r\n                Blood: {d.bloodType}\r\n              </div>\r\n            </Popup>\r\n          </Marker>\r\n        ))}\r\n      </MapContainer>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAJA;;;;;;AAOA,2DAA2D;AAC3D,MAAM,mBAAmB;IACvB,OAAO,4JAAC,CAAC,OAAO,CAAC;QACf,MAAM,CAAC;;;;;;;;;;;;;aAaE,CAAC;QACV,WAAW;QACX,UAAU;YAAC;YAAI;SAAG;QAClB,YAAY;YAAC;YAAI;SAAG;QACpB,aAAa;YAAC;YAAG,CAAC;SAAG;IACvB;AACF;AAEe,SAAS,WAAW,EAAE,YAAY,EAAO;IACtD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IACzC,MAAM,QAAQ,IAAA,iNAAQ,EAAC,IAAM,CAAC,QAAQ,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,IAAI,CAAC,CAAC,EAAE;IACjF,MAAM,YAAY,OAAO,kCAAkC;IAE3D,IAAA,kNAAS,EAAC;QACR,YAAY;IACd,GAAG,EAAE;IAEL,wFAAwF;IACxF,IAAA,kNAAS,EAAC;QACR,wCAAmC;;;QAEnC,MAAM;IAkBR,GAAG;QAAC;KAAU;IAEd,MAAM,SACJ,cAAc,SAAS,IAClB;QAAC,YAAY,CAAC,EAAE,CAAC,QAAQ,CAAC,QAAQ;QAAE,YAAY,CAAC,EAAE,CAAC,QAAQ,CAAC,SAAS;KAAC,GACvE;QAAC;QAAS;KAAQ;IAEzB,+DAA+D;IAC/D,IAAI,CAAC,UAAU;QACb,qBAAO,8OAAC;YAAI,WAAU;;;;;;IACxB;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC,uKAAY;YACX,IAAI;YACJ,QAAQ;YACR,MAAM;YACN,OAAO;gBAAE,QAAQ;gBAAQ,OAAO;gBAAQ,UAAU;gBAAY,KAAK;gBAAG,MAAM;YAAE;YAC9E,aAAa,CAAC;gBACX,OAAe,uBAAuB,GAAG,AAAC,OAAe,uBAAuB,IAAI,CAAC;gBACrF,OAAe,uBAAuB,CAAC,UAAU,GAAG;YACvD;;8BAEA,8OAAC,iKAAS;oBAAC,KAAI;;;;;;gBAEd,CAAC,gBAAgB,EAAE,EAAE,GAAG,CAAC,CAAC,GAAQ,kBACjC,8OAAC,2JAAM;wBAEL,UAAU;4BAAC,EAAE,QAAQ,CAAC,QAAQ;4BAAE,EAAE,QAAQ,CAAC,SAAS;yBAAC;wBACrD,MAAM;kCAEN,cAAA,8OAAC,yJAAK;sCACJ,cAAA,8OAAC;;kDACC,8OAAC;kDAAG,EAAE,QAAQ;;;;;;oCAAK;kDAAC,8OAAC;;;;;oCAAK;oCAClB,EAAE,SAAS;;;;;;;;;;;;uBAPlB;;;;;;;;;;;;;;;;AAejB","debugId":null}}]
}