{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/harsh/Downloads/PulseBank-main/PulseBank-main/components/donation-confirmation-modal.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { AlertCircle, CheckCircle, XCircle } from \"lucide-react\";\r\n\r\ninterface DonationConfirmationModalProps {\r\n  isOpen: boolean;\r\n  request: any;\r\n  onConfirm: () => void;\r\n  onReject: (notes?: string) => void;\r\n  isLoading?: boolean;\r\n}\r\n\r\nexport function DonationConfirmationModal({\r\n  isOpen,\r\n  request,\r\n  onConfirm,\r\n  onReject,\r\n  isLoading = false,\r\n}: DonationConfirmationModalProps) {\r\n  const [rejectNotes, setRejectNotes] = useState(\"\");\r\n  const [showRejectForm, setShowRejectForm] = useState(false);\r\n\r\n  if (!isOpen || !request) return null;\r\n\r\n  const isRecipient = request.isRecipientRequest;\r\n  const requestor = isRecipient ? (request.recipientName || \"Recipient\") : (request.hospital || \"Hospital\");\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-xl shadow-lg max-w-md w-full mx-4 p-8\">\r\n        <div className=\"flex justify-center mb-4\">\r\n          <AlertCircle className=\"w-12 h-12 text-red-600\" />\r\n        </div>\r\n\r\n        <h2 className=\"text-2xl font-bold text-center text-gray-900 mb-2\">\r\n          Confirm Donation?\r\n        </h2>\r\n\r\n        <div className=\"bg-gray-50 rounded-lg p-4 mb-6 space-y-2\">\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600\">From:</span>\r\n            <span className=\"font-semibold\">{requestor}</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600\">Blood Type:</span>\r\n            <span className=\"font-semibold text-red-600\">{request.bloodType}</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600\">Units Needed:</span>\r\n            <span className=\"font-semibold\">{request.unitsNeeded}</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600\">Distance:</span>\r\n            <span className=\"font-semibold\">{request.locationKm || \"N/A\"} km</span>\r\n          </div>\r\n        </div>\r\n\r\n        {showRejectForm ? (\r\n          <div className=\"mb-6\">\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              Why are you rejecting? (optional)\r\n            </label>\r\n            <textarea\r\n              value={rejectNotes}\r\n              onChange={(e) => setRejectNotes(e.target.value)}\r\n              placeholder=\"Enter reason for rejecting...\"\r\n              className=\"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500\"\r\n              rows={3}\r\n            />\r\n          </div>\r\n        ) : null}\r\n\r\n        <div className=\"flex gap-3\">\r\n          {showRejectForm ? (\r\n            <>\r\n              <button\r\n                onClick={() => {\r\n                  setShowRejectForm(false);\r\n                  setRejectNotes(\"\");\r\n                }}\r\n                disabled={isLoading}\r\n                className=\"flex-1 px-4 py-3 bg-gray-200 text-gray-900 rounded-lg font-semibold hover:bg-gray-300 disabled:opacity-50\"\r\n              >\r\n                Back\r\n              </button>\r\n              <button\r\n                onClick={() => {\r\n                  onReject(rejectNotes);\r\n                  setShowRejectForm(false);\r\n                  setRejectNotes(\"\");\r\n                }}\r\n                disabled={isLoading}\r\n                className=\"flex-1 px-4 py-3 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 disabled:opacity-50 flex items-center justify-center gap-2\"\r\n              >\r\n                <XCircle className=\"w-5 h-5\" />\r\n                Reject\r\n              </button>\r\n            </>\r\n          ) : (\r\n            <>\r\n              <button\r\n                onClick={() => setShowRejectForm(true)}\r\n                disabled={isLoading}\r\n                className=\"flex-1 px-4 py-3 bg-gray-200 text-gray-900 rounded-lg font-semibold hover:bg-gray-300 disabled:opacity-50\"\r\n              >\r\n                Reject\r\n              </button>\r\n              <button\r\n                onClick={onConfirm}\r\n                disabled={isLoading}\r\n                className=\"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2\"\r\n              >\r\n                <CheckCircle className=\"w-5 h-5\" />\r\n                Confirm\r\n              </button>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {isLoading && (\r\n          <p className=\"text-center text-sm text-gray-600 mt-3\">\r\n            Processing...\r\n          </p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;;;AAHA;;;AAaO,SAAS,0BAA0B,EACxC,MAAM,EACN,OAAO,EACP,SAAS,EACT,QAAQ,EACR,YAAY,KAAK,EACc;;IAC/B,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAC;IAErD,IAAI,CAAC,UAAU,CAAC,SAAS,OAAO;IAEhC,MAAM,cAAc,QAAQ,kBAAkB;IAC9C,MAAM,YAAY,cAAe,QAAQ,aAAa,IAAI,cAAgB,QAAQ,QAAQ,IAAI;IAE9F,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,sOAAW;wBAAC,WAAU;;;;;;;;;;;8BAGzB,6LAAC;oBAAG,WAAU;8BAAoD;;;;;;8BAIlE,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAK,WAAU;8CAAgB;;;;;;8CAChC,6LAAC;oCAAK,WAAU;8CAAiB;;;;;;;;;;;;sCAEnC,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAK,WAAU;8CAAgB;;;;;;8CAChC,6LAAC;oCAAK,WAAU;8CAA8B,QAAQ,SAAS;;;;;;;;;;;;sCAEjE,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAK,WAAU;8CAAgB;;;;;;8CAChC,6LAAC;oCAAK,WAAU;8CAAiB,QAAQ,WAAW;;;;;;;;;;;;sCAEtD,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAK,WAAU;8CAAgB;;;;;;8CAChC,6LAAC;oCAAK,WAAU;;wCAAiB,QAAQ,UAAU,IAAI;wCAAM;;;;;;;;;;;;;;;;;;;gBAIhE,+BACC,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAM,WAAU;sCAA+C;;;;;;sCAGhE,6LAAC;4BACC,OAAO;4BACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;4BAC9C,aAAY;4BACZ,WAAU;4BACV,MAAM;;;;;;;;;;;2BAGR;8BAEJ,6LAAC;oBAAI,WAAU;8BACZ,+BACC;;0CACE,6LAAC;gCACC,SAAS;oCACP,kBAAkB;oCAClB,eAAe;gCACjB;gCACA,UAAU;gCACV,WAAU;0CACX;;;;;;0CAGD,6LAAC;gCACC,SAAS;oCACP,SAAS;oCACT,kBAAkB;oCAClB,eAAe;gCACjB;gCACA,UAAU;gCACV,WAAU;;kDAEV,6LAAC,0NAAO;wCAAC,WAAU;;;;;;oCAAY;;;;;;;;qDAKnC;;0CACE,6LAAC;gCACC,SAAS,IAAM,kBAAkB;gCACjC,UAAU;gCACV,WAAU;0CACX;;;;;;0CAGD,6LAAC;gCACC,SAAS;gCACT,UAAU;gCACV,WAAU;;kDAEV,6LAAC,6OAAW;wCAAC,WAAU;;;;;;oCAAY;;;;;;;;;;;;;;gBAO1C,2BACC,6LAAC;oBAAE,WAAU;8BAAyC;;;;;;;;;;;;;;;;;AAOhE;GAnHgB;KAAA","debugId":null}},
    {"offset": {"line": 302, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/harsh/Downloads/PulseBank-main/PulseBank-main/hooks/useSocket.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useRef } from \"react\"\r\nimport { io, Socket } from \"socket.io-client\"\r\n\r\nlet globalSocket: Socket | null = null\r\n\r\nexport function useSocket() {\r\n  const socketRef = useRef<Socket | null>(null)\r\n\r\n  useEffect(() => {\r\n    // Reuse global socket instance to avoid multiple connections\r\n    if (!globalSocket) {\r\n      globalSocket = io(\"http://localhost:5000\", {\r\n        reconnection: true,\r\n        reconnectionDelay: 1000,\r\n        reconnectionDelayMax: 5000,\r\n        reconnectionAttempts: 5,\r\n      })\r\n\r\n      globalSocket.on(\"connect\", () => {\r\n        console.log(\"âœ… Socket connected:\", globalSocket?.id)\r\n      })\r\n\r\n      globalSocket.on(\"disconnect\", () => {\r\n        console.log(\"âŒ Socket disconnected\")\r\n      })\r\n\r\n      globalSocket.on(\"error\", (error) => {\r\n        console.error(\"Socket error:\", error)\r\n      })\r\n    }\r\n\r\n    socketRef.current = globalSocket\r\n\r\n    return () => {\r\n      // Don't disconnect here; keep the socket alive for reuse\r\n    }\r\n  }, [])\r\n\r\n  return socketRef\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;;AAHA;;;AAKA,IAAI,eAA8B;AAE3B,SAAS;;IACd,MAAM,YAAY,IAAA,uKAAM,EAAgB;IAExC,IAAA,0KAAS;+BAAC;YACR,6DAA6D;YAC7D,IAAI,CAAC,cAAc;gBACjB,eAAe,IAAA,wLAAE,EAAC,yBAAyB;oBACzC,cAAc;oBACd,mBAAmB;oBACnB,sBAAsB;oBACtB,sBAAsB;gBACxB;gBAEA,aAAa,EAAE,CAAC;2CAAW;wBACzB,QAAQ,GAAG,CAAC,uBAAuB,cAAc;oBACnD;;gBAEA,aAAa,EAAE,CAAC;2CAAc;wBAC5B,QAAQ,GAAG,CAAC;oBACd;;gBAEA,aAAa,EAAE,CAAC;2CAAS,CAAC;wBACxB,QAAQ,KAAK,CAAC,iBAAiB;oBACjC;;YACF;YAEA,UAAU,OAAO,GAAG;YAEpB;uCAAO;gBACL,yDAAyD;gBAC3D;;QACF;8BAAG,EAAE;IAEL,OAAO;AACT;GAlCgB","debugId":null}},
    {"offset": {"line": 360, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/harsh/Downloads/PulseBank-main/PulseBank-main/app/donor/dashboard/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { DonationConfirmationModal } from \"@/components/donation-confirmation-modal\";\r\nimport dynamic from \"next/dynamic\";\r\n\r\nconst LeafletMap = dynamic(() => import(\"@/components/LeafletMap\"), { ssr: false });\r\nconst HospitalRequestsMap = dynamic(() => import(\"@/components/HospitalRequestsMap\"), { ssr: false });\r\nimport Link from \"next/link\";\r\nimport { useEffect, useState, useRef } from \"react\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\nimport {\r\n  Heart,\r\n  Droplet,\r\n  MapPin,\r\n  CheckCircle,\r\n  Play,\r\n  Calendar,\r\n  Clock,\r\n  FileText,\r\n  Gift,\r\n  LogOut,\r\n  X,\r\n  Droplets,\r\n  Hospital,\r\n  Baby,\r\n  Target,\r\n  Zap,\r\n  Star,\r\n  Ambulance,\r\n  AlertCircle,\r\n} from \"lucide-react\";\r\nimport { useSocket } from \"@/hooks/useSocket\";\r\n\r\nexport default function DonorDashboard() {\r\n  const [history, setHistory] = useState<any[]>([]);\r\n  const [requests, setRequests] = useState<any[]>([]);\r\n  const [hospitalRequests, setHospitalRequests] = useState<any[]>([]);\r\n  const [recipientRequests, setRecipientRequests] = useState<any[]>([]);\r\n  const [schedules, setSchedules] = useState<any[]>([]);\r\n  const [donorId, setDonorId] = useState<string | null>(null);\r\n  const [donorName, setDonorName] = useState(\"Donor\");\r\n  const [donorEmail, setDonorEmail] = useState(\"\");\r\n  const [donorPhone, setDonorPhone] = useState(\"\");\r\n  const [donorImage, setDonorImage] = useState(\"\");\r\n  const [showProfileMenu, setShowProfileMenu] = useState(false);\r\n\r\n  const [location, setLocation] = useState<{ lat: number; lng: number } | null>(null);\r\n  const [available, setAvailable] = useState<boolean>(false);\r\n  const [locationSharing, setLocationSharing] = useState<boolean>(false);\r\n  const [sleepTime, setSleepTime] = useState<number>(20);\r\n  const [currentQuoteIndex, setCurrentQuoteIndex] = useState<number>(0);\r\n\r\n  // Auto-play video ON login, user asked this. Use true initially.\r\n  const [showVideo, setShowVideo] = useState<boolean>(true);\r\n\r\n  // Donation confirmation modal state\r\n  const [showConfirmModal, setShowConfirmModal] = useState<boolean>(false);\r\n  const [selectedRequest, setSelectedRequest] = useState<any>(null);\r\n  const [confirmLoading, setConfirmLoading] = useState<boolean>(false);\r\n\r\n  const socketRef = useSocket();\r\n\r\n  // Motivational quotes for blood donors\r\n  const motivationalQuotes = [\r\n    \"ðŸ©¸ Your donation saves up to 3 lives. Be a hero today!\",\r\n    \"ðŸ©¸ One donation, three lives. You have the power to help.\",\r\n    \"ðŸ©¸ Blood donation is a gift of love. Give today, save a life tomorrow.\",\r\n    \"ðŸ©¸ Donate blood. It's the simplest way to make a difference.\",\r\n    \"ðŸ©¸ Every drop counts. Your blood donation matters more than you know.\",\r\n    \"ðŸ©¸ Be someone's type O positive. Donate blood today.\",\r\n    \"ðŸ©¸ A patient without blood is a patient without hope. Donate now.\",\r\n    \"ðŸ©¸ Your generosity flows through us. Thank you for donating!\",\r\n    \"ðŸ©¸ Blood donation is the greatest gift of all. Keep giving.\",\r\n    \"ðŸ©¸ Donate blood and become a real-life superhero.\"\r\n  ];\r\n\r\n  const [isRefreshing, setIsRefreshing] = useState(false);\r\n\r\n  /* -----------------------------------------------\r\n      REFRESH ALL DATA\r\n  ----------------------------------------------------------*/\r\n  const handleRefresh = async () => {\r\n    setIsRefreshing(true);\r\n    // Fetch history and schedules\r\n    if (donorId) {\r\n      try {\r\n        const historyRes = await fetch(`http://localhost:5000/donor/history/${donorId}`);\r\n        const historyData = await historyRes.json();\r\n        setHistory(historyData.donations || []);\r\n\r\n        const schedulesRes = await fetch(`http://localhost:5000/schedule/donor/${donorId}`);\r\n        const schedulesData = await schedulesRes.json();\r\n        setSchedules(schedulesData.schedules || []);\r\n      } catch (err) {\r\n        console.error(\"Refresh error:\", err);\r\n      }\r\n    }\r\n    // Fetch all requests\r\n    await loadRequests();\r\n    setIsRefreshing(false);\r\n  };\r\n\r\n      // LOAD DONOR ID (from token)\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n    const stored = localStorage.getItem(\"user\");\r\n    if (token) {\r\n      try {\r\n        const decoded: any = jwtDecode(token);\r\n        setDonorId(decoded.userId);\r\n      } catch (e) {\r\n        console.error(\"Invalid token\", e);\r\n      }\r\n    }\r\n    if (stored) {\r\n      const user = JSON.parse(stored);\r\n      console.log(\"[Dashboard] Loading user from localStorage:\", user);\r\n      console.log(\"[Dashboard] Profile image:\", user.profileImage);\r\n      setDonorName(user.fullName || \"Donor\");\r\n      setDonorEmail(user.email || \"\");\r\n      setDonorPhone(user.phone || \"\");\r\n      setDonorImage(user.profileImage || \"\");\r\n      // Load availability status\r\n      setAvailable(user.available || false);\r\n      setSleepTime(user.sleepTime || 20);\r\n      \r\n      // Check if location sharing was auto-disabled due to sleep time expiry\r\n      if (user.locationSharingStoppedAt) {\r\n        const stoppedTime = new Date(user.locationSharingStoppedAt).getTime();\r\n        const sleepDuration = (user.sleepTime || 20) * 60 * 1000; // Convert to milliseconds\r\n        const currentTime = new Date().getTime();\r\n        \r\n        if (currentTime - stoppedTime > sleepDuration) {\r\n          // Sleep time has expired, clear location\r\n          setLocationSharing(false);\r\n          setLocation(null);\r\n          // Clear from localStorage and backend\r\n          user.locationSharingStoppedAt = null;\r\n          localStorage.setItem(\"user\", JSON.stringify(user));\r\n        } else {\r\n          // Still within sleep time\r\n          setLocationSharing(true);\r\n        }\r\n      } else {\r\n        setLocationSharing(user.locationSharing || false);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Keep donor info (including avatar) in sync with profile page updates\r\n  useEffect(() => {\r\n    const onUserUpdated = (event: any) => {\r\n      const updated = event?.detail || {};\r\n      setDonorName(updated.fullName || \"Donor\");\r\n      setDonorEmail(updated.email || \"\");\r\n      setDonorPhone(updated.phone || \"\");\r\n      setDonorImage(updated.profileImage || \"\");\r\n    };\r\n\r\n    window.addEventListener(\"user-updated\", onUserUpdated as EventListener);\r\n    return () => window.removeEventListener(\"user-updated\", onUserUpdated as EventListener);\r\n  }, []);\r\n\r\n  // Also sync when localStorage changes (e.g., profile updated in another tab)\r\n  useEffect(() => {\r\n    const syncFromStorage = () => {\r\n      const storedUser = localStorage.getItem(\"user\");\r\n      if (!storedUser) return;\r\n      try {\r\n        const parsed = JSON.parse(storedUser);\r\n        setDonorName(parsed.fullName || \"Donor\");\r\n        setDonorEmail(parsed.email || \"\");\r\n        setDonorPhone(parsed.phone || \"\");\r\n        setDonorImage(parsed.profileImage || \"\");\r\n      } catch (e) {\r\n        console.error(\"Unable to parse stored user\", e);\r\n      }\r\n    };\r\n\r\n    window.addEventListener(\"storage\", syncFromStorage);\r\n    return () => window.removeEventListener(\"storage\", syncFromStorage);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const quoteInterval = setInterval(() => {\r\n      setCurrentQuoteIndex((prevIndex) => (prevIndex + 1) % motivationalQuotes.length);\r\n    }, 8000);\r\n    return () => clearInterval(quoteInterval);\r\n  }, [motivationalQuotes.length]);\r\n\r\n  //     // SOCKET â€“ LISTEN FOR REAL-TIME UPDATES\r\n  // ----------------------------------------------------------*/\r\n  useEffect(() => {\r\n    const socket = socketRef.current;\r\n    if (!socket) return;\r\n\r\n    socket.emit(\"register\", donorId);\r\n\r\n    socket.on(\"schedule_status_updated\", (data: any) => {\r\n      console.log(\"[Socket] Schedule status updated:\", data);\r\n      setSchedules((prev) =>\r\n        prev.map((s) => (s._id === data.scheduleId ? { ...s, status: data.status } : s))\r\n      );\r\n      loadSchedules(); // Reload all schedules and requests\r\n      alert(`Your donation schedule was ${data.status.toUpperCase()}`);\r\n    });\r\n\r\n    // Listen for new requests created by hospitals and auto-refresh\r\n    socket.on(\"request_created\", (payload: any) => {\r\n      if (!payload || !payload._id) return;\r\n      setRequests((prev) => (prev.some((r: any) => r._id === payload._id) ? prev : [payload, ...prev]));\r\n\r\n      // Insert into hospitalRequests or recipientRequests depending on flag\r\n      if (payload.isRecipientRequest) {\r\n        setRecipientRequests((prev) => (prev.some((r: any) => r._id === payload._id) ? prev : [payload, ...prev]));\r\n      } else if (payload.hospital && payload.hospital !== \"\") {\r\n        setHospitalRequests((prev) => (prev.some((r: any) => r._id === payload._id) ? prev : [payload, ...prev]));\r\n      }\r\n\r\n      console.log(\"New request created:\", payload);\r\n    });\r\n\r\n    // Listen for availability changes from other donors (optional)\r\n    socket.on(\"availability_changed\", (payload: any) => {\r\n      console.log(\"Donor availability updated:\", payload);\r\n    });\r\n\r\n    // Listen for request fulfilled (when hospital marks donation completed)\r\n    socket.on(\"request_fulfilled\", (payload: any) => {\r\n      // Remove fulfilled request from active requests\r\n      setRequests((prev) => prev.filter((r: any) => r._id !== payload.requestId));\r\n      setHospitalRequests((prev) => prev.filter((r: any) => r._id !== payload.requestId));\r\n      setRecipientRequests((prev) => prev.filter((r: any) => r._id !== payload.requestId));\r\n      \r\n      // Add to history\r\n      setHistory((prev) => [...prev, {\r\n        _id: payload.requestId,\r\n        units: payload.unitsNeeded,\r\n        bloodType: payload.bloodType,\r\n        date: new Date(),\r\n      }]);\r\n    });\r\n\r\n    // Listen for donation confirmation/rejection status updates\r\n    socket.on(\"request_confirmed\", (payload: any) => {\r\n      if (!payload || !payload._id) return;\r\n\r\n      console.log(\"Request confirmation status updated:\", payload);\r\n\r\n      // Update the request in both hospital and recipient request lists\r\n      setHospitalRequests((prev) =>\r\n        prev.map((r: any) =>\r\n          r._id === payload._id\r\n            ? {\r\n                ...r,\r\n                confirmationStatus: payload.confirmationStatus,\r\n                confirmedBy: payload.confirmedBy,\r\n                confirmationNotes: payload.confirmationNotes,\r\n              }\r\n            : r\r\n        )\r\n      );\r\n\r\n      setRecipientRequests((prev) =>\r\n        prev.map((r: any) =>\r\n          r._id === payload._id\r\n            ? {\r\n                ...r,\r\n                confirmationStatus: payload.confirmationStatus,\r\n                confirmedBy: payload.confirmedBy,\r\n                confirmationNotes: payload.confirmationNotes,\r\n              }\r\n            : r\r\n        )\r\n      );\r\n\r\n      // Update the main requests list\r\n      setRequests((prev) =>\r\n        prev.map((r: any) =>\r\n          r._id === payload._id\r\n            ? {\r\n                ...r,\r\n                confirmationStatus: payload.confirmationStatus,\r\n                confirmedBy: payload.confirmedBy,\r\n                confirmationNotes: payload.confirmationNotes,\r\n              }\r\n            : r\r\n        )\r\n      );\r\n    });\r\n\r\n    // Listen for donation completion (when scheduled time arrives)\r\n    socket.on(\"donation_completed\", (payload: any) => {\r\n      if (!payload || !payload.requestId) return;\r\n\r\n      console.log(\"Donation completed (time reached):\", payload);\r\n\r\n      // Update the request status to \"Successful\"\r\n      setHospitalRequests((prev) =>\r\n        prev.map((r: any) =>\r\n          r._id === payload.requestId\r\n            ? {\r\n                ...r,\r\n                confirmationStatus: \"Successful\",\r\n                status: \"Fulfilled\",\r\n              }\r\n            : r\r\n        )\r\n      );\r\n\r\n      setRecipientRequests((prev) =>\r\n        prev.map((r: any) =>\r\n          r._id === payload.requestId\r\n            ? {\r\n                ...r,\r\n                confirmationStatus: \"Successful\",\r\n                status: \"Fulfilled\",\r\n              }\r\n            : r\r\n        )\r\n      );\r\n\r\n      setRequests((prev) =>\r\n        prev.map((r: any) =>\r\n          r._id === payload.requestId\r\n            ? {\r\n                ...r,\r\n                confirmationStatus: \"Successful\",\r\n                status: \"Fulfilled\",\r\n              }\r\n            : r\r\n        )\r\n      );\r\n    });\r\n\r\n    return () => {\r\n      socket.off(\"schedule_status_updated\");\r\n      socket.off(\"request_created\");\r\n      socket.off(\"availability_changed\");\r\n      socket.off(\"request_fulfilled\");\r\n      socket.off(\"request_confirmed\");\r\n      socket.off(\"donation_completed\");\r\n    };\r\n  }, [donorId, socketRef]);\r\n\r\n  //     FETCH HISTORY\r\n  // ----------------------------------------------------------*/\r\n  useEffect(() => {\r\n    if (!donorId) return;\r\n    fetch(`http://localhost:5000/donor/history/${donorId}`)\r\n      .then((res) => res.json())\r\n      .then((data) => setHistory(data.donations || []))\r\n      .catch((err) => console.error(\"history fetch error\", err));\r\n  }, [donorId]);\r\n\r\n  //     FETCH SCHEDULES (with deduplication)\r\n  // ----------------------------------------------------------*/\r\n  const loadRequests = async () => {\r\n    try {\r\n      const reqRes = await fetch(\"http://localhost:5000/request/all\");\r\n      const reqData = await reqRes.json();\r\n      const all = reqData.requests || [];\r\n      \r\n      console.log(\"[Dashboard] Fetched raw requests:\", all.length);\r\n      if (all.length > 0) {\r\n        console.log(\"[Dashboard] Sample raw request:\", {\r\n          hospital: all[0].hospital,\r\n          phone: all[0].phone,\r\n          address: all[0].address,\r\n          location: all[0].location\r\n        });\r\n      }\r\n      \r\n      // Calculate distance from donor location to hospital location (Haversine formula)\r\n      const calculateDistance = (lat1: number, lon1: number, lat2: number, lon2: number) => {\r\n        const R = 6371; // Earth's radius in km\r\n        const dLat = (lat2 - lat1) * Math.PI / 180;\r\n        const dLon = (lon2 - lon1) * Math.PI / 180;\r\n        const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n          Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\r\n          Math.sin(dLon / 2) * Math.sin(dLon / 2);\r\n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n        return Math.round(R * c * 10) / 10; // Round to 1 decimal place\r\n      };\r\n      \r\n      // Calculate distance if donor has shared location\r\n      const withDistances = all.map((r: any) => {\r\n        if (location && r.location && r.location.latitude && r.location.longitude) {\r\n          const distance = calculateDistance(\r\n            location.lat,\r\n            location.lng,\r\n            r.location.latitude,\r\n            r.location.longitude\r\n          );\r\n          console.log(`[Dashboard] Distance calc: Donor(${location.lat.toFixed(4)}, ${location.lng.toFixed(4)}) -> Hospital ${r.hospital}(${r.location.latitude}, ${r.location.longitude}) = ${distance}km`);\r\n          return { ...r, calculatedDistance: distance };\r\n        }\r\n        return r;\r\n      });\r\n      \r\n      // Filter hospitals: only those with valid locations AND within 20km radius\r\n      const hospitals = withDistances.filter((r: any) => \r\n        r.hospital && r.hospital !== \"\" && !r.isRecipientRequest &&\r\n        r.location && r.location.latitude && r.location.longitude &&\r\n        (location ? r.calculatedDistance <= 20 : false) // Only show if within 20km when location is shared\r\n      );\r\n      \r\n      // Filter recipient requests: must have location AND within 20km AND marked as recipient request\r\n      const recipients = withDistances.filter((r: any) => \r\n        r.isRecipientRequest === true &&\r\n        r.location && r.location.latitude && r.location.longitude &&\r\n        (location ? r.calculatedDistance <= 20 : true) // Show if within 20km or no location shared\r\n      );\r\n      \r\n      // Show ALL hospital requests (no deduplication) - each request is different and should be displayed\r\n      setHospitalRequests(hospitals);\r\n      setRecipientRequests(recipients);\r\n      setRequests(withDistances);\r\n      console.log(\"[Dashboard] Loaded hospitals within 20km:\", hospitals.length);\r\n      if (hospitals.length > 0) {\r\n        const sample = hospitals[0] as any;\r\n        console.log(\"[Dashboard] Sample hospital after processing:\", {\r\n          hospital: sample.hospital,\r\n          phone: sample.phone,\r\n          address: sample.address,\r\n          calculatedDistance: sample.calculatedDistance,\r\n          location: sample.location\r\n        });\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Request fetch error:\", err);\r\n    }\r\n  };\r\n\r\n  const loadSchedules = async () => {\r\n    if (!donorId) return;\r\n    try {\r\n      const res = await fetch(`http://localhost:5000/schedule/donor/${donorId}`);\r\n      const data = await res.json();\r\n      const allSchedules = data.schedules || [];\r\n      // Remove duplicates based on requestId\r\n      const uniqueSchedules = Array.from(\r\n        new Map(\r\n          allSchedules.map((s: any) => [\r\n            s.requestId?._id || s.requestId || s._id,\r\n            s,\r\n          ])\r\n        ).values()\r\n      );\r\n      setSchedules(uniqueSchedules);\r\n      console.log(\"[Dashboard] Loaded schedules:\", uniqueSchedules);\r\n      // Reload requests after schedules to show updated request status\r\n      loadRequests();\r\n    } catch (err) {\r\n      console.error(\"schedules fetch err\", err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadSchedules();\r\n  }, [donorId]);\r\n\r\n  // Auto-refresh schedules when page loads (in case coming back from schedule page)\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      loadSchedules();\r\n    }, 500);\r\n    return () => clearTimeout(timer);\r\n  }, [donorId]);\r\n\r\n  // Auto-request location on page load if not already shared\r\n  useEffect(() => {\r\n    if (!location && donorId) {\r\n      const timer = setTimeout(() => {\r\n        if (!navigator.geolocation) return;\r\n        navigator.geolocation.getCurrentPosition(\r\n          (pos) => {\r\n            const newLocation = { lat: pos.coords.latitude, lng: pos.coords.longitude };\r\n            setLocation(newLocation);\r\n            console.log(\"[Donor Dashboard] Location auto-requested:\", pos.coords);\r\n          },\r\n          (err) => {\r\n            console.log(\"[Donor Dashboard] Location permission denied or error:\", err);\r\n            // Still load requests even if location fails - they'll show without distance filter\r\n            loadRequests();\r\n          },\r\n          { enableHighAccuracy: true, timeout: 15000 }\r\n        );\r\n      }, 500);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [donorId]);\r\n\r\n  // Reload requests whenever location changes to update distance calculations\r\n  useEffect(() => {\r\n    if (location) {\r\n      loadRequests();\r\n    }\r\n  }, [location]);\r\n\r\n  //     FETCH URGENT REQUESTS & CALCULATE DISTANCES\r\n  // ----------------------------------------------------------*/\r\n  // Handled by loadRequests() function and its useEffect hook\r\n\r\n  //     getLocation (explicit click -> forces browser permission popup)\r\n  //     - we DO NOT auto-mark available here.\r\n  // ----------------------------------------------------------*/\r\n  const requestLocation = () => {\r\n    if (!navigator.geolocation) return alert(\"Your browser does not support location\");\r\n    navigator.geolocation.getCurrentPosition(\r\n      async (pos) => {\r\n        const newLocation = { lat: pos.coords.latitude, lng: pos.coords.longitude };\r\n        console.log(\"[Donor Dashboard] Location shared:\", newLocation);\r\n        setLocation(newLocation);\r\n        setLocationSharing(true);\r\n        // Save to localStorage\r\n        const stored = localStorage.getItem(\"user\");\r\n        if (stored) {\r\n          const user = JSON.parse(stored);\r\n          user.locationSharing = true;\r\n          user.locationSharingStoppedAt = null;\r\n          localStorage.setItem(\"user\", JSON.stringify(user));\r\n        }\r\n        // Wait a moment for state to update, then reload requests\r\n        setTimeout(async () => {\r\n          await loadRequests();\r\n          console.log(\"[Donor Dashboard] Requests reloaded after location share\");\r\n        }, 100);\r\n        alert(\"Location captured and sharing enabled\");\r\n      },\r\n      (err) => {\r\n        console.error(\"[Donor Dashboard] Geolocation error:\", err);\r\n        if (err.code === 1) alert(\"Please allow location access\");\r\n        else alert(\"Unable to fetch location\");\r\n      },\r\n      { enableHighAccuracy: true, timeout: 15000 }\r\n    );\r\n  };\r\n\r\n  //     markAvailable: only marks available after user clicked \"Share Location\" (so location exists)\r\n  // ----------------------------------------------------------*/\r\n  const markAvailable = async () => {\r\n    if (!donorId) return alert(\"âš  Not logged in\");\r\n    if (!location) return alert(\"âš  Please share your location first!\");\r\n\r\n    try {\r\n      const res = await fetch(\"http://localhost:5000/donor/availability\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          donorId,\r\n          available: true,\r\n          latitude: location.lat,\r\n          longitude: location.lng,\r\n        }),\r\n      });\r\n      const data = await res.json();\r\n      if (data.success) {\r\n        setAvailable(true);\r\n        // Save to localStorage\r\n        const stored = localStorage.getItem(\"user\");\r\n        if (stored) {\r\n          const user = JSON.parse(stored);\r\n          user.available = true;\r\n          localStorage.setItem(\"user\", JSON.stringify(user));\r\n        }\r\n      } else {\r\n        alert(\"Error: \" + (data.message || \"Could not mark available\"));\r\n      }\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert(\"Network error while marking availability\");\r\n    }\r\n  };\r\n\r\n  const markUnavailable = async () => {\r\n    if (!donorId) return alert(\"âš  Not logged in\");\r\n    try {\r\n      const res = await fetch(\"http://localhost:5000/donor/availability\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ donorId, available: false }),\r\n      });\r\n      const data = await res.json();\r\n      if (data.success) {\r\n        setAvailable(false);\r\n        // Save to localStorage\r\n        const stored = localStorage.getItem(\"user\");\r\n        if (stored) {\r\n          const user = JSON.parse(stored);\r\n          user.available = false;\r\n          localStorage.setItem(\"user\", JSON.stringify(user));\r\n        }\r\n      } else {\r\n        alert(\"Error: \" + (data.message || \"Could not mark unavailable\"));\r\n      }\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert(\"Network error while marking unavailable\");\r\n    }\r\n  };\r\n\r\n  const stopLocationSharing = () => {\r\n    setLocationSharing(false);\r\n    setLocation(null);\r\n    setHospitalRequests([]); // Clear hospital requests when location is not shared\r\n    \r\n    // Save to localStorage\r\n    const stored = localStorage.getItem(\"user\");\r\n    if (stored) {\r\n      const user = JSON.parse(stored);\r\n      user.locationSharing = false;\r\n      user.locationSharingStoppedAt = null;\r\n      localStorage.setItem(\"user\", JSON.stringify(user));\r\n    }\r\n    alert(\"Location sharing stopped\");\r\n  };\r\n\r\n  //     DONATION CONFIRMATION HANDLERS\r\n  // ----------------------------------------------------------*/\r\n  const handleOpenConfirmModal = (request: any) => {\r\n    setSelectedRequest(request);\r\n    setShowConfirmModal(true);\r\n  };\r\n\r\n  const handleConfirmDonation = async () => {\r\n    if (!selectedRequest) return;\r\n    \r\n    // Call API to confirm donation\r\n    setConfirmLoading(true);\r\n    try {\r\n      const res = await fetch(`http://localhost:5000/request/${selectedRequest._id}/confirm`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          action: \"Confirmed\",\r\n          confirmedBy: donorId,\r\n          notes: \"Donor confirmed and will proceed to schedule donation.\",\r\n        }),\r\n      });\r\n      const data = await res.json();\r\n      if (data.success) {\r\n        // Send emails to hospital, donor, and recipient\r\n        try {\r\n          await fetch(\"http://localhost:5000/email/send-donation-scheduled\", {\r\n            method: \"POST\",\r\n            headers: { \"Content-Type\": \"application/json\" },\r\n            body: JSON.stringify({\r\n              requestId: selectedRequest._id,\r\n              donorId: donorId,\r\n              donorName: donorName,\r\n              donorEmail: donorEmail,\r\n              hospital: selectedRequest.hospital,\r\n              bloodType: selectedRequest.bloodType,\r\n              units: selectedRequest.unitsNeeded,\r\n              recipientName: selectedRequest.recipientName,\r\n              recipientEmail: selectedRequest.recipientEmail,\r\n              isRecipientRequest: selectedRequest.isRecipientRequest,\r\n            }),\r\n          });\r\n        } catch (emailErr) {\r\n          console.error(\"Error sending emails:\", emailErr);\r\n        }\r\n\r\n        // Close modal and navigate to schedule page\r\n        setShowConfirmModal(false);\r\n        window.location.href = `/donor/schedule-donation?requestId=${selectedRequest._id}&hospital=${encodeURIComponent(\r\n          selectedRequest.hospital || \"\"\r\n        )}&units=${selectedRequest.unitsNeeded}&bloodType=${selectedRequest.bloodType}`;\r\n      } else {\r\n        alert(\"Error confirming donation: \" + (data.message || \"Unknown error\"));\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error confirming donation:\", err);\r\n      alert(\"Network error while confirming donation\");\r\n    } finally {\r\n      setConfirmLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRejectDonation = async (notes?: string) => {\r\n    if (!selectedRequest) return;\r\n\r\n    setConfirmLoading(true);\r\n    try {\r\n      const res = await fetch(`http://localhost:5000/request/${selectedRequest._id}/confirm`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          action: \"Rejected\",\r\n          confirmedBy: donorId,\r\n          notes: notes || \"Donor rejected donation request.\",\r\n        }),\r\n      });\r\n      const data = await res.json();\r\n      if (data.success) {\r\n        // Update local state to reflect rejection\r\n        setHospitalRequests((prev) =>\r\n          prev.map((r) =>\r\n            r._id === selectedRequest._id\r\n              ? { ...r, confirmationStatus: \"Rejected\" }\r\n              : r\r\n          )\r\n        );\r\n        setRecipientRequests((prev) =>\r\n          prev.map((r) =>\r\n            r._id === selectedRequest._id\r\n              ? { ...r, confirmationStatus: \"Rejected\" }\r\n              : r\r\n          )\r\n        );\r\n        setShowConfirmModal(false);\r\n        alert(\"Donation rejected. Hospital has been notified.\");\r\n      } else {\r\n        alert(\"Error rejecting donation: \" + (data.message || \"Unknown error\"));\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error rejecting donation:\", err);\r\n      alert(\"Network error while rejecting donation\");\r\n    } finally {\r\n      setConfirmLoading(false);\r\n    }\r\n  };\r\n\r\n  //     UI\r\n  // ----------------------------------------------------------*/\r\n  return (\r\n    <main className=\"min-h-screen bg-linear-to-br from-white via-red-50 to-white\">\r\n      {/* HEADER */}\r\n      <header className=\"bg-red-600 text-white p-6 shadow-lg flex justify-between items-center sticky top-0 z-50\">\r\n        <div className=\"flex items-center gap-3 text-2xl font-bold\">\r\n          <Heart className=\"w-7 h-7 fill-white\" />\r\n          {donorName}\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-3 relative\">\r\n          <button\r\n            onClick={() => setShowProfileMenu(!showProfileMenu)}\r\n            className=\"p-2 rounded-full hover:bg-red-500 transition bg-white text-red-600 w-10 h-10 flex items-center justify-center\"\r\n            title=\"Profile menu\"\r\n          >\r\n            ðŸ‘¤\r\n          </button>\r\n\r\n          {showProfileMenu && (\r\n            <div className=\"absolute right-0 top-12 bg-gradient-to-b from-white to-gray-50 text-gray-800 rounded-2xl shadow-2xl w-64 z-40 border border-red-100 overflow-hidden\">\r\n              {/* Profile Info Section */}\r\n              <div className=\"p-5 bg-gradient-to-r from-red-50 to-red-100 border-b-2 border-red-200\">\r\n                <p className=\"font-bold text-lg text-red-700\">{donorName}</p>\r\n                <p className=\"text-sm text-gray-600 mt-1\">{donorEmail}</p>\r\n                <p className=\"text-sm text-gray-600\">{donorPhone}</p>\r\n              </div>\r\n              \r\n              {/* Menu Items */}\r\n              <div className=\"py-2\">\r\n                <Link\r\n                  href=\"/donor/profile\"\r\n                  className=\"flex items-center gap-3 px-4 py-3 hover:bg-red-50 text-gray-800 transition border-l-4 border-transparent hover:border-red-600\"\r\n                  onClick={() => setShowProfileMenu(false)}\r\n                >\r\n                  <FileText className=\"w-5 h-5 text-red-600\" />\r\n                  <span className=\"font-medium\">Edit Profile</span>\r\n                </Link>\r\n                <Link\r\n                  href=\"/donor/history\"\r\n                  className=\"flex items-center gap-3 px-4 py-3 hover:bg-orange-50 text-gray-800 transition border-l-4 border-transparent hover:border-orange-600\"\r\n                  onClick={() => setShowProfileMenu(false)}\r\n                >\r\n                  <Calendar className=\"w-5 h-5 text-orange-600\" />\r\n                  <span className=\"font-medium\">View History</span>\r\n                </Link>\r\n                <Link\r\n                  href=\"/donor/perks\"\r\n                  className=\"flex items-center gap-3 px-4 py-3 hover:bg-yellow-50 text-gray-800 transition border-l-4 border-transparent hover:border-yellow-600\"\r\n                  onClick={() => setShowProfileMenu(false)}\r\n                >\r\n                  <Gift className=\"w-5 h-5 text-yellow-600\" />\r\n                  <span className=\"font-medium\">View Perks</span>\r\n                </Link>\r\n                <button\r\n                  onClick={() => {\r\n                    // Save location sharing stop time if location is active\r\n                    if (locationSharing) {\r\n                      const stored = localStorage.getItem(\"user\");\r\n                      if (stored) {\r\n                        const user = JSON.parse(stored);\r\n                        user.locationSharingStoppedAt = new Date().toISOString();\r\n                        user.sleepTime = sleepTime;\r\n                        localStorage.setItem(\"user\", JSON.stringify(user));\r\n                      }\r\n                    }\r\n                    localStorage.removeItem(\"token\");\r\n                    window.location.href = \"/\";\r\n                  }}\r\n                  className=\"w-full flex items-center gap-3 px-4 py-3 hover:bg-red-100 text-gray-800 transition border-l-4 border-transparent hover:border-red-700\"\r\n                >\r\n                  <LogOut className=\"w-5 h-5 text-red-700\" />\r\n                  <span className=\"font-medium\">Logout</span>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </header>\r\n\r\n      {/* BODY */}\r\n      <div className=\"max-w-7xl mx-auto p-6 space-y-12\">\r\n        {/* HERO */}\r\n        <HeroCard\r\n          donorName={donorName}\r\n          profileImage={donorImage}\r\n          getLocation={requestLocation}\r\n          stopLocationSharing={stopLocationSharing}\r\n          locationSharing={locationSharing}\r\n          available={available}\r\n          markAvailable={markAvailable}\r\n          markUnavailable={markUnavailable}\r\n          currentQuote={motivationalQuotes[currentQuoteIndex]}\r\n        />\r\n\r\n        {/* VIDEO - AUTO PLAY on login */}\r\n        <VideoSection showVideo={showVideo} setShowVideo={setShowVideo} />\r\n\r\n        {/* NEARBY HOSPITAL REQUESTS MAP SECTION */}\r\n        <div className=\"max-w-7xl mx-auto p-6\">\r\n          <div className=\"bg-white rounded-2xl shadow-xl p-8 border-2 border-red-200\">\r\n            <div className=\"flex items-center gap-3 mb-6\">\r\n              <MapPin className=\"w-8 h-8 text-red-600\" />\r\n              <h2 className=\"text-3xl font-bold text-red-700\">Nearby Blood Requests</h2>\r\n            </div>\r\n\r\n            {hospitalRequests.length > 0 || recipientRequests.length > 0 ? (\r\n              <>\r\n                {location ? (\r\n                  <HospitalRequestsMap \r\n                    hospitalRequests={[...hospitalRequests, ...recipientRequests]} \r\n                    donorLocation={location} \r\n                  />\r\n                ) : null}\r\n              </>\r\n            ) : (\r\n              <div className=\"text-center py-12 bg-red-50 rounded-xl\">\r\n                <MapPin className=\"w-12 h-12 text-red-300 mx-auto mb-3\" />\r\n                <p className=\"text-gray-600 font-semibold\">No blood requests found</p>\r\n                <p className=\"text-sm text-gray-500 mt-2\">Check back later for new blood requests from hospitals and recipients</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* STATISTICS SECTION */}\r\n        <ScheduleStatistics schedules={schedules} />\r\n\r\n        {/* OTHER SECTIONS */}\r\n        <BloodDonationGuide />\r\n        <CompatibilityChart />\r\n        <ImpactStories />\r\n        {/* UrgentRequests hidden - using HospitalRequestsMap instead */}\r\n        <ScheduledRequests schedules={schedules} />\r\n        <DonationHistory history={history} />\r\n      </div>\r\n\r\n      {/* DONATION CONFIRMATION MODAL */}\r\n      <DonationConfirmationModal\r\n        isOpen={showConfirmModal}\r\n        request={selectedRequest}\r\n        onConfirm={handleConfirmDonation}\r\n        onReject={handleRejectDonation}\r\n        isLoading={confirmLoading}\r\n      />\r\n    </main>\r\n  );\r\n}\r\n\r\n//    COMPONENTS - same structure and style you had\r\n// ----------------------------------------------------------*/\r\n\r\nfunction HeroCard({ donorName, profileImage, getLocation, stopLocationSharing, locationSharing, available, markAvailable, markUnavailable, currentQuote }: any) {\r\n  console.log(\"[HeroCard] Rendering with profileImage:\", profileImage);\r\n  return (\r\n    <div className=\"bg-white rounded-xl shadow-lg overflow-hidden border-l-4 border-red-600 grid md:grid-cols-2\">\r\n      <div className=\"p-10\">\r\n        <h2 className=\"text-3xl font-bold text-red-700\">Welcome back{donorName ? `, ${donorName.split(\" \")[0]}` : \"\"}!</h2>\r\n        <p className=\"text-gray-700 mt-2 text-lg italic font-semibold text-red-600 min-h-[60px] flex items-center\">{currentQuote}</p>\r\n\r\n        <div className=\"mt-6 flex flex-col gap-4\">\r\n          {/* Location Sharing Toggle */}\r\n          <div className=\"flex gap-2\">\r\n            {!locationSharing ? (\r\n              <button onClick={getLocation} className=\"bg-linear-to-r from-blue-500 to-blue-600 text-white px-6 py-3 rounded-lg flex items-center gap-2 font-semibold hover:shadow-lg transition\">\r\n                <MapPin className=\"w-5 h-5\" /> Share Location\r\n              </button>\r\n            ) : (\r\n              <button onClick={stopLocationSharing} className=\"bg-linear-to-r from-purple-500 to-purple-600 text-white px-6 py-3 rounded-lg flex items-center gap-2 font-semibold hover:shadow-lg transition\">\r\n                <MapPin className=\"w-5 h-5\" /> Stop Sharing\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          {/* Availability Toggle */}\r\n          <div className=\"flex gap-2\">\r\n            {!available ? (\r\n              <button onClick={markAvailable} className=\"bg-linear-to-r from-green-500 to-green-600 text-white px-6 py-3 rounded-lg flex gap-2 items-center font-semibold hover:shadow-lg transition\">\r\n                <CheckCircle className=\"w-5 h-5\" /> Mark Available\r\n              </button>\r\n            ) : (\r\n              <button onClick={markUnavailable} className=\"bg-linear-to-r from-red-500 to-red-600 text-white px-6 py-3 rounded-lg flex gap-2 items-center font-semibold hover:shadow-lg transition\">\r\n                <X className=\"w-5 h-5\" /> Unavailable\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"bg-gradient-to-br from-red-50 via-red-100 to-red-200 flex items-center justify-center p-4 min-h-[280px]\">\r\n        {profileImage ? (\r\n          <div className=\"relative w-full h-full flex items-center justify-center\">\r\n            <img\r\n              src={profileImage}\r\n              alt=\"Donor profile\"\r\n              className=\"max-w-full max-h-[250px] rounded-lg shadow-2xl object-contain\"\r\n            />\r\n          </div>\r\n        ) : (\r\n          <div className=\"flex flex-col items-center gap-3\">\r\n            <Heart className=\"text-red-500 w-20 h-20\" />\r\n            <p className=\"text-red-600 text-sm font-medium\">Upload your photo</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n//    VIDEO SECTION - Beautiful design with gradient background\r\n// ----------------------------------------------------------*/\r\nfunction VideoSection({ showVideo, setShowVideo }: any) {\r\n  return showVideo ? (\r\n    <div className=\"mt-10 relative\">\r\n      {/* Gradient background container */}\r\n      <div className=\"absolute inset-0 bg-gradient-to-r from-red-500 via-red-400 to-red-500 rounded-2xl blur-lg opacity-50 -z-10\"></div>\r\n      \r\n      <div className=\"relative bg-gradient-to-br from-red-50 to-white rounded-2xl shadow-2xl overflow-hidden border-2 border-red-200 p-4\">\r\n        {/* Header */}\r\n        <div className=\"mb-4 flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"text-4xl\">ðŸŽ¬</div>\r\n            <div>\r\n              <h3 className=\"text-2xl font-bold text-red-700\">Donor Education Video</h3>\r\n              <p className=\"text-sm text-gray-600\">Learn about blood donation & impact</p>\r\n            </div>\r\n          </div>\r\n          <button \r\n            onClick={() => setShowVideo(false)} \r\n            className=\"text-red-600 hover:text-red-800 text-2xl transition\"\r\n            title=\"Close video\"\r\n          >\r\n            âœ•\r\n          </button>\r\n        </div>\r\n\r\n        {/* Video container with beautiful frame */}\r\n        <div className=\"relative rounded-xl overflow-hidden bg-black shadow-lg\">\r\n          <iframe\r\n            title=\"Intro video\"\r\n            className=\"w-full aspect-video\"\r\n            src=\"https://www.youtube.com/embed/_JlmwDqaYA0?autoplay=1&rel=0&modestbranding=1\"\r\n            allow=\"autoplay; encrypted-media\"\r\n          ></iframe>\r\n        </div>\r\n\r\n        {/* Close button */}\r\n        <button \r\n          onClick={() => setShowVideo(false)} \r\n          className=\"w-full mt-4 bg-gradient-to-r from-red-500 to-red-600 text-white py-3 rounded-lg font-semibold hover:shadow-lg transition\"\r\n        >\r\n          Close Video\r\n        </button>\r\n      </div>\r\n    </div>\r\n  ) : null;\r\n}\r\n\r\n//    Remaining components: ScheduledRequests, DonationHistory, ImpactStories, UrgentRequests,\r\n//    BloodDonationGuide, CompatibilityChart\r\n//    (Use the exact implementations from your existing file â€” I'm copying the same)\r\n// ----------------------------------------------------------*/\r\n\r\nfunction ScheduledRequests({ schedules }: any) {\r\n  const activeSchedules = (schedules || []).filter((s: any) => s.status && s.status.toLowerCase() !== \"completed\" && s.status.toLowerCase() !== \"cancelled\");\r\n  if (!activeSchedules.length) return null;\r\n  return (\r\n    <div className=\"mt-12\">\r\n      <h2 className=\"text-3xl font-bold text-red-700 mb-4\">My Scheduled Donations</h2>\r\n\r\n      <div className=\"grid md:grid-cols-2 gap-6\">\r\n        {activeSchedules.map((s: any, i: number) => (\r\n          <div key={i} className=\"bg-white p-5 rounded-xl shadow border-l-4 border-orange-500\">\r\n            <h3 className=\"text-xl font-bold text-red-700\">Hospital: {s.requestId?.hospital}</h3>\r\n\r\n            <p className=\"mt-2 flex gap-2\"><Calendar /> {s.date}</p>\r\n            <p className=\"flex gap-2\"><Clock /> {s.time}</p>\r\n\r\n            <p className=\"mt-3 font-semibold\">\r\n              Status: <span className=\"bg-red-100 px-3 py-1 rounded-lg\">{s.status.toUpperCase()}</span>\r\n            </p>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction DonationHistory({ history }: any) {\r\n  if (!history.length) return null;\r\n\r\n  return (\r\n    <div className=\"mt-12\">\r\n      <h2 className=\"text-3xl font-bold text-red-700 mb-4\">My Donation History</h2>\r\n\r\n      <div className=\"grid md:grid-cols-3 gap-6\">\r\n        {history.map((h: any, i: number) => (\r\n          <div key={i} className=\"bg-white p-5 rounded-xl shadow border-l-4 border-green-600\">\r\n            <p className=\"text-xl font-bold\">+ {h.units} units</p>\r\n            <p>{new Date(h.date).toLocaleDateString()}</p>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ImpactStories() {\r\n  const [currentNewsIndex, setCurrentNewsIndex] = useState(0);\r\n  const [fadeIn, setFadeIn] = useState(true);\r\n\r\n  // Helper function to get icon component based on icon name\r\n  const getIconComponent = (iconName: string, size: string = \"w-5 h-5\") => {\r\n    const iconProps = `${size} text-white`;\r\n    switch(iconName) {\r\n      case \"droplet\": return <Droplets className={iconProps} />;\r\n      case \"hospital\": return <Hospital className={iconProps} />;\r\n      case \"baby\": return <Baby className={iconProps} />;\r\n      case \"target\": return <Target className={iconProps} />;\r\n      case \"zap\": return <Zap className={iconProps} />;\r\n      case \"star\": return <Star className={iconProps} />;\r\n      case \"heart\": return <Heart className={iconProps} />;\r\n      case \"ambulance\": return <Ambulance className={iconProps} />;\r\n      default: return <Heart className={iconProps} />;\r\n    }\r\n  };\r\n\r\n  const bloodDonationNews = [\r\n    {\r\n      title: \"Life-Saving Donation Saves 3 Lives\",\r\n      outcome: \"One blood donation can save up to 3 lives. A single donation in Delhi today helped 3 emergency patients.\",\r\n      icon: \"droplet\",\r\n      impact: \"+3 lives saved\",\r\n      date: \"Today\",\r\n      image: \"https://images.unsplash.com/photo-1576091160550-2173dba999ef?w=500&h=400&fit=crop\" // Blood donation\r\n    },\r\n    {\r\n      title: \"Critical Surgery Averted\",\r\n      outcome: \"A young accident victim received emergency transfusion from our donors. Now recovering well at Apollo Hospital.\",\r\n      icon: \"hospital\",\r\n      impact: \"1 life saved\",\r\n      date: \"Yesterday\",\r\n      image: \"https://images.unsplash.com/photo-1631217b5f58-d699e5edd3a5?w=500&h=400&fit=crop\" // Hospital\r\n    },\r\n    {\r\n      title: \"Newborn Gets Second Chance\",\r\n      outcome: \"A premature baby in NICU received platelet transfusion thanks to donors. Mother says 'They gave us hope'.\",\r\n      icon: \"baby\",\r\n      impact: \"1 child saved\",\r\n      date: \"2 days ago\",\r\n      image: \"https://images.unsplash.com/photo-1516627145497-ae3dbe626c3d?w=500&h=400&fit=crop\" // Baby/healthcare\r\n    },\r\n    {\r\n      title: \"Blood Camp Success\",\r\n      outcome: \"200 donors participated in blood drive at Mumbai Corporate Park. 280 units collected for hospitals in need.\",\r\n      icon: \"target\",\r\n      impact: \"+280 units\",\r\n      date: \"3 days ago\",\r\n      image: \"https://images.unsplash.com/photo-1631217b5f58-d699e5edd3a5?w=500&h=400&fit=crop\" // Community event\r\n    },\r\n    {\r\n      title: \"Cancer Patient Gets Help\",\r\n      outcome: \"Leukemia patient undergoing chemotherapy received 2 units of whole blood. Treatment proceeding smoothly.\",\r\n      icon: \"zap\",\r\n      impact: \"1 patient sustained\",\r\n      date: \"4 days ago\",\r\n      image: \"https://images.unsplash.com/photo-1576091160550-2173dba999ef?w=500&h=400&fit=crop\" // Medical\r\n    },\r\n    {\r\n      title: \"Rare Blood Type Found\",\r\n      outcome: \"O- negative donor's blood matched rare case. Thalassemia patient received critical transfusion in Chennai.\",\r\n      icon: \"star\",\r\n      impact: \"1 critical match\",\r\n      date: \"5 days ago\",\r\n      image: \"https://images.unsplash.com/photo-1624507898257-dae5d0ed8202?w=500&h=400&fit=crop\" // Laboratory\r\n    }\r\n  ];\r\n\r\n  // Filter only stories with valid images\r\n  const validNews = bloodDonationNews.filter(story => story.image && story.image.trim() !== \"\");\r\n  \r\n  if (validNews.length === 0) {\r\n    return (\r\n      <div className=\"max-w-7xl mx-auto p-6\">\r\n        <h2 className=\"text-3xl font-bold text-red-700 mb-6\">ðŸ©¸ Donor Impact Stories</h2>\r\n        <div className=\"bg-white rounded-2xl shadow-lg p-12 text-center\">\r\n          <Heart className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\r\n          <p className=\"text-gray-600 font-medium\">Impact stories coming soon...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const currentNews = validNews[currentNewsIndex % validNews.length];\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      setFadeIn(false);\r\n      setTimeout(() => {\r\n        setCurrentNewsIndex((prev) => (prev + 1) % bloodDonationNews.length);\r\n        setFadeIn(true);\r\n      }, 300);\r\n    }, 6000); // Change every 6 seconds\r\n\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"mt-10 p-8 bg-gradient-to-r from-red-50 via-red-100 to-red-50 rounded-2xl shadow-xl border-2 border-red-200\">\r\n      {/* Header with title and progress indicators */}\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <h2 className=\"text-3xl font-bold text-red-700 flex items-center gap-3\">\r\n          <span className=\"text-4xl animate-pulse\">ðŸ“°</span> Live Donation Impact\r\n        </h2>\r\n        <div className=\"flex gap-2\">\r\n          {bloodDonationNews.map((_, i) => (\r\n            <button\r\n              key={i}\r\n              onClick={() => {\r\n                setFadeIn(false);\r\n                setTimeout(() => {\r\n                  setCurrentNewsIndex(i);\r\n                  setFadeIn(true);\r\n                }, 100);\r\n              }}\r\n              className={`h-2 rounded-full transition-all duration-300 cursor-pointer ${\r\n                i === currentNewsIndex ? \"bg-red-600 w-8\" : \"bg-red-200 w-2 hover:bg-red-300\"\r\n              }`}\r\n              title={`Go to news ${i + 1}`}\r\n            />\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main news card with image and content */}\r\n      <div className={`transition-opacity duration-300 ${fadeIn ? \"opacity-100\" : \"opacity-0\"}`}>\r\n        <div className=\"bg-white rounded-2xl shadow-lg overflow-hidden border border-red-100\">\r\n          {/* Content section - Full width without image */}\r\n          <div className=\"p-8 space-y-4\">\r\n            <div className=\"flex items-start justify-between mb-4\">\r\n              <div>\r\n                <h3 className=\"text-2xl font-bold text-red-700 mb-2\">{currentNews.title}</h3>\r\n                <div className=\"flex items-center gap-3\">\r\n                  <span className=\"bg-red-600 text-white px-3 py-1 rounded-full text-sm font-semibold flex items-center gap-2\">\r\n                    {getIconComponent(currentNews.icon, \"w-4 h-4\")}\r\n                    {currentNews.date}\r\n                  </span>\r\n                  <span className=\"bg-green-100 text-green-700 px-3 py-1 rounded-lg text-sm font-bold\">\r\n                    {currentNews.impact}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* News content */}\r\n            <p className=\"text-gray-700 text-base leading-relaxed\">{currentNews.outcome}</p>\r\n\r\n            {/* Key Insight section */}\r\n            <div className=\"bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-4 border-l-4 border-orange-400\">\r\n              <p className=\"text-sm text-gray-700\">\r\n                <span className=\"font-bold text-orange-600\">ðŸ’¡ Key Insight:</span> {currentNews.outcome.split('.')[0]}.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Fun fact below card */}\r\n        <div className=\"mt-4 bg-white rounded-lg p-4 border-l-4 border-blue-400 shadow-md\">\r\n          <p className=\"text-sm text-gray-600\">\r\n            <span className=\"font-bold text-blue-600\">â„¹ï¸ Did you know?</span> Every 2 seconds someone in the world needs blood. Your donation can save up to 3 lives, and you can donate again in just 56 days!\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Navigation arrows */}\r\n      <div className=\"flex justify-between items-center mt-6 gap-4\">\r\n        <button\r\n          onClick={() => {\r\n            setFadeIn(false);\r\n            setTimeout(() => {\r\n              setCurrentNewsIndex((prev) => (prev - 1 + validNews.length) % validNews.length);\r\n              setFadeIn(true);\r\n            }, 100);\r\n          }}\r\n          className=\"bg-red-600 hover:bg-red-700 text-white p-3 rounded-full shadow-lg transition\"\r\n          title=\"Previous news\"\r\n        >\r\n          â† Prev\r\n        </button>\r\n        <span className=\"text-gray-600 font-semibold text-sm\">\r\n          {currentNewsIndex + 1} / {validNews.length}\r\n        </span>\r\n        <button\r\n          onClick={() => {\r\n            setFadeIn(false);\r\n            setTimeout(() => {\r\n              setCurrentNewsIndex((prev) => (prev + 1) % validNews.length);\r\n              setFadeIn(true);\r\n            }, 100);\r\n          }}\r\n          className=\"bg-red-600 hover:bg-red-700 text-white p-3 rounded-full shadow-lg transition\"\r\n          title=\"Next news\"\r\n        >\r\n          Next â†’\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction UrgentRequests({ hospitalRequests, recipientRequests, onRequestClick, location }: any) {\r\n  return (\r\n    <div className=\"mt-12\">\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <h2 className=\"text-3xl font-bold text-red-700 flex items-center gap-2\">\r\n          <svg className=\"w-8 h-8\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n            <path fillRule=\"evenodd\" d=\"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z\" clipRule=\"evenodd\" />\r\n          </svg>\r\n          Nearby Urgent Requests\r\n        </h2>\r\n      </div>\r\n\r\n      {/* Hospital-created requests */}\r\n      <div className=\"mt-6 bg-white rounded-2xl shadow-xl p-8 border-2 border-red-200\">\r\n        <div className=\"flex items-center gap-3 mb-6\">\r\n          <Droplet className=\"w-8 h-8 text-red-600\" />\r\n          <h3 className=\"text-3xl font-bold text-red-700\">Hospital Requests</h3>\r\n        </div>\r\n\r\n        {(hospitalRequests || []).filter((req: any) => !req.confirmationStatus || req.confirmationStatus === \"Pending\" || req.confirmationStatus === \"Confirmed\").length === 0 ? (\r\n          <div className=\"text-center py-12\">\r\n            <Droplet className=\"w-16 h-16 text-gray-300 mx-auto mb-3\" />\r\n            <p className=\"text-gray-500 text-lg\">No hospital requests nearby</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            {(hospitalRequests || []).filter((req: any) => !req.confirmationStatus || req.confirmationStatus === \"Pending\" || req.confirmationStatus === \"Confirmed\").map((req: any, i: number) => {\r\n              const distanceDisplay = req.calculatedDistance \r\n                ? `${req.calculatedDistance} km away`\r\n                : (req.locationKm ?? \"N/A\") + \" km away\";\r\n              return (\r\n                <div key={`h-${i}`} className=\"p-6 border-2 border-red-100 rounded-xl hover:shadow-lg transition bg-gradient-to-r from-red-50 to-white\">\r\n                  <div className=\"grid md:grid-cols-2 lg:grid-cols-5 gap-4 items-start mb-4\">\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold text-gray-500 mb-1\">Hospital</p>\r\n                      <p className=\"font-bold text-gray-900\">{req.hospital || \"Hospital\"}</p>\r\n                      <p className=\"text-sm text-gray-600 mt-1\">{distanceDisplay}</p>\r\n                    </div>\r\n\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold text-gray-500 mb-1\">Blood Type</p>\r\n                      <p className=\"font-bold text-red-600 text-lg\">{req.bloodType}</p>\r\n                    </div>\r\n\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold text-gray-500 mb-1\">Units</p>\r\n                      <p className=\"font-bold text-gray-900\">{req.unitsNeeded}</p>\r\n                    </div>\r\n\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold text-gray-500 mb-1\">Urgency</p>\r\n                      <span className={`px-3 py-1 rounded-full text-xs font-semibold inline-block ${\r\n                        req.urgency === \"critical\" ? \"bg-red-100 text-red-700\" :\r\n                        req.urgency === \"high\" ? \"bg-orange-100 text-orange-700\" :\r\n                        \"bg-yellow-100 text-yellow-700\"\r\n                      }`}>\r\n                        {req.urgency?.toUpperCase() || \"NORMAL\"}\r\n                      </span>\r\n                    </div>\r\n\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold text-gray-500 mb-1\">Status</p>\r\n                      <span className={`px-3 py-1 rounded-full text-xs font-semibold inline-block ${\r\n                        req.confirmationStatus === \"Confirmed\" ? \"bg-green-100 text-green-700\" :\r\n                        req.confirmationStatus === \"Rejected\" ? \"bg-red-100 text-red-700\" :\r\n                        req.confirmationStatus === \"Successful\" ? \"bg-blue-100 text-blue-700\" :\r\n                        \"bg-yellow-100 text-yellow-700\"\r\n                      }`}>\r\n                        {req.confirmationStatus || \"Pending\"}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Map preview when hospital request includes explicit coordinates */}\r\n                  {req.location && req.location.latitude && req.location.longitude ? (\r\n                    <div className=\"mt-4 h-40 rounded-lg overflow-hidden border-2 border-red-100\">\r\n                      <LeafletMap activeDonors={[{ location: req.location, fullName: req.hospital, bloodType: req.bloodType }]} />\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"mt-3 text-sm text-gray-500\">Map not available for this request</div>\r\n                  )}\r\n\r\n                  <button\r\n                    onClick={() => onRequestClick(req)}\r\n                    disabled={req.confirmationStatus && ![\"Pending\"].includes(req.confirmationStatus)}\r\n                    className={`w-full mt-4 py-3 rounded-lg transition font-semibold ${\r\n                      req.confirmationStatus && ![\"Pending\"].includes(req.confirmationStatus)\r\n                        ? \"bg-gray-400 text-gray-700 cursor-not-allowed\"\r\n                        : \"bg-gradient-to-r from-red-600 to-red-700 text-white hover:shadow-lg\"\r\n                    }`}\r\n                  >\r\n                    {req.confirmationStatus === \"Confirmed\"\r\n                      ? \"Proceeding to Schedule\"\r\n                      : req.confirmationStatus === \"Rejected\"\r\n                      ? \"Donation Rejected\"\r\n                      : req.confirmationStatus === \"Successful\"\r\n                      ? \"âœ… Donation Completed\"\r\n                      : \"Schedule Donation\"}\r\n                  </button>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Recipient-created requests */}\r\n      <div className=\"mt-8 bg-white rounded-2xl shadow-xl p-8 border-2 border-purple-200\">\r\n        <div className=\"flex items-center gap-3 mb-6\">\r\n          <Heart className=\"w-8 h-8 text-purple-600\" />\r\n          <h3 className=\"text-3xl font-bold text-purple-700\">Recipient Requests</h3>\r\n        </div>\r\n\r\n        {(recipientRequests || []).filter((req: any) => !req.confirmationStatus || req.confirmationStatus === \"Pending\" || req.confirmationStatus === \"Confirmed\").length === 0 ? (\r\n          <div className=\"text-center py-12\">\r\n            <Heart className=\"w-16 h-16 text-gray-300 mx-auto mb-3\" />\r\n            <p className=\"text-gray-500 text-lg\">No recipient requests nearby</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            {(recipientRequests || []).filter((req: any) => !req.confirmationStatus || req.confirmationStatus === \"Pending\" || req.confirmationStatus === \"Confirmed\").map((req: any, i: number) => {\r\n              return (\r\n                <div key={`r-${i}`} className=\"p-6 border-2 border-purple-100 rounded-xl hover:shadow-lg transition bg-gradient-to-r from-purple-50 to-white\">\r\n                  <div className=\"grid md:grid-cols-2 lg:grid-cols-6 gap-4 items-start mb-4\">\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold text-gray-500 mb-1\">Recipient</p>\r\n                      <p className=\"font-bold text-gray-900\">{req.recipientName || req.requestedBy?.fullName || req.requestedByName || req.requesterName || (typeof req.requestedBy === 'string' ? req.requestedBy : \"Recipient\")}</p>\r\n                    </div>\r\n\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold text-gray-500 mb-1\">Hospital</p>\r\n                      <p className=\"font-bold text-purple-600\">{req.hospital || \"N/A\"}</p>\r\n                    </div>\r\n\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold text-gray-500 mb-1\">Blood Type</p>\r\n                      <p className=\"font-bold text-red-600 text-lg\">{req.bloodType}</p>\r\n                    </div>\r\n\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold text-gray-500 mb-1\">Units</p>\r\n                      <p className=\"font-bold text-gray-900\">{req.unitsNeeded}</p>\r\n                    </div>\r\n\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold text-gray-500 mb-1\">Urgency</p>\r\n                      <span className={`px-3 py-1 rounded-full text-xs font-semibold inline-block ${\r\n                        req.urgency === \"critical\" ? \"bg-red-100 text-red-700\" :\r\n                        req.urgency === \"high\" ? \"bg-orange-100 text-orange-700\" :\r\n                        \"bg-yellow-100 text-yellow-700\"\r\n                      }`}>\r\n                        {req.urgency?.toUpperCase() || \"NORMAL\"}\r\n                      </span>\r\n                    </div>\r\n\r\n                    <div>\r\n                      <p className=\"text-xs font-semibold text-gray-500 mb-1\">Status</p>\r\n                      <span className={`px-3 py-1 rounded-full text-xs font-semibold inline-block ${\r\n                        req.confirmationStatus === \"Confirmed\" ? \"bg-green-100 text-green-700\" :\r\n                        req.confirmationStatus === \"Rejected\" ? \"bg-red-100 text-red-700\" :\r\n                        req.confirmationStatus === \"Successful\" ? \"bg-blue-100 text-blue-700\" :\r\n                        \"bg-yellow-100 text-yellow-700\"\r\n                      }`}>\r\n                        {req.confirmationStatus || \"Pending\"}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <button\r\n                    onClick={() => onRequestClick(req)}\r\n                    disabled={req.confirmationStatus && ![\"Pending\"].includes(req.confirmationStatus)}\r\n                    className={`w-full mt-4 py-3 rounded-lg transition font-semibold ${\r\n                      req.confirmationStatus && ![\"Pending\"].includes(req.confirmationStatus)\r\n                        ? \"bg-gray-400 text-gray-700 cursor-not-allowed\"\r\n                        : \"bg-gradient-to-r from-purple-600 to-purple-700 text-white hover:shadow-lg\"\r\n                    }`}\r\n                  >\r\n                    {req.confirmationStatus === \"Confirmed\"\r\n                      ? \"Proceeding to Schedule\"\r\n                      : req.confirmationStatus === \"Rejected\"\r\n                      ? \"Donation Rejected\"\r\n                      : req.confirmationStatus === \"Successful\"\r\n                      ? \"âœ… Donation Completed\"\r\n                      : \"Schedule Donation\"}\r\n                  </button>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n//    SCHEDULE STATISTICS COMPONENT\r\n// ----------------------------------------------------------*/\r\nfunction ScheduleStatistics({ schedules }: any) {\r\n  const totalScheduled = schedules?.length || 0;\r\n  const totalUnits = schedules?.reduce((sum: number, s: any) => {\r\n    const units = s.requestId?.unitsNeeded || s.unitsNeeded || 0;\r\n    return sum + units;\r\n  }, 0) || 0;\r\n  \r\n  // Count by status\r\n  const statusCounts = schedules?.reduce((acc: any, s: any) => {\r\n    const status = s.status || \"Pending\";\r\n    acc[status] = (acc[status] || 0) + 1;\r\n    return acc;\r\n  }, {}) || {};\r\n\r\n  console.log(\"[ScheduleStatistics] Schedules:\", schedules);\r\n  console.log(\"[ScheduleStatistics] Total Scheduled:\", totalScheduled);\r\n  console.log(\"[ScheduleStatistics] Total Units:\", totalUnits);\r\n  console.log(\"[ScheduleStatistics] Status Counts:\", statusCounts);\r\n  \r\n  return (\r\n    <div className=\"mt-12 bg-gradient-to-r from-red-500 to-red-600 rounded-2xl shadow-2xl p-10\">\r\n      <div className=\"mb-8\">\r\n        <h2 className=\"text-4xl font-bold text-white\">ðŸ©¸ Your Donation Impact</h2>\r\n        <p className=\"text-white text-opacity-90 mt-2\">Track your scheduled donations and their status</p>\r\n      </div>\r\n      \r\n      <div className=\"grid md:grid-cols-3 gap-6\">\r\n        {/* Scheduled Donations Card */}\r\n        <div className=\"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition\">\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <p className=\"text-sm font-bold text-red-600 uppercase tracking-wider\">Scheduled Donations</p>\r\n            <span className=\"text-3xl\">ðŸ“…</span>\r\n          </div>\r\n          <p className=\"text-5xl font-bold text-red-700\">{totalScheduled}</p>\r\n          <p className=\"text-gray-600 text-sm mt-2\">Donation appointments booked</p>\r\n        </div>\r\n        \r\n        {/* Total Units Card */}\r\n        <div className=\"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition\">\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <p className=\"text-sm font-bold text-red-600 uppercase tracking-wider\">Total Units</p>\r\n            <span className=\"text-3xl\">ðŸ’‰</span>\r\n          </div>\r\n          <p className=\"text-5xl font-bold text-red-700\">{totalUnits}</p>\r\n          <p className=\"text-gray-600 text-sm mt-2\">Units scheduled to donate</p>\r\n        </div>\r\n\r\n        {/* Status Overview Card */}\r\n        <div className=\"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition\">\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <p className=\"text-sm font-bold text-red-600 uppercase tracking-wider\">Status Summary</p>\r\n            <span className=\"text-3xl\">ðŸ“Š</span>\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            {Object.entries(statusCounts).length > 0 ? (\r\n              Object.entries(statusCounts).map(([status, count]: [string, any]) => (\r\n                <div key={status} className=\"flex items-center justify-between p-2 bg-gray-50 rounded-lg\">\r\n                  <span className=\"text-gray-700 font-semibold capitalize\">{status}:</span>\r\n                  <span className=\"text-lg font-bold text-red-600\">{count}</span>\r\n                </div>\r\n              ))\r\n            ) : (\r\n              <p className=\"text-gray-600 text-sm\">No scheduled donations yet</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Summary Footer */}\r\n      {totalScheduled > 0 && (\r\n        <div className=\"mt-8 pt-6 border-t-2 border-white border-opacity-30\">\r\n          <p className=\"text-center text-white font-semibold text-lg\">\r\n            ðŸŽ¯ You've scheduled <span className=\"text-yellow-200\">{totalScheduled}</span> life-saving donations totaling <span className=\"text-yellow-200\">{totalUnits} units</span> of blood!\r\n          </p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n//    BloodDonationGuide + CompatibilityChart (same as earlier)\r\n// ----------------------------------------------------------*/\r\n\r\nfunction BloodDonationGuide() {\r\n  return (\r\n    <div className=\"mt-10 p-6 bg-white rounded-xl shadow border\">\r\n      <h2 className=\"text-3xl font-bold text-red-700 mb-2 flex items-center gap-2\">\r\n        <span className=\"text-4xl\">ðŸ©¸</span> Blood Donation Frequency Guide\r\n      </h2>\r\n      <p className=\"text-gray-600 mb-6 text-sm\">Know how often you can donate and make maximum impact on lives</p>\r\n\r\n      <div className=\"grid md:grid-cols-2 gap-6\">\r\n        {[\r\n          {\r\n            type: \"Whole Blood\",\r\n            icon: \"ðŸ©¹\",\r\n            wait: 56,\r\n            year: 6,\r\n            benefit: \"Helps all blood types\",\r\n            recovery: \"3-4 weeks\",\r\n            color: \"from-red-400 to-red-600\",\r\n            bg: \"bg-red-50\"\r\n          },\r\n          {\r\n            type: \"Plasma\",\r\n            icon: \"ðŸ’›\",\r\n            wait: 2,\r\n            year: 24,\r\n            benefit: \"Golden component\",\r\n            recovery: \"24 hours\",\r\n            color: \"from-yellow-400 to-yellow-600\",\r\n            bg: \"bg-yellow-50\"\r\n          },\r\n          {\r\n            type: \"Platelets\",\r\n            icon: \"ðŸ’š\",\r\n            wait: 2,\r\n            year: 24,\r\n            benefit: \"Helps cancer patients\",\r\n            recovery: \"24 hours\",\r\n            color: \"from-green-400 to-green-600\",\r\n            bg: \"bg-green-50\"\r\n          },\r\n          {\r\n            type: \"Red Cells\",\r\n            icon: \"â¤ï¸\",\r\n            wait: 112,\r\n            year: 3,\r\n            benefit: \"Critical for anemia\",\r\n            recovery: \"8 weeks\",\r\n            color: \"from-pink-400 to-pink-600\",\r\n            bg: \"bg-pink-50\"\r\n          },\r\n        ].map((item, i) => (\r\n          <div key={i} className={`p-6 rounded-2xl shadow-lg border-2 border-${item.color.split(' ')[1]} ${item.bg} hover:shadow-xl transition-all duration-300 transform hover:scale-105`}>\r\n            <div className=\"flex items-center justify-between mb-3\">\r\n              <div>\r\n                <h3 className=\"font-bold text-lg text-gray-800\">{item.icon} {item.type}</h3>\r\n                <p className=\"text-sm text-gray-600 font-semibold\">{item.benefit}</p>\r\n              </div>\r\n              <div className={`bg-gradient-to-r ${item.color} text-white rounded-full w-12 h-12 flex items-center justify-center font-bold`}>\r\n                {item.year}\r\n              </div>\r\n            </div>\r\n            <div className=\"space-y-2 mt-4\">\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span className=\"text-gray-700 font-semibold\">Frequency:</span>\r\n                <span className=\"bg-white px-3 py-1 rounded-lg font-bold text-gray-800\">Every {item.wait} days</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span className=\"text-gray-700 font-semibold\">Annual:</span>\r\n                <span className=\"bg-white px-3 py-1 rounded-lg font-bold text-gray-800\">{item.year}x per year</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span className=\"text-gray-700 font-semibold\">Recovery:</span>\r\n                <span className=\"bg-white px-3 py-1 rounded-lg font-bold text-gray-800\">{item.recovery}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction CompatibilityChart() {\r\n  const types = [\r\n    {\r\n      type: \"O-\",\r\n      badge: \"ðŸŒŸ Universal Donor\",\r\n      donate: [\"Everyone\"],\r\n      description: \"Rarest hero - can save anyone\",\r\n      bg: \"bg-gradient-to-br from-red-100 to-red-200\",\r\n      border: \"border-red-400\"\r\n    },\r\n    {\r\n      type: \"O+\",\r\n      badge: \"Most Common\",\r\n      donate: [\"O+\", \"A+\", \"B+\", \"AB+\"],\r\n      description: \"Help positive blood types\",\r\n      bg: \"bg-gradient-to-br from-red-100 to-red-200\",\r\n      border: \"border-red-400\"\r\n    },\r\n    {\r\n      type: \"A-\",\r\n      badge: \"Rare Giver\",\r\n      donate: [\"A-\", \"A+\", \"AB-\", \"AB+\"],\r\n      description: \"Support 4 blood types\",\r\n      bg: \"bg-gradient-to-br from-rose-100 to-rose-200\",\r\n      border: \"border-rose-400\"\r\n    },\r\n    {\r\n      type: \"A+\",\r\n      badge: \"Common\",\r\n      donate: [\"A+\", \"AB+\"],\r\n      description: \"Help A and AB types\",\r\n      bg: \"bg-gradient-to-br from-red-50 to-red-100\",\r\n      border: \"border-red-300\"\r\n    },\r\n    {\r\n      type: \"B-\",\r\n      badge: \"Rare Giver\",\r\n      donate: [\"B-\", \"B+\", \"AB-\", \"AB+\"],\r\n      description: \"Support 4 blood types\",\r\n      bg: \"bg-gradient-to-br from-rose-100 to-rose-200\",\r\n      border: \"border-rose-400\"\r\n    },\r\n    {\r\n      type: \"B+\",\r\n      badge: \"Common\",\r\n      donate: [\"B+\", \"AB+\"],\r\n      description: \"Help B and AB types\",\r\n      bg: \"bg-gradient-to-br from-red-50 to-red-100\",\r\n      border: \"border-red-300\"\r\n    },\r\n    {\r\n      type: \"AB-\",\r\n      badge: \"Rarest\",\r\n      donate: [\"AB-\", \"AB+\"],\r\n      description: \"Precious for AB types\",\r\n      bg: \"bg-gradient-to-br from-pink-100 to-pink-200\",\r\n      border: \"border-pink-400\"\r\n    },\r\n    {\r\n      type: \"AB+\",\r\n      badge: \"ðŸŒŸ Universal Recipient\",\r\n      donate: [\"AB+\"],\r\n      description: \"Can receive from anyone\",\r\n      bg: \"bg-gradient-to-br from-red-200 to-red-300\",\r\n      border: \"border-red-500\"\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"mt-10 p-8 bg-gradient-to-r from-white via-blue-50 to-white rounded-2xl shadow-lg border-2 border-blue-200\">\r\n      <h2 className=\"text-3xl font-bold text-red-700 mb-2 flex items-center gap-2\">\r\n        <span className=\"text-4xl\">ðŸ©º</span> Blood Compatibility Chart\r\n      </h2>\r\n      <p className=\"text-gray-600 mb-6 text-sm\">Discover which blood types you can save with your donation</p>\r\n\r\n      <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        {types.map((b, i) => (\r\n          <div\r\n            key={i}\r\n            className={`${b.bg} p-5 rounded-2xl shadow-lg border-2 ${b.border} hover:shadow-xl transition-all duration-300 transform hover:scale-105`}\r\n          >\r\n            <div className=\"flex items-start justify-between mb-3\">\r\n              <div>\r\n                <h3 className=\"font-bold text-2xl text-gray-900 mb-1\">{b.type}</h3>\r\n                <span className=\"inline-block bg-white px-3 py-1 rounded-full text-xs font-bold text-gray-700 shadow-sm\">\r\n                  {b.badge}\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <p className=\"text-xs text-gray-700 font-semibold mb-3 italic\">\"{b.description}\"</p>\r\n            <div>\r\n              <p className=\"text-xs font-bold text-gray-800 mb-2\">ðŸ’‰ Donates to:</p>\r\n              <div className=\"flex flex-wrap gap-2\">\r\n                {b.donate.map((d, j) => (\r\n                  <span\r\n                    key={j}\r\n                    className=\"px-3 py-1.5 bg-white font-bold text-gray-800 rounded-lg text-xs shadow border-2 border-gray-300\"\r\n                  >\r\n                    {d}\r\n                  </span>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"mt-8 bg-gradient-to-r from-red-50 to-pink-50 rounded-xl p-5 border-l-4 border-red-600\">\r\n        <p className=\"text-sm text-gray-700\">\r\n          <span className=\"font-bold text-red-700\">ðŸ’¡ Pro Tip:</span> O- blood type donors are the most sought after because they can donate to anyone. If you have a rare blood type, you're a superhero for those who need it!\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAIA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAqBA;;;;;AA/BA;;;AAKA,MAAM,aAAa,IAAA,6KAAO,EAAC;;;;;;IAA2C,KAAK;;KAArE;AACN,MAAM,sBAAsB,IAAA,6KAAO,EAAC;;;;;;IAAoD,KAAK;;MAAvF;;;;;;AA2BS,SAAS;;IACtB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAQ,EAAE;IAChD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAQ,EAAE;IAClD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAQ,EAAE;IAClE,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,yKAAQ,EAAQ,EAAE;IACpE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAQ,EAAE;IACpD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAgB;IACtD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAC;IAEvD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAsC;IAC9E,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAU;IACpD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAU;IAChE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAS;IACnD,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,yKAAQ,EAAS;IAEnE,iEAAiE;IACjE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAU;IAEpD,oCAAoC;IACpC,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAU;IAClE,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAM;IAC5D,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAU;IAE9D,MAAM,YAAY,IAAA,kIAAS;IAE3B,uCAAuC;IACvC,MAAM,qBAAqB;QACzB;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IAEjD;;4DAE0D,GAC1D,MAAM,gBAAgB;QACpB,gBAAgB;QAChB,8BAA8B;QAC9B,IAAI,SAAS;YACX,IAAI;gBACF,MAAM,aAAa,MAAM,MAAM,CAAC,oCAAoC,EAAE,SAAS;gBAC/E,MAAM,cAAc,MAAM,WAAW,IAAI;gBACzC,WAAW,YAAY,SAAS,IAAI,EAAE;gBAEtC,MAAM,eAAe,MAAM,MAAM,CAAC,qCAAqC,EAAE,SAAS;gBAClF,MAAM,gBAAgB,MAAM,aAAa,IAAI;gBAC7C,aAAa,cAAc,SAAS,IAAI,EAAE;YAC5C,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,kBAAkB;YAClC;QACF;QACA,qBAAqB;QACrB,MAAM;QACN,gBAAgB;IAClB;IAEI,6BAA6B;IACjC,IAAA,0KAAS;oCAAC;YACR,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,MAAM,SAAS,aAAa,OAAO,CAAC;YACpC,IAAI,OAAO;gBACT,IAAI;oBACF,MAAM,UAAe,IAAA,sKAAS,EAAC;oBAC/B,WAAW,QAAQ,MAAM;gBAC3B,EAAE,OAAO,GAAG;oBACV,QAAQ,KAAK,CAAC,iBAAiB;gBACjC;YACF;YACA,IAAI,QAAQ;gBACV,MAAM,OAAO,KAAK,KAAK,CAAC;gBACxB,QAAQ,GAAG,CAAC,+CAA+C;gBAC3D,QAAQ,GAAG,CAAC,8BAA8B,KAAK,YAAY;gBAC3D,aAAa,KAAK,QAAQ,IAAI;gBAC9B,cAAc,KAAK,KAAK,IAAI;gBAC5B,cAAc,KAAK,KAAK,IAAI;gBAC5B,cAAc,KAAK,YAAY,IAAI;gBACnC,2BAA2B;gBAC3B,aAAa,KAAK,SAAS,IAAI;gBAC/B,aAAa,KAAK,SAAS,IAAI;gBAE/B,uEAAuE;gBACvE,IAAI,KAAK,wBAAwB,EAAE;oBACjC,MAAM,cAAc,IAAI,KAAK,KAAK,wBAAwB,EAAE,OAAO;oBACnE,MAAM,gBAAgB,CAAC,KAAK,SAAS,IAAI,EAAE,IAAI,KAAK,MAAM,0BAA0B;oBACpF,MAAM,cAAc,IAAI,OAAO,OAAO;oBAEtC,IAAI,cAAc,cAAc,eAAe;wBAC7C,yCAAyC;wBACzC,mBAAmB;wBACnB,YAAY;wBACZ,sCAAsC;wBACtC,KAAK,wBAAwB,GAAG;wBAChC,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;oBAC9C,OAAO;wBACL,0BAA0B;wBAC1B,mBAAmB;oBACrB;gBACF,OAAO;oBACL,mBAAmB,KAAK,eAAe,IAAI;gBAC7C;YACF;QACF;mCAAG,EAAE;IAEL,uEAAuE;IACvE,IAAA,0KAAS;oCAAC;YACR,MAAM;0DAAgB,CAAC;oBACrB,MAAM,UAAU,OAAO,UAAU,CAAC;oBAClC,aAAa,QAAQ,QAAQ,IAAI;oBACjC,cAAc,QAAQ,KAAK,IAAI;oBAC/B,cAAc,QAAQ,KAAK,IAAI;oBAC/B,cAAc,QAAQ,YAAY,IAAI;gBACxC;;YAEA,OAAO,gBAAgB,CAAC,gBAAgB;YACxC;4CAAO,IAAM,OAAO,mBAAmB,CAAC,gBAAgB;;QAC1D;mCAAG,EAAE;IAEL,6EAA6E;IAC7E,IAAA,0KAAS;oCAAC;YACR,MAAM;4DAAkB;oBACtB,MAAM,aAAa,aAAa,OAAO,CAAC;oBACxC,IAAI,CAAC,YAAY;oBACjB,IAAI;wBACF,MAAM,SAAS,KAAK,KAAK,CAAC;wBAC1B,aAAa,OAAO,QAAQ,IAAI;wBAChC,cAAc,OAAO,KAAK,IAAI;wBAC9B,cAAc,OAAO,KAAK,IAAI;wBAC9B,cAAc,OAAO,YAAY,IAAI;oBACvC,EAAE,OAAO,GAAG;wBACV,QAAQ,KAAK,CAAC,+BAA+B;oBAC/C;gBACF;;YAEA,OAAO,gBAAgB,CAAC,WAAW;YACnC;4CAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;;QACrD;mCAAG,EAAE;IAEL,IAAA,0KAAS;oCAAC;YACR,MAAM,gBAAgB;0DAAY;oBAChC;kEAAqB,CAAC,YAAc,CAAC,YAAY,CAAC,IAAI,mBAAmB,MAAM;;gBACjF;yDAAG;YACH;4CAAO,IAAM,cAAc;;QAC7B;mCAAG;QAAC,mBAAmB,MAAM;KAAC;IAE9B,+CAA+C;IAC/C,+DAA+D;IAC/D,IAAA,0KAAS;oCAAC;YACR,MAAM,SAAS,UAAU,OAAO;YAChC,IAAI,CAAC,QAAQ;YAEb,OAAO,IAAI,CAAC,YAAY;YAExB,OAAO,EAAE,CAAC;4CAA2B,CAAC;oBACpC,QAAQ,GAAG,CAAC,qCAAqC;oBACjD;oDAAa,CAAC,OACZ,KAAK,GAAG;4DAAC,CAAC,IAAO,EAAE,GAAG,KAAK,KAAK,UAAU,GAAG;wCAAE,GAAG,CAAC;wCAAE,QAAQ,KAAK,MAAM;oCAAC,IAAI;;;oBAE/E,iBAAiB,oCAAoC;oBACrD,MAAM,CAAC,2BAA2B,EAAE,KAAK,MAAM,CAAC,WAAW,IAAI;gBACjE;;YAEA,gEAAgE;YAChE,OAAO,EAAE,CAAC;4CAAmB,CAAC;oBAC5B,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,EAAE;oBAC9B;oDAAY,CAAC,OAAU,KAAK,IAAI;4DAAC,CAAC,IAAW,EAAE,GAAG,KAAK,QAAQ,GAAG;6DAAI,OAAO;gCAAC;mCAAY;6BAAK;;oBAE/F,sEAAsE;oBACtE,IAAI,QAAQ,kBAAkB,EAAE;wBAC9B;wDAAqB,CAAC,OAAU,KAAK,IAAI;gEAAC,CAAC,IAAW,EAAE,GAAG,KAAK,QAAQ,GAAG;iEAAI,OAAO;oCAAC;uCAAY;iCAAK;;oBAC1G,OAAO,IAAI,QAAQ,QAAQ,IAAI,QAAQ,QAAQ,KAAK,IAAI;wBACtD;wDAAoB,CAAC,OAAU,KAAK,IAAI;gEAAC,CAAC,IAAW,EAAE,GAAG,KAAK,QAAQ,GAAG;iEAAI,OAAO;oCAAC;uCAAY;iCAAK;;oBACzG;oBAEA,QAAQ,GAAG,CAAC,wBAAwB;gBACtC;;YAEA,+DAA+D;YAC/D,OAAO,EAAE,CAAC;4CAAwB,CAAC;oBACjC,QAAQ,GAAG,CAAC,+BAA+B;gBAC7C;;YAEA,wEAAwE;YACxE,OAAO,EAAE,CAAC;4CAAqB,CAAC;oBAC9B,gDAAgD;oBAChD;oDAAY,CAAC,OAAS,KAAK,MAAM;4DAAC,CAAC,IAAW,EAAE,GAAG,KAAK,QAAQ,SAAS;;;oBACzE;oDAAoB,CAAC,OAAS,KAAK,MAAM;4DAAC,CAAC,IAAW,EAAE,GAAG,KAAK,QAAQ,SAAS;;;oBACjF;oDAAqB,CAAC,OAAS,KAAK,MAAM;4DAAC,CAAC,IAAW,EAAE,GAAG,KAAK,QAAQ,SAAS;;;oBAElF,iBAAiB;oBACjB;oDAAW,CAAC,OAAS;mCAAI;gCAAM;oCAC7B,KAAK,QAAQ,SAAS;oCACtB,OAAO,QAAQ,WAAW;oCAC1B,WAAW,QAAQ,SAAS;oCAC5B,MAAM,IAAI;gCACZ;6BAAE;;gBACJ;;YAEA,4DAA4D;YAC5D,OAAO,EAAE,CAAC;4CAAqB,CAAC;oBAC9B,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,EAAE;oBAE9B,QAAQ,GAAG,CAAC,wCAAwC;oBAEpD,kEAAkE;oBAClE;oDAAoB,CAAC,OACnB,KAAK,GAAG;4DAAC,CAAC,IACR,EAAE,GAAG,KAAK,QAAQ,GAAG,GACjB;wCACE,GAAG,CAAC;wCACJ,oBAAoB,QAAQ,kBAAkB;wCAC9C,aAAa,QAAQ,WAAW;wCAChC,mBAAmB,QAAQ,iBAAiB;oCAC9C,IACA;;;oBAIR;oDAAqB,CAAC,OACpB,KAAK,GAAG;4DAAC,CAAC,IACR,EAAE,GAAG,KAAK,QAAQ,GAAG,GACjB;wCACE,GAAG,CAAC;wCACJ,oBAAoB,QAAQ,kBAAkB;wCAC9C,aAAa,QAAQ,WAAW;wCAChC,mBAAmB,QAAQ,iBAAiB;oCAC9C,IACA;;;oBAIR,gCAAgC;oBAChC;oDAAY,CAAC,OACX,KAAK,GAAG;4DAAC,CAAC,IACR,EAAE,GAAG,KAAK,QAAQ,GAAG,GACjB;wCACE,GAAG,CAAC;wCACJ,oBAAoB,QAAQ,kBAAkB;wCAC9C,aAAa,QAAQ,WAAW;wCAChC,mBAAmB,QAAQ,iBAAiB;oCAC9C,IACA;;;gBAGV;;YAEA,+DAA+D;YAC/D,OAAO,EAAE,CAAC;4CAAsB,CAAC;oBAC/B,IAAI,CAAC,WAAW,CAAC,QAAQ,SAAS,EAAE;oBAEpC,QAAQ,GAAG,CAAC,sCAAsC;oBAElD,4CAA4C;oBAC5C;oDAAoB,CAAC,OACnB,KAAK,GAAG;4DAAC,CAAC,IACR,EAAE,GAAG,KAAK,QAAQ,SAAS,GACvB;wCACE,GAAG,CAAC;wCACJ,oBAAoB;wCACpB,QAAQ;oCACV,IACA;;;oBAIR;oDAAqB,CAAC,OACpB,KAAK,GAAG;4DAAC,CAAC,IACR,EAAE,GAAG,KAAK,QAAQ,SAAS,GACvB;wCACE,GAAG,CAAC;wCACJ,oBAAoB;wCACpB,QAAQ;oCACV,IACA;;;oBAIR;oDAAY,CAAC,OACX,KAAK,GAAG;4DAAC,CAAC,IACR,EAAE,GAAG,KAAK,QAAQ,SAAS,GACvB;wCACE,GAAG,CAAC;wCACJ,oBAAoB;wCACpB,QAAQ;oCACV,IACA;;;gBAGV;;YAEA;4CAAO;oBACL,OAAO,GAAG,CAAC;oBACX,OAAO,GAAG,CAAC;oBACX,OAAO,GAAG,CAAC;oBACX,OAAO,GAAG,CAAC;oBACX,OAAO,GAAG,CAAC;oBACX,OAAO,GAAG,CAAC;gBACb;;QACF;mCAAG;QAAC;QAAS;KAAU;IAEvB,oBAAoB;IACpB,+DAA+D;IAC/D,IAAA,0KAAS;oCAAC;YACR,IAAI,CAAC,SAAS;YACd,MAAM,CAAC,oCAAoC,EAAE,SAAS,EACnD,IAAI;4CAAC,CAAC,MAAQ,IAAI,IAAI;2CACtB,IAAI;4CAAC,CAAC,OAAS,WAAW,KAAK,SAAS,IAAI,EAAE;2CAC9C,KAAK;4CAAC,CAAC,MAAQ,QAAQ,KAAK,CAAC,uBAAuB;;QACzD;mCAAG;QAAC;KAAQ;IAEZ,2CAA2C;IAC3C,+DAA+D;IAC/D,MAAM,eAAe;QACnB,IAAI;YACF,MAAM,SAAS,MAAM,MAAM;YAC3B,MAAM,UAAU,MAAM,OAAO,IAAI;YACjC,MAAM,MAAM,QAAQ,QAAQ,IAAI,EAAE;YAElC,QAAQ,GAAG,CAAC,qCAAqC,IAAI,MAAM;YAC3D,IAAI,IAAI,MAAM,GAAG,GAAG;gBAClB,QAAQ,GAAG,CAAC,mCAAmC;oBAC7C,UAAU,GAAG,CAAC,EAAE,CAAC,QAAQ;oBACzB,OAAO,GAAG,CAAC,EAAE,CAAC,KAAK;oBACnB,SAAS,GAAG,CAAC,EAAE,CAAC,OAAO;oBACvB,UAAU,GAAG,CAAC,EAAE,CAAC,QAAQ;gBAC3B;YACF;YAEA,kFAAkF;YAClF,MAAM,oBAAoB,CAAC,MAAc,MAAc,MAAc;gBACnE,MAAM,IAAI,MAAM,uBAAuB;gBACvC,MAAM,OAAO,CAAC,OAAO,IAAI,IAAI,KAAK,EAAE,GAAG;gBACvC,MAAM,OAAO,CAAC,OAAO,IAAI,IAAI,KAAK,EAAE,GAAG;gBACvC,MAAM,IAAI,KAAK,GAAG,CAAC,OAAO,KAAK,KAAK,GAAG,CAAC,OAAO,KAC7C,KAAK,GAAG,CAAC,OAAO,KAAK,EAAE,GAAG,OAAO,KAAK,GAAG,CAAC,OAAO,KAAK,EAAE,GAAG,OAC3D,KAAK,GAAG,CAAC,OAAO,KAAK,KAAK,GAAG,CAAC,OAAO;gBACvC,MAAM,IAAI,IAAI,KAAK,KAAK,CAAC,KAAK,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI;gBACrD,OAAO,KAAK,KAAK,CAAC,IAAI,IAAI,MAAM,IAAI,2BAA2B;YACjE;YAEA,kDAAkD;YAClD,MAAM,gBAAgB,IAAI,GAAG,CAAC,CAAC;gBAC7B,IAAI,YAAY,EAAE,QAAQ,IAAI,EAAE,QAAQ,CAAC,QAAQ,IAAI,EAAE,QAAQ,CAAC,SAAS,EAAE;oBACzE,MAAM,WAAW,kBACf,SAAS,GAAG,EACZ,SAAS,GAAG,EACZ,EAAE,QAAQ,CAAC,QAAQ,EACnB,EAAE,QAAQ,CAAC,SAAS;oBAEtB,QAAQ,GAAG,CAAC,CAAC,iCAAiC,EAAE,SAAS,GAAG,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,SAAS,GAAG,CAAC,OAAO,CAAC,GAAG,cAAc,EAAE,EAAE,QAAQ,CAAC,CAAC,EAAE,EAAE,QAAQ,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,QAAQ,CAAC,SAAS,CAAC,IAAI,EAAE,SAAS,EAAE,CAAC;oBACjM,OAAO;wBAAE,GAAG,CAAC;wBAAE,oBAAoB;oBAAS;gBAC9C;gBACA,OAAO;YACT;YAEA,2EAA2E;YAC3E,MAAM,YAAY,cAAc,MAAM,CAAC,CAAC,IACtC,EAAE,QAAQ,IAAI,EAAE,QAAQ,KAAK,MAAM,CAAC,EAAE,kBAAkB,IACxD,EAAE,QAAQ,IAAI,EAAE,QAAQ,CAAC,QAAQ,IAAI,EAAE,QAAQ,CAAC,SAAS,IACzD,CAAC,WAAW,EAAE,kBAAkB,IAAI,KAAK,KAAK,EAAE,mDAAmD;;YAGrG,gGAAgG;YAChG,MAAM,aAAa,cAAc,MAAM,CAAC,CAAC,IACvC,EAAE,kBAAkB,KAAK,QACzB,EAAE,QAAQ,IAAI,EAAE,QAAQ,CAAC,QAAQ,IAAI,EAAE,QAAQ,CAAC,SAAS,IACzD,CAAC,WAAW,EAAE,kBAAkB,IAAI,KAAK,IAAI,EAAE,4CAA4C;;YAG7F,oGAAoG;YACpG,oBAAoB;YACpB,qBAAqB;YACrB,YAAY;YACZ,QAAQ,GAAG,CAAC,6CAA6C,UAAU,MAAM;YACzE,IAAI,UAAU,MAAM,GAAG,GAAG;gBACxB,MAAM,SAAS,SAAS,CAAC,EAAE;gBAC3B,QAAQ,GAAG,CAAC,iDAAiD;oBAC3D,UAAU,OAAO,QAAQ;oBACzB,OAAO,OAAO,KAAK;oBACnB,SAAS,OAAO,OAAO;oBACvB,oBAAoB,OAAO,kBAAkB;oBAC7C,UAAU,OAAO,QAAQ;gBAC3B;YACF;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,wBAAwB;QACxC;IACF;IAEA,MAAM,gBAAgB;QACpB,IAAI,CAAC,SAAS;QACd,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,qCAAqC,EAAE,SAAS;YACzE,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,MAAM,eAAe,KAAK,SAAS,IAAI,EAAE;YACzC,uCAAuC;YACvC,MAAM,kBAAkB,MAAM,IAAI,CAChC,IAAI,IACF,aAAa,GAAG,CAAC,CAAC,IAAW;oBAC3B,EAAE,SAAS,EAAE,OAAO,EAAE,SAAS,IAAI,EAAE,GAAG;oBACxC;iBACD,GACD,MAAM;YAEV,aAAa;YACb,QAAQ,GAAG,CAAC,iCAAiC;YAC7C,iEAAiE;YACjE;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,uBAAuB;QACvC;IACF;IAEA,IAAA,0KAAS;oCAAC;YACR;QACF;mCAAG;QAAC;KAAQ;IAEZ,kFAAkF;IAClF,IAAA,0KAAS;oCAAC;YACR,MAAM,QAAQ;kDAAW;oBACvB;gBACF;iDAAG;YACH;4CAAO,IAAM,aAAa;;QAC5B;mCAAG;QAAC;KAAQ;IAEZ,2DAA2D;IAC3D,IAAA,0KAAS;oCAAC;YACR,IAAI,CAAC,YAAY,SAAS;gBACxB,MAAM,QAAQ;sDAAW;wBACvB,IAAI,CAAC,UAAU,WAAW,EAAE;wBAC5B,UAAU,WAAW,CAAC,kBAAkB;8DACtC,CAAC;gCACC,MAAM,cAAc;oCAAE,KAAK,IAAI,MAAM,CAAC,QAAQ;oCAAE,KAAK,IAAI,MAAM,CAAC,SAAS;gCAAC;gCAC1E,YAAY;gCACZ,QAAQ,GAAG,CAAC,8CAA8C,IAAI,MAAM;4BACtE;;8DACA,CAAC;gCACC,QAAQ,GAAG,CAAC,0DAA0D;gCACtE,oFAAoF;gCACpF;4BACF;6DACA;4BAAE,oBAAoB;4BAAM,SAAS;wBAAM;oBAE/C;qDAAG;gBACH;gDAAO,IAAM,aAAa;;YAC5B;QACF;mCAAG;QAAC;KAAQ;IAEZ,4EAA4E;IAC5E,IAAA,0KAAS;oCAAC;YACR,IAAI,UAAU;gBACZ;YACF;QACF;mCAAG;QAAC;KAAS;IAEb,kDAAkD;IAClD,+DAA+D;IAC/D,4DAA4D;IAE5D,sEAAsE;IACtE,4CAA4C;IAC5C,+DAA+D;IAC/D,MAAM,kBAAkB;QACtB,IAAI,CAAC,UAAU,WAAW,EAAE,OAAO,MAAM;QACzC,UAAU,WAAW,CAAC,kBAAkB,CACtC,OAAO;YACL,MAAM,cAAc;gBAAE,KAAK,IAAI,MAAM,CAAC,QAAQ;gBAAE,KAAK,IAAI,MAAM,CAAC,SAAS;YAAC;YAC1E,QAAQ,GAAG,CAAC,sCAAsC;YAClD,YAAY;YACZ,mBAAmB;YACnB,uBAAuB;YACvB,MAAM,SAAS,aAAa,OAAO,CAAC;YACpC,IAAI,QAAQ;gBACV,MAAM,OAAO,KAAK,KAAK,CAAC;gBACxB,KAAK,eAAe,GAAG;gBACvB,KAAK,wBAAwB,GAAG;gBAChC,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;YAC9C;YACA,0DAA0D;YAC1D,WAAW;gBACT,MAAM;gBACN,QAAQ,GAAG,CAAC;YACd,GAAG;YACH,MAAM;QACR,GACA,CAAC;YACC,QAAQ,KAAK,CAAC,wCAAwC;YACtD,IAAI,IAAI,IAAI,KAAK,GAAG,MAAM;iBACrB,MAAM;QACb,GACA;YAAE,oBAAoB;YAAM,SAAS;QAAM;IAE/C;IAEA,mGAAmG;IACnG,+DAA+D;IAC/D,MAAM,gBAAgB;QACpB,IAAI,CAAC,SAAS,OAAO,MAAM;QAC3B,IAAI,CAAC,UAAU,OAAO,MAAM;QAE5B,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,4CAA4C;gBAClE,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBACnB;oBACA,WAAW;oBACX,UAAU,SAAS,GAAG;oBACtB,WAAW,SAAS,GAAG;gBACzB;YACF;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,KAAK,OAAO,EAAE;gBAChB,aAAa;gBACb,uBAAuB;gBACvB,MAAM,SAAS,aAAa,OAAO,CAAC;gBACpC,IAAI,QAAQ;oBACV,MAAM,OAAO,KAAK,KAAK,CAAC;oBACxB,KAAK,SAAS,GAAG;oBACjB,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;gBAC9C;YACF,OAAO;gBACL,MAAM,YAAY,CAAC,KAAK,OAAO,IAAI,0BAA0B;YAC/D;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC;YACd,MAAM;QACR;IACF;IAEA,MAAM,kBAAkB;QACtB,IAAI,CAAC,SAAS,OAAO,MAAM;QAC3B,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,4CAA4C;gBAClE,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAS,WAAW;gBAAM;YACnD;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,KAAK,OAAO,EAAE;gBAChB,aAAa;gBACb,uBAAuB;gBACvB,MAAM,SAAS,aAAa,OAAO,CAAC;gBACpC,IAAI,QAAQ;oBACV,MAAM,OAAO,KAAK,KAAK,CAAC;oBACxB,KAAK,SAAS,GAAG;oBACjB,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;gBAC9C;YACF,OAAO;gBACL,MAAM,YAAY,CAAC,KAAK,OAAO,IAAI,4BAA4B;YACjE;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC;YACd,MAAM;QACR;IACF;IAEA,MAAM,sBAAsB;QAC1B,mBAAmB;QACnB,YAAY;QACZ,oBAAoB,EAAE,GAAG,sDAAsD;QAE/E,uBAAuB;QACvB,MAAM,SAAS,aAAa,OAAO,CAAC;QACpC,IAAI,QAAQ;YACV,MAAM,OAAO,KAAK,KAAK,CAAC;YACxB,KAAK,eAAe,GAAG;YACvB,KAAK,wBAAwB,GAAG;YAChC,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;QAC9C;QACA,MAAM;IACR;IAEA,qCAAqC;IACrC,+DAA+D;IAC/D,MAAM,yBAAyB,CAAC;QAC9B,mBAAmB;QACnB,oBAAoB;IACtB;IAEA,MAAM,wBAAwB;QAC5B,IAAI,CAAC,iBAAiB;QAEtB,+BAA+B;QAC/B,kBAAkB;QAClB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,8BAA8B,EAAE,gBAAgB,GAAG,CAAC,QAAQ,CAAC,EAAE;gBACtF,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBACnB,QAAQ;oBACR,aAAa;oBACb,OAAO;gBACT;YACF;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,KAAK,OAAO,EAAE;gBAChB,gDAAgD;gBAChD,IAAI;oBACF,MAAM,MAAM,uDAAuD;wBACjE,QAAQ;wBACR,SAAS;4BAAE,gBAAgB;wBAAmB;wBAC9C,MAAM,KAAK,SAAS,CAAC;4BACnB,WAAW,gBAAgB,GAAG;4BAC9B,SAAS;4BACT,WAAW;4BACX,YAAY;4BACZ,UAAU,gBAAgB,QAAQ;4BAClC,WAAW,gBAAgB,SAAS;4BACpC,OAAO,gBAAgB,WAAW;4BAClC,eAAe,gBAAgB,aAAa;4BAC5C,gBAAgB,gBAAgB,cAAc;4BAC9C,oBAAoB,gBAAgB,kBAAkB;wBACxD;oBACF;gBACF,EAAE,OAAO,UAAU;oBACjB,QAAQ,KAAK,CAAC,yBAAyB;gBACzC;gBAEA,4CAA4C;gBAC5C,oBAAoB;gBACpB,OAAO,QAAQ,CAAC,IAAI,GAAG,CAAC,mCAAmC,EAAE,gBAAgB,GAAG,CAAC,UAAU,EAAE,mBAC3F,gBAAgB,QAAQ,IAAI,IAC5B,OAAO,EAAE,gBAAgB,WAAW,CAAC,WAAW,EAAE,gBAAgB,SAAS,EAAE;YACjF,OAAO;gBACL,MAAM,gCAAgC,CAAC,KAAK,OAAO,IAAI,eAAe;YACxE;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,MAAM;QACR,SAAU;YACR,kBAAkB;QACpB;IACF;IAEA,MAAM,uBAAuB,OAAO;QAClC,IAAI,CAAC,iBAAiB;QAEtB,kBAAkB;QAClB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,8BAA8B,EAAE,gBAAgB,GAAG,CAAC,QAAQ,CAAC,EAAE;gBACtF,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBACnB,QAAQ;oBACR,aAAa;oBACb,OAAO,SAAS;gBAClB;YACF;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,KAAK,OAAO,EAAE;gBAChB,0CAA0C;gBAC1C,oBAAoB,CAAC,OACnB,KAAK,GAAG,CAAC,CAAC,IACR,EAAE,GAAG,KAAK,gBAAgB,GAAG,GACzB;4BAAE,GAAG,CAAC;4BAAE,oBAAoB;wBAAW,IACvC;gBAGR,qBAAqB,CAAC,OACpB,KAAK,GAAG,CAAC,CAAC,IACR,EAAE,GAAG,KAAK,gBAAgB,GAAG,GACzB;4BAAE,GAAG,CAAC;4BAAE,oBAAoB;wBAAW,IACvC;gBAGR,oBAAoB;gBACpB,MAAM;YACR,OAAO;gBACL,MAAM,+BAA+B,CAAC,KAAK,OAAO,IAAI,eAAe;YACvE;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,MAAM;QACR,SAAU;YACR,kBAAkB;QACpB;IACF;IAEA,SAAS;IACT,+DAA+D;IAC/D,qBACE,6LAAC;QAAK,WAAU;;0BAEd,6LAAC;gBAAO,WAAU;;kCAChB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,gNAAK;gCAAC,WAAU;;;;;;4BAChB;;;;;;;kCAGH,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCACC,SAAS,IAAM,mBAAmB,CAAC;gCACnC,WAAU;gCACV,OAAM;0CACP;;;;;;4BAIA,iCACC,6LAAC;gCAAI,WAAU;;kDAEb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAE,WAAU;0DAAkC;;;;;;0DAC/C,6LAAC;gDAAE,WAAU;0DAA8B;;;;;;0DAC3C,6LAAC;gDAAE,WAAU;0DAAyB;;;;;;;;;;;;kDAIxC,6LAAC;wCAAI,WAAU;;0DACb,6LAAC,0KAAI;gDACH,MAAK;gDACL,WAAU;gDACV,SAAS,IAAM,mBAAmB;;kEAElC,6LAAC,6NAAQ;wDAAC,WAAU;;;;;;kEACpB,6LAAC;wDAAK,WAAU;kEAAc;;;;;;;;;;;;0DAEhC,6LAAC,0KAAI;gDACH,MAAK;gDACL,WAAU;gDACV,SAAS,IAAM,mBAAmB;;kEAElC,6LAAC,yNAAQ;wDAAC,WAAU;;;;;;kEACpB,6LAAC;wDAAK,WAAU;kEAAc;;;;;;;;;;;;0DAEhC,6LAAC,0KAAI;gDACH,MAAK;gDACL,WAAU;gDACV,SAAS,IAAM,mBAAmB;;kEAElC,6LAAC,6MAAI;wDAAC,WAAU;;;;;;kEAChB,6LAAC;wDAAK,WAAU;kEAAc;;;;;;;;;;;;0DAEhC,6LAAC;gDACC,SAAS;oDACP,wDAAwD;oDACxD,IAAI,iBAAiB;wDACnB,MAAM,SAAS,aAAa,OAAO,CAAC;wDACpC,IAAI,QAAQ;4DACV,MAAM,OAAO,KAAK,KAAK,CAAC;4DACxB,KAAK,wBAAwB,GAAG,IAAI,OAAO,WAAW;4DACtD,KAAK,SAAS,GAAG;4DACjB,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;wDAC9C;oDACF;oDACA,aAAa,UAAU,CAAC;oDACxB,OAAO,QAAQ,CAAC,IAAI,GAAG;gDACzB;gDACA,WAAU;;kEAEV,6LAAC,uNAAM;wDAAC,WAAU;;;;;;kEAClB,6LAAC;wDAAK,WAAU;kEAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAS1C,6LAAC;gBAAI,WAAU;;kCAEb,6LAAC;wBACC,WAAW;wBACX,cAAc;wBACd,aAAa;wBACb,qBAAqB;wBACrB,iBAAiB;wBACjB,WAAW;wBACX,eAAe;wBACf,iBAAiB;wBACjB,cAAc,kBAAkB,CAAC,kBAAkB;;;;;;kCAIrD,6LAAC;wBAAa,WAAW;wBAAW,cAAc;;;;;;kCAGlD,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,uNAAM;4CAAC,WAAU;;;;;;sDAClB,6LAAC;4CAAG,WAAU;sDAAkC;;;;;;;;;;;;gCAGjD,iBAAiB,MAAM,GAAG,KAAK,kBAAkB,MAAM,GAAG,kBACzD;8CACG,yBACC,6LAAC;wCACC,kBAAkB;+CAAI;+CAAqB;yCAAkB;wCAC7D,eAAe;;;;;+CAEf;kEAGN,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,uNAAM;4CAAC,WAAU;;;;;;sDAClB,6LAAC;4CAAE,WAAU;sDAA8B;;;;;;sDAC3C,6LAAC;4CAAE,WAAU;sDAA6B;;;;;;;;;;;;;;;;;;;;;;;kCAOlD,6LAAC;wBAAmB,WAAW;;;;;;kCAG/B,6LAAC;;;;;kCACD,6LAAC;;;;;kCACD,6LAAC;;;;;kCAED,6LAAC;wBAAkB,WAAW;;;;;;kCAC9B,6LAAC;wBAAgB,SAAS;;;;;;;;;;;;0BAI5B,6LAAC,gLAAyB;gBACxB,QAAQ;gBACR,SAAS;gBACT,WAAW;gBACX,UAAU;gBACV,WAAW;;;;;;;;;;;;AAInB;GAv0BwB;;QA2BJ,kIAAS;;;MA3BL;AAy0BxB,mDAAmD;AACnD,+DAA+D;AAE/D,SAAS,SAAS,EAAE,SAAS,EAAE,YAAY,EAAE,WAAW,EAAE,mBAAmB,EAAE,eAAe,EAAE,SAAS,EAAE,aAAa,EAAE,eAAe,EAAE,YAAY,EAAO;IAC5J,QAAQ,GAAG,CAAC,2CAA2C;IACvD,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;;4BAAkC;4BAAa,YAAY,CAAC,EAAE,EAAE,UAAU,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE,GAAG;4BAAG;;;;;;;kCAC7G,6LAAC;wBAAE,WAAU;kCAA+F;;;;;;kCAE5G,6LAAC;wBAAI,WAAU;;0CAEb,6LAAC;gCAAI,WAAU;0CACZ,CAAC,gCACA,6LAAC;oCAAO,SAAS;oCAAa,WAAU;;sDACtC,6LAAC,uNAAM;4CAAC,WAAU;;;;;;wCAAY;;;;;;yDAGhC,6LAAC;oCAAO,SAAS;oCAAqB,WAAU;;sDAC9C,6LAAC,uNAAM;4CAAC,WAAU;;;;;;wCAAY;;;;;;;;;;;;0CAMpC,6LAAC;gCAAI,WAAU;0CACZ,CAAC,0BACA,6LAAC;oCAAO,SAAS;oCAAe,WAAU;;sDACxC,6LAAC,6OAAW;4CAAC,WAAU;;;;;;wCAAY;;;;;;yDAGrC,6LAAC;oCAAO,SAAS;oCAAiB,WAAU;;sDAC1C,6LAAC,oMAAC;4CAAC,WAAU;;;;;;wCAAY;;;;;;;;;;;;;;;;;;;;;;;;0BAOnC,6LAAC;gBAAI,WAAU;0BACZ,6BACC,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBACC,KAAK;wBACL,KAAI;wBACJ,WAAU;;;;;;;;;;yCAId,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,gNAAK;4BAAC,WAAU;;;;;;sCACjB,6LAAC;4BAAE,WAAU;sCAAmC;;;;;;;;;;;;;;;;;;;;;;;AAM5D;MAvDS;AAyDT,+DAA+D;AAC/D,+DAA+D;AAC/D,SAAS,aAAa,EAAE,SAAS,EAAE,YAAY,EAAO;IACpD,OAAO,0BACL,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAI,WAAU;;;;;;0BAEf,6LAAC;gBAAI,WAAU;;kCAEb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;kDAAW;;;;;;kDAC1B,6LAAC;;0DACC,6LAAC;gDAAG,WAAU;0DAAkC;;;;;;0DAChD,6LAAC;gDAAE,WAAU;0DAAwB;;;;;;;;;;;;;;;;;;0CAGzC,6LAAC;gCACC,SAAS,IAAM,aAAa;gCAC5B,WAAU;gCACV,OAAM;0CACP;;;;;;;;;;;;kCAMH,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BACC,OAAM;4BACN,WAAU;4BACV,KAAI;4BACJ,OAAM;;;;;;;;;;;kCAKV,6LAAC;wBACC,SAAS,IAAM,aAAa;wBAC5B,WAAU;kCACX;;;;;;;;;;;;;;;;;eAKH;AACN;MA7CS;AA+CT,8FAA8F;AAC9F,4CAA4C;AAC5C,oFAAoF;AACpF,+DAA+D;AAE/D,SAAS,kBAAkB,EAAE,SAAS,EAAO;IAC3C,MAAM,kBAAkB,CAAC,aAAa,EAAE,EAAE,MAAM,CAAC,CAAC,IAAW,EAAE,MAAM,IAAI,EAAE,MAAM,CAAC,WAAW,OAAO,eAAe,EAAE,MAAM,CAAC,WAAW,OAAO;IAC9I,IAAI,CAAC,gBAAgB,MAAM,EAAE,OAAO;IACpC,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;0BAAuC;;;;;;0BAErD,6LAAC;gBAAI,WAAU;0BACZ,gBAAgB,GAAG,CAAC,CAAC,GAAQ,kBAC5B,6LAAC;wBAAY,WAAU;;0CACrB,6LAAC;gCAAG,WAAU;;oCAAiC;oCAAW,EAAE,SAAS,EAAE;;;;;;;0CAEvE,6LAAC;gCAAE,WAAU;;kDAAkB,6LAAC,yNAAQ;;;;;oCAAG;oCAAE,EAAE,IAAI;;;;;;;0CACnD,6LAAC;gCAAE,WAAU;;kDAAa,6LAAC,gNAAK;;;;;oCAAG;oCAAE,EAAE,IAAI;;;;;;;0CAE3C,6LAAC;gCAAE,WAAU;;oCAAqB;kDACxB,6LAAC;wCAAK,WAAU;kDAAmC,EAAE,MAAM,CAAC,WAAW;;;;;;;;;;;;;uBAPzE;;;;;;;;;;;;;;;;AAcpB;MAvBS;AAyBT,SAAS,gBAAgB,EAAE,OAAO,EAAO;IACvC,IAAI,CAAC,QAAQ,MAAM,EAAE,OAAO;IAE5B,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;0BAAuC;;;;;;0BAErD,6LAAC;gBAAI,WAAU;0BACZ,QAAQ,GAAG,CAAC,CAAC,GAAQ,kBACpB,6LAAC;wBAAY,WAAU;;0CACrB,6LAAC;gCAAE,WAAU;;oCAAoB;oCAAG,EAAE,KAAK;oCAAC;;;;;;;0CAC5C,6LAAC;0CAAG,IAAI,KAAK,EAAE,IAAI,EAAE,kBAAkB;;;;;;;uBAF/B;;;;;;;;;;;;;;;;AAQpB;MAjBS;AAmBT,SAAS;;IACP,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAC;IACzD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IAErC,2DAA2D;IAC3D,MAAM,mBAAmB,CAAC,UAAkB,OAAe,SAAS;QAClE,MAAM,YAAY,GAAG,KAAK,WAAW,CAAC;QACtC,OAAO;YACL,KAAK;gBAAW,qBAAO,6LAAC,yNAAQ;oBAAC,WAAW;;;;;;YAC5C,KAAK;gBAAY,qBAAO,6LAAC,yNAAQ;oBAAC,WAAW;;;;;;YAC7C,KAAK;gBAAQ,qBAAO,6LAAC,6MAAI;oBAAC,WAAW;;;;;;YACrC,KAAK;gBAAU,qBAAO,6LAAC,mNAAM;oBAAC,WAAW;;;;;;YACzC,KAAK;gBAAO,qBAAO,6LAAC,0MAAG;oBAAC,WAAW;;;;;;YACnC,KAAK;gBAAQ,qBAAO,6LAAC,6MAAI;oBAAC,WAAW;;;;;;YACrC,KAAK;gBAAS,qBAAO,6LAAC,gNAAK;oBAAC,WAAW;;;;;;YACvC,KAAK;gBAAa,qBAAO,6LAAC,4NAAS;oBAAC,WAAW;;;;;;YAC/C;gBAAS,qBAAO,6LAAC,gNAAK;oBAAC,WAAW;;;;;;QACpC;IACF;IAEA,MAAM,oBAAoB;QACxB;YACE,OAAO;YACP,SAAS;YACT,MAAM;YACN,QAAQ;YACR,MAAM;YACN,OAAO,oFAAoF,iBAAiB;QAC9G;QACA;YACE,OAAO;YACP,SAAS;YACT,MAAM;YACN,QAAQ;YACR,MAAM;YACN,OAAO,mFAAmF,WAAW;QACvG;QACA;YACE,OAAO;YACP,SAAS;YACT,MAAM;YACN,QAAQ;YACR,MAAM;YACN,OAAO,oFAAoF,kBAAkB;QAC/G;QACA;YACE,OAAO;YACP,SAAS;YACT,MAAM;YACN,QAAQ;YACR,MAAM;YACN,OAAO,mFAAmF,kBAAkB;QAC9G;QACA;YACE,OAAO;YACP,SAAS;YACT,MAAM;YACN,QAAQ;YACR,MAAM;YACN,OAAO,oFAAoF,UAAU;QACvG;QACA;YACE,OAAO;YACP,SAAS;YACT,MAAM;YACN,QAAQ;YACR,MAAM;YACN,OAAO,oFAAoF,aAAa;QAC1G;KACD;IAED,wCAAwC;IACxC,MAAM,YAAY,kBAAkB,MAAM,CAAC,CAAA,QAAS,MAAM,KAAK,IAAI,MAAM,KAAK,CAAC,IAAI,OAAO;IAE1F,IAAI,UAAU,MAAM,KAAK,GAAG;QAC1B,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAG,WAAU;8BAAuC;;;;;;8BACrD,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,gNAAK;4BAAC,WAAU;;;;;;sCACjB,6LAAC;4BAAE,WAAU;sCAA4B;;;;;;;;;;;;;;;;;;IAIjD;IAEA,MAAM,cAAc,SAAS,CAAC,mBAAmB,UAAU,MAAM,CAAC;IAElE,IAAA,0KAAS;mCAAC;YACR,MAAM,WAAW;oDAAY;oBAC3B,UAAU;oBACV;4DAAW;4BACT;oEAAoB,CAAC,OAAS,CAAC,OAAO,CAAC,IAAI,kBAAkB,MAAM;;4BACnE,UAAU;wBACZ;2DAAG;gBACL;mDAAG,OAAO,yBAAyB;YAEnC;2CAAO,IAAM,cAAc;;QAC7B;kCAAG,EAAE;IAEL,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;;0CACZ,6LAAC;gCAAK,WAAU;0CAAyB;;;;;;4BAAS;;;;;;;kCAEpD,6LAAC;wBAAI,WAAU;kCACZ,kBAAkB,GAAG,CAAC,CAAC,GAAG,kBACzB,6LAAC;gCAEC,SAAS;oCACP,UAAU;oCACV,WAAW;wCACT,oBAAoB;wCACpB,UAAU;oCACZ,GAAG;gCACL;gCACA,WAAW,CAAC,4DAA4D,EACtE,MAAM,mBAAmB,mBAAmB,mCAC5C;gCACF,OAAO,CAAC,WAAW,EAAE,IAAI,GAAG;+BAXvB;;;;;;;;;;;;;;;;0BAkBb,6LAAC;gBAAI,WAAW,CAAC,gCAAgC,EAAE,SAAS,gBAAgB,aAAa;;kCACvF,6LAAC;wBAAI,WAAU;kCAEb,cAAA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;8CACb,cAAA,6LAAC;;0DACC,6LAAC;gDAAG,WAAU;0DAAwC,YAAY,KAAK;;;;;;0DACvE,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAK,WAAU;;4DACb,iBAAiB,YAAY,IAAI,EAAE;4DACnC,YAAY,IAAI;;;;;;;kEAEnB,6LAAC;wDAAK,WAAU;kEACb,YAAY,MAAM;;;;;;;;;;;;;;;;;;;;;;;8CAO3B,6LAAC;oCAAE,WAAU;8CAA2C,YAAY,OAAO;;;;;;8CAG3E,6LAAC;oCAAI,WAAU;8CACb,cAAA,6LAAC;wCAAE,WAAU;;0DACX,6LAAC;gDAAK,WAAU;0DAA4B;;;;;;4CAAsB;4CAAE,YAAY,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;4CAAC;;;;;;;;;;;;;;;;;;;;;;;kCAO9G,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAE,WAAU;;8CACX,6LAAC;oCAAK,WAAU;8CAA0B;;;;;;gCAAuB;;;;;;;;;;;;;;;;;;0BAMvE,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,SAAS;4BACP,UAAU;4BACV,WAAW;gCACT,oBAAoB,CAAC,OAAS,CAAC,OAAO,IAAI,UAAU,MAAM,IAAI,UAAU,MAAM;gCAC9E,UAAU;4BACZ,GAAG;wBACL;wBACA,WAAU;wBACV,OAAM;kCACP;;;;;;kCAGD,6LAAC;wBAAK,WAAU;;4BACb,mBAAmB;4BAAE;4BAAI,UAAU,MAAM;;;;;;;kCAE5C,6LAAC;wBACC,SAAS;4BACP,UAAU;4BACV,WAAW;gCACT,oBAAoB,CAAC,OAAS,CAAC,OAAO,CAAC,IAAI,UAAU,MAAM;gCAC3D,UAAU;4BACZ,GAAG;wBACL;wBACA,WAAU;wBACV,OAAM;kCACP;;;;;;;;;;;;;;;;;;AAMT;IAzMS;MAAA;AA2MT,SAAS,eAAe,EAAE,gBAAgB,EAAE,iBAAiB,EAAE,cAAc,EAAE,QAAQ,EAAO;IAC5F,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAG,WAAU;;sCACZ,6LAAC;4BAAI,WAAU;4BAAU,MAAK;4BAAe,SAAQ;sCACnD,cAAA,6LAAC;gCAAK,UAAS;gCAAU,GAAE;gCAA8F,UAAS;;;;;;;;;;;wBAC9H;;;;;;;;;;;;0BAMV,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,sNAAO;gCAAC,WAAU;;;;;;0CACnB,6LAAC;gCAAG,WAAU;0CAAkC;;;;;;;;;;;;oBAGjD,CAAC,oBAAoB,EAAE,EAAE,MAAM,CAAC,CAAC,MAAa,CAAC,IAAI,kBAAkB,IAAI,IAAI,kBAAkB,KAAK,aAAa,IAAI,kBAAkB,KAAK,aAAa,MAAM,KAAK,kBACnK,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,sNAAO;gCAAC,WAAU;;;;;;0CACnB,6LAAC;gCAAE,WAAU;0CAAwB;;;;;;;;;;;6CAGvC,6LAAC;wBAAI,WAAU;kCACZ,CAAC,oBAAoB,EAAE,EAAE,MAAM,CAAC,CAAC,MAAa,CAAC,IAAI,kBAAkB,IAAI,IAAI,kBAAkB,KAAK,aAAa,IAAI,kBAAkB,KAAK,aAAa,GAAG,CAAC,CAAC,KAAU;4BACvK,MAAM,kBAAkB,IAAI,kBAAkB,GAC1C,GAAG,IAAI,kBAAkB,CAAC,QAAQ,CAAC,GACnC,CAAC,IAAI,UAAU,IAAI,KAAK,IAAI;4BAChC,qBACE,6LAAC;gCAAmB,WAAU;;kDAC5B,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;;kEACC,6LAAC;wDAAE,WAAU;kEAA2C;;;;;;kEACxD,6LAAC;wDAAE,WAAU;kEAA2B,IAAI,QAAQ,IAAI;;;;;;kEACxD,6LAAC;wDAAE,WAAU;kEAA8B;;;;;;;;;;;;0DAG7C,6LAAC;;kEACC,6LAAC;wDAAE,WAAU;kEAA2C;;;;;;kEACxD,6LAAC;wDAAE,WAAU;kEAAkC,IAAI,SAAS;;;;;;;;;;;;0DAG9D,6LAAC;;kEACC,6LAAC;wDAAE,WAAU;kEAA2C;;;;;;kEACxD,6LAAC;wDAAE,WAAU;kEAA2B,IAAI,WAAW;;;;;;;;;;;;0DAGzD,6LAAC;;kEACC,6LAAC;wDAAE,WAAU;kEAA2C;;;;;;kEACxD,6LAAC;wDAAK,WAAW,CAAC,0DAA0D,EAC1E,IAAI,OAAO,KAAK,aAAa,4BAC7B,IAAI,OAAO,KAAK,SAAS,kCACzB,iCACA;kEACC,IAAI,OAAO,EAAE,iBAAiB;;;;;;;;;;;;0DAInC,6LAAC;;kEACC,6LAAC;wDAAE,WAAU;kEAA2C;;;;;;kEACxD,6LAAC;wDAAK,WAAW,CAAC,0DAA0D,EAC1E,IAAI,kBAAkB,KAAK,cAAc,gCACzC,IAAI,kBAAkB,KAAK,aAAa,4BACxC,IAAI,kBAAkB,KAAK,eAAe,8BAC1C,iCACA;kEACC,IAAI,kBAAkB,IAAI;;;;;;;;;;;;;;;;;;oCAMhC,IAAI,QAAQ,IAAI,IAAI,QAAQ,CAAC,QAAQ,IAAI,IAAI,QAAQ,CAAC,SAAS,iBAC9D,6LAAC;wCAAI,WAAU;kDACb,cAAA,6LAAC;4CAAW,cAAc;gDAAC;oDAAE,UAAU,IAAI,QAAQ;oDAAE,UAAU,IAAI,QAAQ;oDAAE,WAAW,IAAI,SAAS;gDAAC;6CAAE;;;;;;;;;;6DAG1G,6LAAC;wCAAI,WAAU;kDAA6B;;;;;;kDAG9C,6LAAC;wCACC,SAAS,IAAM,eAAe;wCAC9B,UAAU,IAAI,kBAAkB,IAAI,CAAC;4CAAC;yCAAU,CAAC,QAAQ,CAAC,IAAI,kBAAkB;wCAChF,WAAW,CAAC,qDAAqD,EAC/D,IAAI,kBAAkB,IAAI,CAAC;4CAAC;yCAAU,CAAC,QAAQ,CAAC,IAAI,kBAAkB,IAClE,iDACA,uEACJ;kDAED,IAAI,kBAAkB,KAAK,cACxB,2BACA,IAAI,kBAAkB,KAAK,aAC3B,sBACA,IAAI,kBAAkB,KAAK,eAC3B,yBACA;;;;;;;+BAlEE,CAAC,EAAE,EAAE,GAAG;;;;;wBAsEtB;;;;;;;;;;;;0BAMN,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,gNAAK;gCAAC,WAAU;;;;;;0CACjB,6LAAC;gCAAG,WAAU;0CAAqC;;;;;;;;;;;;oBAGpD,CAAC,qBAAqB,EAAE,EAAE,MAAM,CAAC,CAAC,MAAa,CAAC,IAAI,kBAAkB,IAAI,IAAI,kBAAkB,KAAK,aAAa,IAAI,kBAAkB,KAAK,aAAa,MAAM,KAAK,kBACpK,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,gNAAK;gCAAC,WAAU;;;;;;0CACjB,6LAAC;gCAAE,WAAU;0CAAwB;;;;;;;;;;;6CAGvC,6LAAC;wBAAI,WAAU;kCACZ,CAAC,qBAAqB,EAAE,EAAE,MAAM,CAAC,CAAC,MAAa,CAAC,IAAI,kBAAkB,IAAI,IAAI,kBAAkB,KAAK,aAAa,IAAI,kBAAkB,KAAK,aAAa,GAAG,CAAC,CAAC,KAAU;4BACxK,qBACE,6LAAC;gCAAmB,WAAU;;kDAC5B,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;;kEACC,6LAAC;wDAAE,WAAU;kEAA2C;;;;;;kEACxD,6LAAC;wDAAE,WAAU;kEAA2B,IAAI,aAAa,IAAI,IAAI,WAAW,EAAE,YAAY,IAAI,eAAe,IAAI,IAAI,aAAa,IAAI,CAAC,OAAO,IAAI,WAAW,KAAK,WAAW,IAAI,WAAW,GAAG,WAAW;;;;;;;;;;;;0DAG5M,6LAAC;;kEACC,6LAAC;wDAAE,WAAU;kEAA2C;;;;;;kEACxD,6LAAC;wDAAE,WAAU;kEAA6B,IAAI,QAAQ,IAAI;;;;;;;;;;;;0DAG5D,6LAAC;;kEACC,6LAAC;wDAAE,WAAU;kEAA2C;;;;;;kEACxD,6LAAC;wDAAE,WAAU;kEAAkC,IAAI,SAAS;;;;;;;;;;;;0DAG9D,6LAAC;;kEACC,6LAAC;wDAAE,WAAU;kEAA2C;;;;;;kEACxD,6LAAC;wDAAE,WAAU;kEAA2B,IAAI,WAAW;;;;;;;;;;;;0DAGzD,6LAAC;;kEACC,6LAAC;wDAAE,WAAU;kEAA2C;;;;;;kEACxD,6LAAC;wDAAK,WAAW,CAAC,0DAA0D,EAC1E,IAAI,OAAO,KAAK,aAAa,4BAC7B,IAAI,OAAO,KAAK,SAAS,kCACzB,iCACA;kEACC,IAAI,OAAO,EAAE,iBAAiB;;;;;;;;;;;;0DAInC,6LAAC;;kEACC,6LAAC;wDAAE,WAAU;kEAA2C;;;;;;kEACxD,6LAAC;wDAAK,WAAW,CAAC,0DAA0D,EAC1E,IAAI,kBAAkB,KAAK,cAAc,gCACzC,IAAI,kBAAkB,KAAK,aAAa,4BACxC,IAAI,kBAAkB,KAAK,eAAe,8BAC1C,iCACA;kEACC,IAAI,kBAAkB,IAAI;;;;;;;;;;;;;;;;;;kDAKjC,6LAAC;wCACC,SAAS,IAAM,eAAe;wCAC9B,UAAU,IAAI,kBAAkB,IAAI,CAAC;4CAAC;yCAAU,CAAC,QAAQ,CAAC,IAAI,kBAAkB;wCAChF,WAAW,CAAC,qDAAqD,EAC/D,IAAI,kBAAkB,IAAI,CAAC;4CAAC;yCAAU,CAAC,QAAQ,CAAC,IAAI,kBAAkB,IAClE,iDACA,6EACJ;kDAED,IAAI,kBAAkB,KAAK,cACxB,2BACA,IAAI,kBAAkB,KAAK,aAC3B,sBACA,IAAI,kBAAkB,KAAK,eAC3B,yBACA;;;;;;;+BA7DE,CAAC,EAAE,EAAE,GAAG;;;;;wBAiEtB;;;;;;;;;;;;;;;;;;AAMZ;MAjMS;AAmMT,mCAAmC;AACnC,+DAA+D;AAC/D,SAAS,mBAAmB,EAAE,SAAS,EAAO;IAC5C,MAAM,iBAAiB,WAAW,UAAU;IAC5C,MAAM,aAAa,WAAW,OAAO,CAAC,KAAa;QACjD,MAAM,QAAQ,EAAE,SAAS,EAAE,eAAe,EAAE,WAAW,IAAI;QAC3D,OAAO,MAAM;IACf,GAAG,MAAM;IAET,kBAAkB;IAClB,MAAM,eAAe,WAAW,OAAO,CAAC,KAAU;QAChD,MAAM,SAAS,EAAE,MAAM,IAAI;QAC3B,GAAG,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,OAAO,IAAI,CAAC,IAAI;QACnC,OAAO;IACT,GAAG,CAAC,MAAM,CAAC;IAEX,QAAQ,GAAG,CAAC,mCAAmC;IAC/C,QAAQ,GAAG,CAAC,yCAAyC;IACrD,QAAQ,GAAG,CAAC,qCAAqC;IACjD,QAAQ,GAAG,CAAC,uCAAuC;IAEnD,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;kCAAgC;;;;;;kCAC9C,6LAAC;wBAAE,WAAU;kCAAkC;;;;;;;;;;;;0BAGjD,6LAAC;gBAAI,WAAU;;kCAEb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAE,WAAU;kDAA0D;;;;;;kDACvE,6LAAC;wCAAK,WAAU;kDAAW;;;;;;;;;;;;0CAE7B,6LAAC;gCAAE,WAAU;0CAAmC;;;;;;0CAChD,6LAAC;gCAAE,WAAU;0CAA6B;;;;;;;;;;;;kCAI5C,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAE,WAAU;kDAA0D;;;;;;kDACvE,6LAAC;wCAAK,WAAU;kDAAW;;;;;;;;;;;;0CAE7B,6LAAC;gCAAE,WAAU;0CAAmC;;;;;;0CAChD,6LAAC;gCAAE,WAAU;0CAA6B;;;;;;;;;;;;kCAI5C,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAE,WAAU;kDAA0D;;;;;;kDACvE,6LAAC;wCAAK,WAAU;kDAAW;;;;;;;;;;;;0CAE7B,6LAAC;gCAAI,WAAU;0CACZ,OAAO,OAAO,CAAC,cAAc,MAAM,GAAG,IACrC,OAAO,OAAO,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC,QAAQ,MAAqB,iBAC9D,6LAAC;wCAAiB,WAAU;;0DAC1B,6LAAC;gDAAK,WAAU;;oDAA0C;oDAAO;;;;;;;0DACjE,6LAAC;gDAAK,WAAU;0DAAkC;;;;;;;uCAF1C;;;;8DAMZ,6LAAC;oCAAE,WAAU;8CAAwB;;;;;;;;;;;;;;;;;;;;;;;YAO5C,iBAAiB,mBAChB,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAE,WAAU;;wBAA+C;sCACtC,6LAAC;4BAAK,WAAU;sCAAmB;;;;;;wBAAsB;sCAAgC,6LAAC;4BAAK,WAAU;;gCAAmB;gCAAW;;;;;;;wBAAa;;;;;;;;;;;;;;;;;;AAMpL;MA9ES;AAgFT,+DAA+D;AAC/D,+DAA+D;AAE/D,SAAS;IACP,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;;kCACZ,6LAAC;wBAAK,WAAU;kCAAW;;;;;;oBAAS;;;;;;;0BAEtC,6LAAC;gBAAE,WAAU;0BAA6B;;;;;;0BAE1C,6LAAC;gBAAI,WAAU;0BACZ;oBACC;wBACE,MAAM;wBACN,MAAM;wBACN,MAAM;wBACN,MAAM;wBACN,SAAS;wBACT,UAAU;wBACV,OAAO;wBACP,IAAI;oBACN;oBACA;wBACE,MAAM;wBACN,MAAM;wBACN,MAAM;wBACN,MAAM;wBACN,SAAS;wBACT,UAAU;wBACV,OAAO;wBACP,IAAI;oBACN;oBACA;wBACE,MAAM;wBACN,MAAM;wBACN,MAAM;wBACN,MAAM;wBACN,SAAS;wBACT,UAAU;wBACV,OAAO;wBACP,IAAI;oBACN;oBACA;wBACE,MAAM;wBACN,MAAM;wBACN,MAAM;wBACN,MAAM;wBACN,SAAS;wBACT,UAAU;wBACV,OAAO;wBACP,IAAI;oBACN;iBACD,CAAC,GAAG,CAAC,CAAC,MAAM,kBACX,6LAAC;wBAAY,WAAW,CAAC,0CAA0C,EAAE,KAAK,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,sEAAsE,CAAC;;0CAC9K,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;;0DACC,6LAAC;gDAAG,WAAU;;oDAAmC,KAAK,IAAI;oDAAC;oDAAE,KAAK,IAAI;;;;;;;0DACtE,6LAAC;gDAAE,WAAU;0DAAuC,KAAK,OAAO;;;;;;;;;;;;kDAElE,6LAAC;wCAAI,WAAW,CAAC,iBAAiB,EAAE,KAAK,KAAK,CAAC,6EAA6E,CAAC;kDAC1H,KAAK,IAAI;;;;;;;;;;;;0CAGd,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAK,WAAU;0DAA8B;;;;;;0DAC9C,6LAAC;gDAAK,WAAU;;oDAAwD;oDAAO,KAAK,IAAI;oDAAC;;;;;;;;;;;;;kDAE3F,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAK,WAAU;0DAA8B;;;;;;0DAC9C,6LAAC;gDAAK,WAAU;;oDAAyD,KAAK,IAAI;oDAAC;;;;;;;;;;;;;kDAErF,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAK,WAAU;0DAA8B;;;;;;0DAC9C,6LAAC;gDAAK,WAAU;0DAAyD,KAAK,QAAQ;;;;;;;;;;;;;;;;;;;uBArBlF;;;;;;;;;;;;;;;;AA6BpB;OAhFS;AAkFT,SAAS;IACP,MAAM,QAAQ;QACZ;YACE,MAAM;YACN,OAAO;YACP,QAAQ;gBAAC;aAAW;YACpB,aAAa;YACb,IAAI;YACJ,QAAQ;QACV;QACA;YACE,MAAM;YACN,OAAO;YACP,QAAQ;gBAAC;gBAAM;gBAAM;gBAAM;aAAM;YACjC,aAAa;YACb,IAAI;YACJ,QAAQ;QACV;QACA;YACE,MAAM;YACN,OAAO;YACP,QAAQ;gBAAC;gBAAM;gBAAM;gBAAO;aAAM;YAClC,aAAa;YACb,IAAI;YACJ,QAAQ;QACV;QACA;YACE,MAAM;YACN,OAAO;YACP,QAAQ;gBAAC;gBAAM;aAAM;YACrB,aAAa;YACb,IAAI;YACJ,QAAQ;QACV;QACA;YACE,MAAM;YACN,OAAO;YACP,QAAQ;gBAAC;gBAAM;gBAAM;gBAAO;aAAM;YAClC,aAAa;YACb,IAAI;YACJ,QAAQ;QACV;QACA;YACE,MAAM;YACN,OAAO;YACP,QAAQ;gBAAC;gBAAM;aAAM;YACrB,aAAa;YACb,IAAI;YACJ,QAAQ;QACV;QACA;YACE,MAAM;YACN,OAAO;YACP,QAAQ;gBAAC;gBAAO;aAAM;YACtB,aAAa;YACb,IAAI;YACJ,QAAQ;QACV;QACA;YACE,MAAM;YACN,OAAO;YACP,QAAQ;gBAAC;aAAM;YACf,aAAa;YACb,IAAI;YACJ,QAAQ;QACV;KACD;IAED,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;;kCACZ,6LAAC;wBAAK,WAAU;kCAAW;;;;;;oBAAS;;;;;;;0BAEtC,6LAAC;gBAAE,WAAU;0BAA6B;;;;;;0BAE1C,6LAAC;gBAAI,WAAU;0BACZ,MAAM,GAAG,CAAC,CAAC,GAAG,kBACb,6LAAC;wBAEC,WAAW,GAAG,EAAE,EAAE,CAAC,oCAAoC,EAAE,EAAE,MAAM,CAAC,sEAAsE,CAAC;;0CAEzI,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;;sDACC,6LAAC;4CAAG,WAAU;sDAAyC,EAAE,IAAI;;;;;;sDAC7D,6LAAC;4CAAK,WAAU;sDACb,EAAE,KAAK;;;;;;;;;;;;;;;;;0CAId,6LAAC;gCAAE,WAAU;;oCAAkD;oCAAE,EAAE,WAAW;oCAAC;;;;;;;0CAC/E,6LAAC;;kDACC,6LAAC;wCAAE,WAAU;kDAAuC;;;;;;kDACpD,6LAAC;wCAAI,WAAU;kDACZ,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,kBAChB,6LAAC;gDAEC,WAAU;0DAET;+CAHI;;;;;;;;;;;;;;;;;uBAjBR;;;;;;;;;;0BA6BX,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAE,WAAU;;sCACX,6LAAC;4BAAK,WAAU;sCAAyB;;;;;;wBAAkB;;;;;;;;;;;;;;;;;;AAKrE;OAlHS","debugId":null}}]
}