module.exports=[9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},46058,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},39118,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DEFAULT_SEGMENT_KEY:function(){return l},PAGE_SEGMENT_KEY:function(){return k},addSearchParamsIfPageSegment:function(){return i},computeSelectedLayoutSegment:function(){return j},getSegmentValue:function(){return f},getSelectedLayoutSegmentPath:function(){return function a(b,c,d=!0,e=[]){let g;if(d)g=b[1][c];else{let a=b[1];g=a.children??Object.values(a)[0]}if(!g)return e;let h=f(g[0]);return!h||h.startsWith(k)?e:(e.push(h),a(g,c,!1,e))}},isGroupSegment:function(){return g},isParallelRouteSegment:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return Array.isArray(a)?a[1]:a}function g(a){return"("===a[0]&&a.endsWith(")")}function h(a){return a.startsWith("@")&&"@children"!==a}function i(a,b){if(a.includes(k)){let a=JSON.stringify(b);return"{}"!==a?k+"?"+a:k}return a}function j(a,b){if(!a||0===a.length)return null;let c="children"===b?a[0]:a[a.length-1];return c===l?null:c}let k="__PAGE__",l="__DEFAULT__"},88644,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"InvariantError",{enumerable:!0,get:function(){return d}});class d extends Error{constructor(a,b){super(`Invariant: ${a.endsWith(".")?a:a+"."} This is a bug in Next.js.`,b),this.name="InvariantError"}}},54427,(a,b,c)=>{"use strict";function d(){let a,b,c=new Promise((c,d)=>{a=c,b=d});return{resolve:a,reject:b,promise:c}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createPromiseWithResolvers",{enumerable:!0,get:function(){return d}})},76472,a=>{"use strict";let b=(0,a.i(70106).default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);a.s(["Heart",()=>b],76472)},16201,a=>{"use strict";let b=(0,a.i(70106).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],16201)},24987,a=>{"use strict";let b=(0,a.i(70106).default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);a.s(["MapPin",()=>b],24987)},41997,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={BailoutToCSRError:function(){return g},isBailoutToCSRError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="BAILOUT_TO_CLIENT_SIDE_RENDERING";class g extends Error{constructor(a){super(`Bail out to client-side rendering: ${a}`),this.reason=a,this.digest=f}}function h(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===f}},92e3,a=>{"use strict";let b=(0,a.i(70106).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],92e3)},28193,a=>{"use strict";let b=(0,a.i(70106).default)("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);a.s(["Loader",()=>b],28193)},31643,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(24987),e=a.i(28193),f=a.i(92e3),g=a.i(16201);a.s(["LocationDetector",0,({onLocationDetected:a,label:h="Your Location",showMap:i=!1})=>{let{location:j,isLoading:k,error:l,detectedAddress:m,requestLocation:n,clearError:o}=(()=>{let[a,b]=(0,c.useState)(null),[d,e]=(0,c.useState)(!1),[f,g]=(0,c.useState)(null),[h,i]=(0,c.useState)(null),j=async(a,b)=>{try{let c=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${a}&lon=${b}&zoom=18&addressdetails=1`),d=await c.json();if(d.address){let a=d.address,b=[];return a.house_number&&b.push(a.house_number),a.road&&b.push(a.road),a.suburb?b.push(a.suburb):a.neighbourhood?b.push(a.neighbourhood):a.village?b.push(a.village):a.hamlet&&b.push(a.hamlet),a.city?b.push(a.city):a.town&&b.push(a.town),a.postcode&&b.push(`Pin Code ${a.postcode}`),a.state&&b.push(a.state),a.country&&b.push(a.country),b.filter(Boolean).join(", ")||"Location detected"}return"Location detected"}catch(a){return console.error("Error fetching address:",a),"Location detected"}};return{location:a,isLoading:d,error:f,detectedAddress:h,requestLocation:(0,c.useCallback)(()=>{if(e(!0),g(null),!navigator.geolocation){g("Geolocation not supported on this device"),e(!1);return}navigator.geolocation.getCurrentPosition(async a=>{try{let{latitude:c,longitude:d}=a.coords;console.log("[useLocationDetection] Got coordinates:",c,d);let e=await j(c,d);b({latitude:c,longitude:d,address:e}),i(e),g(null)}catch(a){console.error("Error processing location:",a),g("Failed to process location")}finally{e(!1)}},a=>{let c="Failed to get location";a.code===a.PERMISSION_DENIED?c="Location permission denied. Enable it in browser settings.":a.code===a.POSITION_UNAVAILABLE?c="Location unavailable. Make sure location services are enabled.":a.code===a.TIMEOUT&&(c="Location request timed out. Check your internet and try again."),console.error("[useLocationDetection] Geolocation error:",a.code,c),g(c),b(null),e(!1)},{timeout:3e4,enableHighAccuracy:!0,maximumAge:0})},[]),clearError:(0,c.useCallback)(()=>{g(null)},[])}})(),[p,q]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{j&&!i&&(console.log("[LocationDetector] Auto-confirming location:",j),a(j.latitude,j.longitude))},[j,i]),(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsxs)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:[h," ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("div",{className:"relative",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 w-full p-3 border border-gray-300 rounded-lg bg-white",children:[(0,b.jsx)(d.MapPin,{className:"w-5 h-5 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"Click 'Detect Location' to enable location services",value:m||"",readOnly:!0,className:"flex-1 outline-none bg-transparent text-gray-700 placeholder-gray-400"}),(0,b.jsx)("button",{onClick:n,disabled:k,className:"px-4 py-1 bg-blue-600 text-white rounded-lg text-sm font-semibold hover:bg-blue-700 disabled:bg-gray-400 flex items-center gap-2",children:k?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Loader,{className:"w-4 h-4 animate-spin"}),"Detecting..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.MapPin,{className:"w-4 h-4"}),"Detect Location"]})})]})}),l&&(0,b.jsxs)("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start gap-2",children:[(0,b.jsx)(f.AlertCircle,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-red-800 font-semibold text-sm",children:"Error"}),(0,b.jsx)("p",{className:"text-red-700 text-sm",children:l})]}),(0,b.jsx)("button",{onClick:o,className:"ml-2 text-red-600 hover:text-red-700 font-semibold text-sm",children:"Dismiss"})]}),p&&j&&(0,b.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Confirm Location:"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:m||`${j.latitude.toFixed(6)}, ${j.longitude.toFixed(6)}`})]}),(0,b.jsx)("div",{className:"w-full h-64 rounded-lg overflow-hidden mb-3",children:(0,b.jsx)("iframe",{title:"Location Map",width:"100%",height:"100%",frameBorder:"0",src:`https://www.openstreetmap.org/export/embed.html?bbox=${j.longitude-.01},${j.latitude-.01},${j.longitude+.01},${j.latitude+.01}&layer=mapnik&marker=${j.latitude},${j.longitude}`})}),(0,b.jsx)("button",{onClick:()=>{j&&(a(j.latitude,j.longitude),q(!1))},className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-blue-700",children:"Use This Location"})]}),j&&!p&&(0,b.jsxs)("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg flex items-start gap-2",children:[(0,b.jsx)(g.CheckCircle,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-green-800 font-semibold text-sm",children:"Location Captured"}),(0,b.jsxs)("p",{className:"text-green-700 text-xs mt-1",children:["Latitude: ",j.latitude.toFixed(6),(0,b.jsx)("br",{}),"Longitude: ",j.longitude.toFixed(6)]})]})]})]})}],31643)},99084,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(76472),f=a.i(38246),g=a.i(31643);function h(){let a=(0,d.useSearchParams)(),h=(0,d.useRouter)(),[i,j]=(0,c.useState)(a.get("type")||"donor"),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)({fullName:"",hospitalName:"",recipientName:"",email:"",password:"",phone:"",bloodType:"O+",hospitalId:"",licenseNumber:"",urgency:"low",latitude:"",longitude:"",address:""}),q=a=>{let{name:b,value:c}=a.target;p(a=>({...a,[b]:c}))},r=async a=>{a.preventDefault(),n(!0);let b="http://localhost:5000",c=k?`${b}/auth/login`:`${b}/auth/register`,d={fullName:"hospital"===i?o.hospitalName:"recipient"===i?o.recipientName:o.fullName,email:o.email,password:o.password,phone:o.phone,bloodType:"donor"===i?o.bloodType:void 0,hospitalId:"hospital"===i?o.hospitalId:void 0,role:i};if("hospital"===i&&!k){if(!o.latitude||!o.longitude){alert("Hospital location (latitude and longitude) is required"),n(!1);return}d.location={latitude:parseFloat(o.latitude),longitude:parseFloat(o.longitude)},o.address&&(d.address=o.address)}try{let a=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),b=await a.json();if(!b.success){alert(b.message||"Something went wrong."),n(!1);return}localStorage.removeItem("token"),localStorage.removeItem("userId"),localStorage.removeItem("role"),localStorage.removeItem("user"),localStorage.removeItem("locationSharing"),localStorage.removeItem("available"),console.log("[Auth] Cleared old authentication data from localStorage"),b.token&&(localStorage.setItem("token",b.token),localStorage.setItem("userId",b.user.id||b.user._id),localStorage.setItem("role",b.user.role),localStorage.setItem("user",JSON.stringify(b.user)),console.log("[Auth] Saved new user to localStorage:",b.user));let e=b.user.role;"donor"===e&&h.push("/donor/dashboard"),"hospital"===e&&h.push("/hospital/dashboard"),"recipient"===e&&h.push("/recipient/dashboard")}catch(a){console.error(a),alert("Network or server error.")}n(!1)},s={hospital:{title:"Hospital Registration",icon:"ðŸ¥",color:"from-red-600 to-red-700",nameField:"hospitalName",placeholder:"Hospital Name"},donor:{title:"Become a Life Saver",icon:"â¤ï¸",color:"from-red-500 to-red-600",nameField:"fullName",placeholder:"Full Name"},recipient:{title:"Request Blood",icon:"ðŸ©¸",color:"from-red-600 to-red-800",nameField:"recipientName",placeholder:"Recipient Name"}}[i];return(0,b.jsxs)("main",{className:"min-h-screen bg-gradient-to-br from-white via-red-50 to-red-100 flex items-center justify-center p-4",children:[(0,b.jsxs)(f.default,{href:"/",className:"absolute top-4 left-4 flex items-center gap-2 text-red-600 hover:text-red-700 font-semibold",children:[(0,b.jsx)(e.Heart,{className:"w-5 h-5"}),"Pulse Bank"]}),(0,b.jsxs)("div",{className:"w-full max-w-4xl",children:[(0,b.jsx)("div",{className:"grid md:grid-cols-3 gap-4 mb-8",children:["hospital","donor","recipient"].map(a=>(0,b.jsxs)("button",{onClick:()=>j(a),className:`p-6 rounded-xl border-2 transition transform hover:scale-105 ${i===a?"bg-red-600 text-white border-red-700 shadow-lg":"bg-white text-gray-700 border-gray-200 hover:border-red-400"}`,children:[(0,b.jsx)("div",{className:"text-4xl mb-3",children:"hospital"===a?"ðŸ¥":"donor"===a?"â¤ï¸":"ðŸ©¸"}),(0,b.jsx)("div",{className:"font-semibold capitalize",children:a})]},a))}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden",children:[(0,b.jsxs)("div",{className:`bg-gradient-to-r ${s.color} text-white p-8 text-center`,children:[(0,b.jsx)("div",{className:"text-5xl mb-4",children:s.icon}),(0,b.jsx)("h1",{className:"text-3xl font-bold mb-2",children:s.title}),(0,b.jsx)("p",{className:"opacity-90",children:k?"Welcome back! Sign in to continue":"Join our community and save lives"})]}),(0,b.jsxs)("form",{onSubmit:r,className:"p-8 space-y-6",children:[!k&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:s.placeholder}),(0,b.jsx)("input",{type:"text",name:s.nameField,value:o[s.nameField],onChange:q,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",placeholder:s.placeholder})]}),!k&&"hospital"===i&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Hospital ID"}),(0,b.jsx)("input",{type:"text",name:"hospitalId",value:o.hospitalId,onChange:q,required:!0,placeholder:"Enter hospital ID",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),k&&"hospital"===i&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Hospital ID"}),(0,b.jsx)("input",{type:"text",name:"hospitalId",value:o.hospitalId,onChange:q,required:!0,placeholder:"Enter hospital ID",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),"hospital"!==i&&(0,b.jsxs)("div",{className:k?"space-y-6":"grid md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email"}),(0,b.jsx)("input",{type:"email",name:"email",value:o.email,onChange:q,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",placeholder:k?"Enter your email":""})]}),!k&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Phone"}),(0,b.jsx)("input",{type:"tel",name:"phone",value:o.phone,onChange:q,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]})]}),!k&&"hospital"===i&&(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email"}),(0,b.jsx)("input",{type:"email",name:"email",value:o.email,onChange:q,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Phone"}),(0,b.jsx)("input",{type:"tel",name:"phone",value:o.phone,onChange:q,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]})]}),!k&&"hospital"===i&&(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(g.LocationDetector,{onLocationDetected:(a,b)=>{p(c=>({...c,latitude:a.toString(),longitude:b.toString()}))},label:"Hospital Location",showMap:!1})}),k&&"hospital"===i&&(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email"}),(0,b.jsx)("input",{type:"email",name:"email",value:o.email,onChange:q,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Phone"}),(0,b.jsx)("input",{type:"tel",name:"phone",value:o.phone,onChange:q,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",placeholder:"Optional for login"})]})]}),!k&&"donor"===i&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Blood Type"}),(0,b.jsx)("select",{name:"bloodType",value:o.bloodType,onChange:q,className:"w-full px-4 py-3 border border-gray-300 rounded-lg",children:["O+","O-","A+","A-","B+","B-","AB+","AB-"].map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Password"}),(0,b.jsx)("input",{type:"password",name:"password",value:o.password,onChange:q,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),(0,b.jsx)("button",{type:"button",onClick:()=>l(!k),className:"text-red-600 hover:text-red-700 font-semibold text-sm",children:k?"Create new account":"Already have an account? Login"}),(0,b.jsx)("button",{type:"submit",disabled:m,className:"w-full bg-gradient-to-r from-red-600 to-red-700 text-white font-bold py-3 rounded-lg hover:from-red-700 hover:to-red-800 disabled:opacity-50",children:m?"Processing...":k?"Sign In":"Create Account"})]})]})]})]})}a.s(["default",()=>h])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__e16cb1d9._.js.map