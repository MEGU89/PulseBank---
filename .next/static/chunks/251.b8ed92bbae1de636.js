"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[251],{6251:function(e,l,t){t.r(l),t.d(l,{default:function(){return p}});var n=t(7437),o=t(2265),i=t(166);let a=(0,i.default)(()=>Promise.all([t.e(212),t.e(305)]).then(t.bind(t,9305)).then(e=>e.MapContainer),{loadableGenerated:{webpack:()=>[9305]},ssr:!1}),d=(0,i.default)(()=>Promise.all([t.e(212),t.e(305)]).then(t.bind(t,9305)).then(e=>e.TileLayer),{loadableGenerated:{webpack:()=>[9305]},ssr:!1}),r=(0,i.default)(()=>Promise.all([t.e(212),t.e(305)]).then(t.bind(t,9305)).then(e=>e.Marker),{loadableGenerated:{webpack:()=>[9305]},ssr:!1}),s=(0,i.default)(()=>Promise.all([t.e(212),t.e(305)]).then(t.bind(t,9305)).then(e=>e.Popup),{loadableGenerated:{webpack:()=>[9305]},ssr:!1});Promise.all([t.e(212),t.e(305)]).then(t.bind(t,9305)).then(e=>{e.useMap});let u=e=>e.divIcon({html:'<div style="\n      background-color: #ef4444;\n      border: 2px solid white;\n      border-radius: 50%;\n      width: 24px;\n      height: 24px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      box-shadow: 0 2px 6px rgba(0,0,0,0.3);\n      font-weight: bold;\n      color: white;\n      font-size: 12px;\n    ">â™¥</div>',className:"custom-marker",iconSize:[24,24],iconAnchor:[12,12],popupAnchor:[0,-12]}),c=e=>e.divIcon({html:'<div style="\n      background-color: #2563eb;\n      border: 2px solid white;\n      border-radius: 50%;\n      width: 28px;\n      height: 28px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      box-shadow: 0 2px 6px rgba(0,0,0,0.3);\n      font-weight: bold;\n      color: white;\n      font-size: 12px;\n    ">H</div>',className:"hospital-marker",iconSize:[28,28],iconAnchor:[14,14],popupAnchor:[0,-12]}),h=(0,i.default)(()=>Promise.all([t.e(212),t.e(305)]).then(t.bind(t,9305)).then(e=>{let{useMap:l}=e;return{default:()=>{let e=l();return(0,o.useEffect)(()=>()=>{},[e]),null}}}),{loadableGenerated:{webpack:()=>[9305]},ssr:!1});function p(e){var l;let{activeDonors:i=[],hospitals:p=[],currentLocation:b=null}=e,[v,f]=(0,o.useState)(!1),[x,m]=(0,o.useState)(null),[g]=(0,o.useState)(()=>"map-".concat(Math.random().toString(36).slice(2,9)));if((0,o.useEffect)(()=>{f(!0)},[]),(0,o.useEffect)(()=>{(async()=>{let[e]=await Promise.all([t.e(212).then(t.t.bind(t,759,23)),Promise.all([t.e(641),t.e(46)]).then(t.t.bind(t,5046,23))]);m(e.default||e)})()},[]),!v||!x)return(0,n.jsx)("div",{className:"w-full h-full bg-gray-200"});let w=i&&i.length>0&&(null===(l=i[0])||void 0===l?void 0:l.location)?[i[0].location.latitude,i[0].location.longitude]:[21.1466,79.0889],j=(i||[]).filter(e=>{var l,t;return(null==e?void 0:null===(l=e.location)||void 0===l?void 0:l.latitude)&&(null==e?void 0:null===(t=e.location)||void 0===t?void 0:t.longitude)}),M=(p||[]).filter(e=>{var l,t;return(null==e?void 0:null===(l=e.location)||void 0===l?void 0:l.latitude)&&(null==e?void 0:null===(t=e.location)||void 0===t?void 0:t.longitude)}),k=(e,l,t,n)=>{let o=(t-e)*Math.PI/180,i=(n-l)*Math.PI/180,a=Math.sin(o/2)*Math.sin(o/2)+Math.cos(e*Math.PI/180)*Math.cos(t*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371};return console.log("[LeafletMap] Rendering with:",{validDonors:j.length,validHospitals:M.length}),(0,n.jsx)("div",{className:"w-full h-full relative",children:(0,n.jsxs)(a,{center:w,zoom:12,style:{height:"100%",width:"100%",position:"absolute",top:0,left:0},children:[(0,n.jsx)(h,{}),(0,n.jsx)(d,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"\xa9 OpenStreetMap contributors"}),j.map((e,l)=>(0,n.jsx)(r,{position:[e.location.latitude,e.location.longitude],icon:u(x),children:(0,n.jsx)(s,{children:(0,n.jsxs)("div",{children:[(0,n.jsx)("b",{children:e.fullName||"Donor"})," ",(0,n.jsx)("br",{}),"Blood: ",e.bloodType||"Unknown"]})})},"donor-".concat(l))),M.map((e,l)=>{let t=null;try{var o,i,a,d;let l=null!==(i=null!==(o=null==b?void 0:b.lat)&&void 0!==o?o:null==b?void 0:b.latitude)&&void 0!==i?i:null,n=null!==(d=null!==(a=null==b?void 0:b.lng)&&void 0!==a?a:null==b?void 0:b.longitude)&&void 0!==d?d:null;if(null!=l&&null!=n&&e.location&&null!=e.location.latitude&&null!=e.location.longitude){let o=k(l,n,e.location.latitude,e.location.longitude);t="".concat(o<1?(1e3*o).toFixed(0)+" m":o.toFixed(1)+" km")}}catch(e){}return(0,n.jsx)(r,{position:[e.location.latitude,e.location.longitude],icon:c(x),children:(0,n.jsx)(s,{children:(0,n.jsxs)("div",{children:[(0,n.jsx)("b",{children:e.fullName||e.name||e.hospital||"Hospital"})," ",(0,n.jsx)("br",{}),e.notes&&(0,n.jsx)("div",{className:"text-sm",children:e.notes}),t&&(0,n.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[t," away"]})]})})},"hospital-".concat(l))})]},g)},g)}}}]);