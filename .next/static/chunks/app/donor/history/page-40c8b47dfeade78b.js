(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[274],{7090:function(e,t,s){Promise.resolve().then(s.bind(s,2368))},2368:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(7437),r=s(2265),n=s(4474),l=s(2660),o=s(8997),i=s(7648);function c(){let[e,t]=(0,r.useState)(null),[s,c]=(0,r.useState)("Donor"),[d,u]=(0,r.useState)([]),[h,m]=(0,r.useState)([]),[x,p]=(0,r.useState)([]),[f,g]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=localStorage.getItem("user");if(e){let s=JSON.parse(e);t(s._id||s.id||null),c(s.fullName||"Donor")}if(!e){let e=localStorage.getItem("token");if(e)try{let s=(0,n.o)(e);t(s.userId||s._id||null)}catch(e){}}},[]),(0,r.useEffect)(()=>{e&&Promise.all([fetch("http://localhost:5000/schedule/donor/".concat(e)).then(e=>e.json()),fetch("http://localhost:5000/request/all").then(e=>e.json())]).then(e=>{let[t,s]=e;u((t.schedules||[]).filter(e=>e.status&&("completed"===e.status.toLowerCase()||"cancelled"===e.status.toLowerCase())));let a=s.requests||[],r=a.filter(e=>e.hospital&&""!==e.hospital&&!e.isRecipientRequest),n=a.filter(e=>e.isRecipientRequest||!e.hospital||""===e.hospital),l=r.filter(e=>e.confirmationStatus&&("Successful"===e.confirmationStatus||"Rejected"===e.confirmationStatus)),o=n.filter(e=>e.confirmationStatus&&("Successful"===e.confirmationStatus||"Rejected"===e.confirmationStatus));m(l),p(o)}).catch(e=>console.error("Error fetching history:",e)).finally(()=>g(!1))},[e]),(0,a.jsxs)("main",{className:"min-h-screen bg-linear-to-br from-white via-red-50 to-white",children:[(0,a.jsx)("header",{className:"bg-red-600 text-white p-6 shadow-lg sticky top-0 z-50",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center gap-4",children:[(0,a.jsx)(i.default,{href:"/donor/dashboard",className:"hover:opacity-80 transition",children:(0,a.jsx)(l.Z,{className:"w-6 h-6"})}),(0,a.jsx)(o.Z,{className:"w-8 h-8 fill-white"}),(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Donation Request History"})]})}),(0,a.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,a.jsx)("div",{className:"bg-white rounded-2xl shadow-xl p-8 space-y-8",children:f?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-600 text-lg",children:"Loading history..."})}):(0,a.jsxs)(a.Fragment,{children:[d.length>0&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-red-700 flex items-center gap-2",children:"\uD83D\uDCC5 Scheduled Donations"}),(0,a.jsx)("div",{className:"space-y-3",children:d.map((e,t)=>{var s,r,n;return(0,a.jsx)("div",{className:"p-5 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg border-l-4 border-blue-500 shadow-sm hover:shadow-md transition",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-lg font-bold text-blue-900",children:(null===(s=e.requestId)||void 0===s?void 0:s.hospital)||e.hospital||"Hospital"}),(0,a.jsxs)("div",{className:"mt-2 space-y-1 text-sm text-blue-700",children:[(0,a.jsxs)("p",{children:["\uD83D\uDCC5 ",(0,a.jsx)("span",{className:"font-semibold",children:e.date})," @ ",(0,a.jsx)("span",{className:"font-semibold",children:e.time})]}),(0,a.jsxs)("p",{children:["\uD83D\uDC89 Units: ",(0,a.jsx)("span",{className:"font-semibold",children:(null===(r=e.requestId)||void 0===r?void 0:r.unitsNeeded)||e.unitsNeeded})," | Blood: ",(0,a.jsx)("span",{className:"font-semibold",children:(null===(n=e.requestId)||void 0===n?void 0:n.bloodType)||e.bloodType})]})]})]}),(0,a.jsx)("span",{className:"px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap ml-4 ".concat("completed"===e.status.toLowerCase()?"bg-green-200 text-green-800":"bg-orange-200 text-orange-800"),children:e.status.toUpperCase()})]})},t)})})]}),h.length>0&&(0,a.jsxs)("div",{className:"border-t pt-6 space-y-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-red-700 flex items-center gap-2",children:"\uD83C\uDFE5 Hospital Requests"}),(0,a.jsx)("div",{className:"space-y-3",children:h.map((e,t)=>(0,a.jsx)("div",{className:"p-5 rounded-lg border-l-4 shadow-sm hover:shadow-md transition ".concat("Successful"===e.confirmationStatus?"bg-gradient-to-r from-green-50 to-green-100 border-green-500":"bg-gradient-to-r from-red-50 to-red-100 border-red-500"),children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-lg font-bold ".concat("Successful"===e.confirmationStatus?"text-green-900":"text-red-900"),children:e.hospital}),(0,a.jsx)("div",{className:"mt-2 space-y-1 text-sm",children:(0,a.jsxs)("p",{className:"Successful"===e.confirmationStatus?"text-green-700":"text-red-700",children:["\uD83D\uDC89 ",e.unitsNeeded," units — \uD83E\uDE78 ",e.bloodType]})})]}),(0,a.jsx)("span",{className:"px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap ml-4 ".concat("Successful"===e.confirmationStatus?"bg-green-200 text-green-800":"bg-red-200 text-red-800"),children:e.confirmationStatus.toUpperCase()})]})},t))})]}),x.length>0&&(0,a.jsxs)("div",{className:"border-t pt-6 space-y-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-red-700 flex items-center gap-2",children:"\uD83D\uDC65 Recipient Requests"}),(0,a.jsx)("div",{className:"space-y-3",children:x.map((e,t)=>{var s;return(0,a.jsx)("div",{className:"p-5 rounded-lg border-l-4 shadow-sm hover:shadow-md transition ".concat("Successful"===e.confirmationStatus?"bg-gradient-to-r from-green-50 to-green-100 border-green-500":"bg-gradient-to-r from-red-50 to-red-100 border-red-500"),children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-lg font-bold ".concat("Successful"===e.confirmationStatus?"text-green-900":"text-red-900"),children:e.recipientName||(null===(s=e.requestedBy)||void 0===s?void 0:s.fullName)||"Recipient"}),(0,a.jsx)("div",{className:"mt-2 space-y-1 text-sm",children:(0,a.jsxs)("p",{className:"Successful"===e.confirmationStatus?"text-green-700":"text-red-700",children:["\uD83D\uDC89 ",e.unitsNeeded," units — \uD83E\uDE78 ",e.bloodType]})})]}),(0,a.jsx)("span",{className:"px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap ml-4 ".concat("Successful"===e.confirmationStatus?"bg-green-200 text-green-800":"bg-red-200 text-red-800"),children:e.confirmationStatus.toUpperCase()})]})},t)})})]}),0===d.length&&0===h.length&&0===x.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(o.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 text-lg",children:"No donation history yet"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm mt-2",children:"Your completed and rejected donations will appear here"})]})]})})})]})}},2660:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8997:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},4474:function(e,t,s){"use strict";s.d(t,{o:function(){return r}});class a extends Error{}function r(e,t){let s;if("string"!=typeof e)throw new a("Invalid token specified: must be a string");t||(t={});let r=!0===t.header?0:1,n=e.split(".")[r];if("string"!=typeof n)throw new a(`Invalid token specified: missing part #${r+1}`);try{s=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var s;return s=t,decodeURIComponent(atob(s).replace(/(.)/g,(e,t)=>{let s=t.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}catch(e){return atob(t)}}(n)}catch(e){throw new a(`Invalid token specified: invalid base64 for part #${r+1} (${e.message})`)}try{return JSON.parse(s)}catch(e){throw new a(`Invalid token specified: invalid json for part #${r+1} (${e.message})`)}}a.prototype.name="InvalidTokenError"}},function(e){e.O(0,[216,971,117,744],function(){return e(e.s=7090)}),_N_E=e.O()}]);