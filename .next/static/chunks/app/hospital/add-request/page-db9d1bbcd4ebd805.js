(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[318],{8745:function(e,t,r){Promise.resolve().then(r.bind(r,9769))},9769:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var s=r(7437),a=r(2265),n=r(7648),l=r(8997),o=r(9397),i=r(4474),d=r(9376);function c(){let e=(0,d.useRouter)(),[t,r]=(0,a.useState)({bloodType:"O+",unitsNeeded:"",urgency:"LOW",hospital:"",locationKm:""}),[c,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=localStorage.getItem("token");if(e)try{let t=(0,i.o)(e);if(null==t?void 0:t.userId){m(t.userId);return}}catch(e){}let t=localStorage.getItem("userId");t&&m(t)},[]);let f=e=>{let{name:t,value:s}=e.target;r(e=>({...e,[t]:s}))},p=async r=>{r.preventDefault();let{bloodType:s,unitsNeeded:a,urgency:n,hospital:l,locationKm:o}=t;if(!s||!a||!n||!l||!o){alert("Please fill all fields.");return}if(!h){alert("Hospital identity not found. Please login again.");return}let i={bloodType:s,unitsNeeded:Number(a),hospital:l,urgency:n,locationKm:Number(o),requestedBy:h};u(!0);try{let t=await fetch("http://localhost:5000/request/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),r=await t.json();if(!t.ok||!r.success){alert("Error: "+(r.message||r.error||"Failed to create request.")),u(!1);return}alert("Blood request created successfully!"),e.push("/hospital/dashboard")}catch(e){console.error(e),alert("Network or server error.")}finally{u(!1)}};return(0,s.jsxs)("main",{className:"min-h-screen bg-gradient-to-br from-white via-red-50 to-white p-6",children:[(0,s.jsxs)("header",{className:"bg-gradient-to-r from-red-600 to-red-700 text-white p-6 rounded-xl shadow-lg flex justify-between items-center mb-10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(l.Z,{className:"w-8 h-8 fill-white"}),(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Add New Blood Request"})]}),(0,s.jsx)(n.default,{href:"/hospital/dashboard",className:"bg-white text-red-600 px-4 py-2 rounded-lg font-semibold hover:bg-red-50 transition",children:"Back to Dashboard"})]}),(0,s.jsxs)("div",{className:"max-w-3xl mx-auto bg-white shadow-xl rounded-2xl p-10 border-l-4 border-red-600",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,s.jsx)(o.Z,{className:"w-6 h-6 text-red-600"}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-red-700",children:"Request Details"})]}),(0,s.jsxs)("form",{onSubmit:p,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-semibold text-gray-700 mb-2",children:"Blood Type"}),(0,s.jsx)("select",{name:"bloodType",value:t.bloodType,onChange:f,className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-red-500",children:["O+","O-","A+","A-","B+","B-","AB+","AB-"].map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-semibold text-gray-700 mb-2",children:"Units Needed"}),(0,s.jsx)("input",{type:"number",min:1,name:"unitsNeeded",value:t.unitsNeeded,onChange:f,className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-red-500",placeholder:"Number of units",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-semibold text-gray-700 mb-2",children:"Urgency Level"}),(0,s.jsxs)("select",{name:"urgency",value:t.urgency,onChange:f,className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-red-500",children:[(0,s.jsx)("option",{value:"LOW",children:"Low"}),(0,s.jsx)("option",{value:"MODERATE",children:"Moderate"}),(0,s.jsx)("option",{value:"HIGH",children:"High"}),(0,s.jsx)("option",{value:"CRITICAL",children:"Critical"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-semibold text-gray-700 mb-2",children:"Hospital Name"}),(0,s.jsx)("input",{type:"text",name:"hospital",value:t.hospital,onChange:f,className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-red-500",placeholder:"Hospital name",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-semibold text-gray-700 mb-2",children:"Distance (km)"}),(0,s.jsx)("input",{type:"number",min:0,step:"0.1",name:"locationKm",value:t.locationKm,onChange:f,className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-red-500",placeholder:"Distance radius to search donors",required:!0})]}),(0,s.jsx)("div",{className:"md:col-span-2 flex justify-center mt-6",children:(0,s.jsx)("button",{type:"submit",disabled:c,className:"px-10 py-3 bg-gradient-to-r from-red-600 to-red-700 text-white font-semibold rounded-lg shadow-lg hover:from-red-700 hover:to-red-800 transition disabled:opacity-50",children:c?"Submitting...":"Submit Request"})})]}),(0,s.jsx)("p",{className:"mt-6 text-sm text-gray-600",children:"Note: request will be visible to donors nearby based on urgency and distance."})]})]})}},8997:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},9397:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},4474:function(e,t,r){"use strict";r.d(t,{o:function(){return a}});class s extends Error{}function a(e,t){let r;if("string"!=typeof e)throw new s("Invalid token specified: must be a string");t||(t={});let a=!0===t.header?0:1,n=e.split(".")[a];if("string"!=typeof n)throw new s(`Invalid token specified: missing part #${a+1}`);try{r=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var r;return r=t,decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}catch(e){return atob(t)}}(n)}catch(e){throw new s(`Invalid token specified: invalid base64 for part #${a+1} (${e.message})`)}try{return JSON.parse(r)}catch(e){throw new s(`Invalid token specified: invalid json for part #${a+1} (${e.message})`)}}s.prototype.name="InvalidTokenError"}},function(e){e.O(0,[216,971,117,744],function(){return e(e.s=8745)}),_N_E=e.O()}]);