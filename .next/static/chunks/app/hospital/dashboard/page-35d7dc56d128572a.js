(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[537],{3599:function(e,t,s){Promise.resolve().then(s.bind(s,897))},897:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var r=s(7437),o=s(2265),a=s(8985),n=s(8997),i=s(8736),l=s(1047),d=s(7692),c=s(7877),u=s(9322),m=s(9397),x=s(3774),h=s(5805),g=s(3609),p=s(525),b=s(7648),f=s(166),y=s(819);let v=(0,f.default)(()=>s.e(461).then(s.bind(s,2461)),{loadableGenerated:{webpack:()=>[2461]},ssr:!1});function j(){let[e,t]=(0,o.useState)("Hospital"),[s,f]=(0,o.useState)(null),[j,S]=(0,o.useState)(""),[k,q]=(0,o.useState)(""),[B,_]=(0,o.useState)(""),[D,A]=(0,o.useState)(null),[I,C]=(0,o.useState)(!1),[R,P]=(0,o.useState)(!1),[Z,E]=(0,o.useState)(!1),[H,T]=(0,o.useState)([]),[M,O]=(0,o.useState)([]),[z,L]=(0,o.useState)([]),[F,U]=(0,o.useState)([]),[G,J]=(0,o.useState)({totalRequests:0,livesSaved:0,donorsNearby:0,avgMatchTime:0}),V=(0,a.s)(),[W,Y]=(0,o.useState)(!1),K=()=>{let t=s,r=e;try{let e=localStorage.getItem("user");if(e){let s=JSON.parse(e);t=t||s._id||s.id||null,r=r||s.fullName||s.name||null}}catch(e){}return{currentHospitalId:t,currentHospitalName:r}};(0,o.useEffect)(()=>{let e=localStorage.getItem("user");if(e){let s=JSON.parse(e);t(s.fullName||"Hospital"),f(s._id||null),S(s.email||""),q(s.phone||""),_(s.profileImage||"")}},[]),(0,o.useEffect)(()=>{let e=e=>{let s=(null==e?void 0:e.detail)||{};t(s.fullName||"Hospital"),S(s.email||""),q(s.phone||""),_(s.profileImage||"")};return window.addEventListener("user-updated",e),()=>window.removeEventListener("user-updated",e)},[]);let Q=async()=>{if(!s){console.log("Hospital ID not available yet");return}if(!navigator.geolocation){console.error("Geolocation not supported"),E(!0);return}console.log("Requesting geolocation permission..."),P(!0),navigator.geolocation.getCurrentPosition(async e=>{let{latitude:t,longitude:r}=e.coords;console.log("Location obtained: ".concat(t,", ").concat(r)),A({latitude:t,longitude:r}),P(!1);try{if(!s){console.error("Hospital ID not available. Please log in again."),P(!1),alert("Hospital ID not found. Please log out and log in again.");return}let e=await fetch("http://localhost:5000/hospital/update-location",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hospitalId:s,latitude:t,longitude:r})});if(!e.ok){let t=await e.json().catch(()=>({}));console.error("Failed to update location: HTTP ".concat(e.status)),console.error("Error response:",t),404===e.status?"Hospital not found. Please log in again."===t.message?(console.error("Hospital record not found in database for ID: ".concat(s)),console.warn("Your hospital account may have been deleted. Clearing session..."),localStorage.removeItem("user"),alert("Your hospital account was not found in the system. Please log in again."),window.location.href="/auth?type=hospital"):(console.error("Backend endpoint not found. Ensure the backend server is running on http://localhost:5000"),alert("Location update failed. Please ensure backend server is running and try again.")):400===e.status?(console.error("Bad request:",t.message),alert("Missing required location data. Please try again.")):alert("Error updating location: HTTP ".concat(e.status)),P(!1);return}let o=await e.json();o.success?console.log("Hospital location updated successfully:",o.hospital):(console.error("Failed to update location:",o.message),"Hospital not found. Please log in again."===o.message&&(localStorage.removeItem("user"),console.warn("Hospital record not found. Redirecting to login..."),window.location.href="/auth?type=hospital"))}catch(e){console.error("Error updating hospital location:",e),e instanceof TypeError&&e.message.includes("fetch")&&(console.error("Network error: Could not reach backend server at http://localhost:5000. Is the server running?"),alert("Could not connect to backend server. Please ensure it's running on port 5000.")),P(!1)}},e=>{console.warn("Geolocation error:",e),P(!1),e.code===e.PERMISSION_DENIED?(E(!0),console.log("Location permission denied by user")):e.code===e.TIMEOUT?console.log("Location request timed out - user can retry"):console.log("Location unavailable - will prompt user to retry")},{timeout:1e4,enableHighAccuracy:!0})};(0,o.useEffect)(()=>{},[]);let X=async()=>{try{let e=await fetch("http://localhost:5000/hospital/stats");if(!e.ok){console.error("loadStats error: ".concat(e.status));return}let t=await e.json();t.success&&J(e=>({...e,donorsNearby:t.donorsNearby,avgMatchTime:t.avgMatchTime}))}catch(e){console.error("loadStats fetch error:",e)}},$=async()=>{try{let e=await fetch("http://localhost:5000/hospital/active-donors");if(!e.ok){console.error("loadActiveDonors error: ".concat(e.status));return}let t=await e.json();t.success&&U(t.donors||[])}catch(e){console.error("loadActiveDonors fetch error:",e)}},ee=async()=>{try{let e=await fetch("http://localhost:5000/request/all");if(!e.ok){console.error("loadRequests error: ".concat(e.status));return}let t=(await e.json()).requests||[];T(t);let{currentHospitalId:s,currentHospitalName:r}=K(),o=t.filter(e=>{var t;return!e.isRecipientRequest&&(e.requestedBy&&(e.requestedBy===s||(null===(t=e.requestedBy)||void 0===t?void 0:t._id)&&String(e.requestedBy._id)===String(s)||String(e.requestedBy)===String(s))||e.hospital&&r&&e.hospital===r)}),a=t.filter(e=>e.isRecipientRequest||!e.hospital||""===e.hospital),n=["fulfilled","completed","successful"],i=o.filter(e=>!e.status||!n.includes(e.status.toLowerCase())),l=a.filter(e=>!e.status||!n.includes(e.status.toLowerCase()));O(i),L(l),J(e=>({...e,totalRequests:t.length,livesSaved:Math.floor(1.5*t.length)}))}catch(e){console.error(e)}};(0,o.useEffect)(()=>{X(),$(),ee();let e=V.current;if(e)return e.on("donor_status_changed",()=>{X(),$()}),e.on("request_created",e=>{if(!e||!e._id)return;T(t=>t.some(t=>t._id===e._id)?t:(J(e=>({...e,totalRequests:e.totalRequests+1})),[e,...t]));let{currentHospitalId:t,currentHospitalName:s}=K();if(e.isRecipientRequest)e.hospital&&s&&e.hospital===s&&L(t=>t.some(t=>t._id===e._id)?t:[e,...t]);else{var r;(e.requestedBy&&(e.requestedBy===t||(null===(r=e.requestedBy)||void 0===r?void 0:r._id)&&String(e.requestedBy._id)===String(t)||String(e.requestedBy)===String(t))||e.hospital&&s&&e.hospital===s)&&O(t=>t.some(t=>t._id===e._id)?t:[e,...t])}console.log("New request created (real-time):",e)}),e.on("availability_changed",()=>{$(),X()}),e.on("request_fulfilled",e=>{O(t=>t.filter(t=>t._id!==e.requestId)),L(t=>t.filter(t=>t._id!==e.requestId)),T(t=>t.filter(t=>t._id!==e.requestId)),J(e=>({...e,totalRequests:Math.max(0,e.totalRequests-1)}))}),e.on("request_confirmed",e=>{e&&e._id&&(console.log("Request confirmation status updated:",e),O(t=>t.map(t=>t._id===e._id?{...t,confirmationStatus:e.confirmationStatus,confirmedBy:e.confirmedBy,confirmationNotes:e.confirmationNotes}:t)),L(t=>t.map(t=>t._id===e._id?{...t,confirmationStatus:e.confirmationStatus,confirmedBy:e.confirmedBy,confirmationNotes:e.confirmationNotes}:t)),T(t=>t.map(t=>t._id===e._id?{...t,confirmationStatus:e.confirmationStatus,confirmedBy:e.confirmedBy,confirmationNotes:e.confirmationNotes}:t)),J(e=>({...e,totalRequests:Math.max(0,e.totalRequests-1)})))}),e.on("donation_completed",e=>{e&&e.requestId&&(console.log("Donation completed (time reached):",e),O(t=>t.map(t=>t._id===e.requestId?{...t,confirmationStatus:"Successful",status:"Fulfilled"}:t)),L(t=>t.map(t=>t._id===e.requestId?{...t,confirmationStatus:"Successful",status:"Fulfilled"}:t)),T(t=>t.map(t=>t._id===e.requestId?{...t,confirmationStatus:"Successful",status:"Fulfilled"}:t)))}),()=>{e.off("donor_status_changed"),e.off("request_created"),e.off("availability_changed"),e.off("request_fulfilled"),e.off("request_confirmed"),e.off("donation_completed")}},[V]);let et=e=>{switch(null==e?void 0:e.toUpperCase()){case"CRITICAL":return"bg-red-600 text-white";case"HIGH":return"bg-orange-500 text-white";case"MODERATE":return"bg-yellow-500 text-white";default:return"bg-green-500 text-white"}},es=e=>"Pending"===e?"bg-yellow-100 text-yellow-700":"Fulfilled"===e?"bg-green-100 text-green-700":"bg-gray-300 text-gray-700";return(0,r.jsxs)("main",{className:"min-h-screen bg-gradient-to-br from-white via-red-50 to-white",children:[(0,r.jsx)("header",{className:"bg-gradient-to-r from-red-600 to-red-700 text-white p-6 sticky top-0 z-30 shadow-lg",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(n.Z,{className:"w-8 h-8 fill-white"}),(0,r.jsx)("h1",{className:"text-3xl font-bold",children:e})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 relative",children:[(0,r.jsx)("button",{onClick:()=>C(!I),className:"p-2 rounded-full hover:bg-red-500 transition bg-white text-red-600 w-10 h-10 flex items-center justify-center",title:"Profile menu",children:"\uD83D\uDC64"}),I&&(0,r.jsxs)("div",{className:"absolute right-0 top-12 bg-gradient-to-b from-white to-gray-50 text-gray-800 rounded-2xl shadow-2xl w-64 z-40 border border-red-100 overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-5 bg-gradient-to-r from-red-50 to-red-100 border-b-2 border-red-200",children:[(0,r.jsx)("p",{className:"font-bold text-lg text-red-700",children:e}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:j}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:k})]}),(0,r.jsxs)("div",{className:"py-2",children:[(0,r.jsxs)(b.default,{href:"/hospital/profile",className:"flex items-center gap-3 px-4 py-3 hover:bg-red-50 text-gray-800 transition border-l-4 border-transparent hover:border-red-600",onClick:()=>C(!1),children:[(0,r.jsx)(i.Z,{className:"w-5 h-5 text-red-600"}),(0,r.jsx)("span",{className:"font-medium",children:"Edit Profile"})]}),(0,r.jsxs)(b.default,{href:"/hospital/history",className:"flex items-center gap-3 px-4 py-3 hover:bg-blue-50 text-gray-800 transition border-l-4 border-transparent hover:border-blue-600",onClick:()=>C(!1),children:[(0,r.jsx)(l.Z,{className:"w-5 h-5 text-blue-600"}),(0,r.jsx)("span",{className:"font-medium",children:"View History"})]}),(0,r.jsxs)("button",{onClick:()=>{localStorage.removeItem("token"),window.location.href="/"},className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-red-100 text-gray-800 transition border-l-4 border-transparent hover:border-red-700",children:[(0,r.jsx)(d.Z,{className:"w-5 h-5 text-red-700"}),(0,r.jsx)("span",{className:"font-medium",children:"Logout"})]})]})]})]})]})}),R&&(0,r.jsx)("div",{className:"bg-blue-50 border-l-4 border-blue-600 p-4 mx-6 mt-4 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(c.Z,{className:"w-5 h-5 text-blue-600 animate-pulse"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-blue-900",children:"Enabling Location Sharing"}),(0,r.jsx)("p",{className:"text-sm text-blue-700",children:"Please allow location access so nearby recipients can find you..."})]})]})}),Z&&(0,r.jsx)("div",{className:"bg-amber-50 border-l-4 border-amber-600 p-4 mx-6 mt-4 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(u.Z,{className:"w-5 h-5 text-amber-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-amber-900",children:"Location Permission Denied"}),(0,r.jsx)("p",{className:"text-sm text-amber-700",children:"Recipients won't be able to find your hospital. Please enable location in your browser settings."})]})]}),(0,r.jsx)("button",{onClick:()=>{E(!1),Q()},className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 text-sm font-medium",children:"Retry"})]})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto p-6 space-y-12",children:[(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden border-l-4 border-red-600 grid md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"p-10",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-red-700",children:"Welcome back!"}),(0,r.jsx)("p",{className:"text-gray-700 mt-2",children:"Thanks for coordinating blood donations and saving lives."}),(0,r.jsx)("div",{className:"mt-6 flex gap-4",children:(0,r.jsxs)(b.default,{href:"/hospital/new-request",className:"bg-gradient-to-r from-red-600 to-red-700 text-white px-6 py-3 rounded-lg flex items-center gap-2 font-semibold hover:shadow-lg transition",children:[(0,r.jsx)(m.Z,{className:"w-5 h-5"})," New Request"]})})]}),(0,r.jsx)("div",{className:"bg-gradient-to-br from-red-50 via-red-100 to-red-200 flex items-center justify-center p-4 min-h-[280px]",children:B?(0,r.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",children:(0,r.jsx)("img",{src:B,alt:"Hospital profile",className:"max-w-full max-h-[250px] rounded-lg shadow-2xl object-contain"})}):(0,r.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,r.jsx)(n.Z,{className:"text-red-600 w-20 h-20"}),(0,r.jsx)("p",{className:"text-red-600 text-sm font-medium",children:"Upload your photo"})]})})]}),(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("h2",{className:"text-3xl font-bold text-red-700 flex items-center gap-2",children:[(0,r.jsx)(x.Z,{className:"w-8 h-8"}),"Active Donors Nearby"]}),(0,r.jsxs)("span",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-2 rounded-full font-semibold",children:[G.donorsNearby," Donors Online"]})]}),G.donorsNearby>0&&(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-2xl border-2 border-red-100 overflow-hidden relative z-10",style:{height:"500px"},children:(0,r.jsx)(v,{activeDonors:F})}),0===G.donorsNearby&&(0,r.jsx)("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl shadow-2xl border-2 border-amber-200 p-8 text-center",style:{height:"500px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,r.jsxs)("div",{children:[(0,r.jsx)(u.Z,{className:"w-16 h-16 mx-auto text-amber-500 mb-4"}),(0,r.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"No Donors Online"}),(0,r.jsx)("p",{className:"text-gray-600",children:"No donors are currently available in your area. Check back soon!"})]})})]}),(0,r.jsxs)("div",{className:"grid md:grid-cols-4 gap-6",children:[(0,r.jsx)(N,{icon:h.Z,label:"Donors Nearby",value:G.donorsNearby,color:"from-green-500 to-green-600"}),(0,r.jsx)(N,{icon:g.Z,label:"Avg Match Time",value:"".concat(G.avgMatchTime," min"),color:"from-red-600 to-red-700"}),(0,r.jsx)(N,{icon:p.Z,label:"Lives Saved",value:G.livesSaved,color:"from-green-500 to-green-600"}),(0,r.jsx)(N,{icon:n.Z,label:"Active Requests",value:G.totalRequests,color:"from-red-500 to-red-600"})]}),(0,r.jsx)(w,{}),(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 border-2 border-red-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,r.jsx)(g.Z,{className:"w-8 h-8 text-red-600"}),(0,r.jsx)("h2",{className:"text-3xl font-bold text-red-700",children:"Hospital Requests"})]}),0===(M||[]).length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(g.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-gray-500 text-lg",children:"No hospital requests yet"})]}):(0,r.jsx)("div",{className:"space-y-4",children:(M||[]).map((e,t)=>{var s;return(0,r.jsx)("div",{className:"p-6 border-2 border-red-100 rounded-xl hover:shadow-lg transition bg-gradient-to-r from-red-50 to-white",children:(0,r.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-4 items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1",children:"Patient Name"}),(0,r.jsx)("p",{className:"font-bold text-gray-900",children:e.recipientName||e.patientName||(null===(s=e.requestedBy)||void 0===s?void 0:s.fullName)||e.requestedByName||"N/A"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1",children:"Blood Type"}),(0,r.jsx)("p",{className:"font-bold text-red-600 text-lg",children:e.bloodType})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1",children:"Units"}),(0,r.jsx)("p",{className:"font-bold text-gray-900",children:e.unitsNeeded})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1",children:"Urgency"}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold inline-block ".concat(et(e.urgency)),children:e.urgency})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1",children:"Status"}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold inline-block ".concat(es(e.status)),children:e.status})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1",children:"Confirmation"}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold inline-block ".concat("Confirmed"===e.confirmationStatus?"bg-green-100 text-green-700":"Rejected"===e.confirmationStatus?"bg-red-100 text-red-700":"Successful"===e.confirmationStatus?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:e.confirmationStatus||"Pending"})]})]})},"h-".concat(t))})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 border-2 border-purple-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,r.jsx)(n.Z,{className:"w-8 h-8 text-purple-600"}),(0,r.jsx)("h2",{className:"text-3xl font-bold text-purple-700",children:"Recipient Requests"})]}),0===(z||[]).length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(n.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-gray-500 text-lg",children:"No recipient requests yet"})]}):(0,r.jsx)("div",{className:"space-y-4",children:(z||[]).map((e,t)=>{var s;return(0,r.jsx)("div",{className:"p-6 border-2 border-purple-100 rounded-xl hover:shadow-lg transition bg-gradient-to-r from-purple-50 to-white",children:(0,r.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-4 items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1",children:"Recipient"}),(0,r.jsx)("p",{className:"font-bold text-gray-900",children:e.recipientName||(null===(s=e.requestedBy)||void 0===s?void 0:s.fullName)||e.requestedByName||e.requesterName||("string"==typeof e.requestedBy?e.requestedBy:"N/A")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1",children:"Blood Type"}),(0,r.jsx)("p",{className:"font-bold text-red-600 text-lg",children:e.bloodType})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1",children:"Units"}),(0,r.jsx)("p",{className:"font-bold text-gray-900",children:e.unitsNeeded})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1",children:"Urgency"}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold inline-block ".concat(et(e.urgency)),children:e.urgency})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1",children:"Status"}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold inline-block ".concat(es(e.status)),children:e.status})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1",children:"Confirmation"}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold inline-block ".concat("Confirmed"===e.confirmationStatus?"bg-green-100 text-green-700":"Rejected"===e.confirmationStatus?"bg-red-100 text-red-700":"Successful"===e.confirmationStatus?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:e.confirmationStatus||"Pending"})]})]})},"r-".concat(t))})})]})]})]}),(0,r.jsx)(y.default,{})]})}function N(e){let{icon:t,label:s,value:o,color:a="from-red-500 to-red-700"}=e;return(0,r.jsxs)("div",{className:"bg-gradient-to-r ".concat(a," text-white rounded-2xl shadow-xl p-6 hover:shadow-2xl transition transform hover:scale-105"),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold",children:s}),(0,r.jsx)(t,{className:"w-6 h-6 opacity-90"})]}),(0,r.jsx)("p",{className:"text-4xl font-bold",children:o})]})}function w(){return(0,r.jsxs)("div",{className:"mt-10 p-8 bg-gradient-to-r from-white via-blue-50 to-white rounded-2xl shadow-lg border-2 border-blue-200",children:[(0,r.jsxs)("h2",{className:"text-3xl font-bold text-red-700 mb-2 flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-4xl",children:"\uD83E\uDE7A"})," Blood Compatibility Chart"]}),(0,r.jsx)("p",{className:"text-gray-600 mb-6 text-sm",children:"Understand which blood types can be used for transfusions and donations"}),(0,r.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{type:"O-",badge:"\uD83C\uDF1F Universal Donor",donate:["Everyone"],description:"Rarest hero - can save anyone",bg:"bg-gradient-to-br from-red-100 to-red-200",border:"border-red-400"},{type:"O+",badge:"Most Common",donate:["O+","A+","B+","AB+"],description:"Help positive blood types",bg:"bg-gradient-to-br from-red-100 to-red-200",border:"border-red-400"},{type:"A-",badge:"Rare Giver",donate:["A-","A+","AB-","AB+"],description:"Support 4 blood types",bg:"bg-gradient-to-br from-rose-100 to-rose-200",border:"border-rose-400"},{type:"A+",badge:"Common",donate:["A+","AB+"],description:"Help A and AB types",bg:"bg-gradient-to-br from-red-50 to-red-100",border:"border-red-300"},{type:"B-",badge:"Rare Giver",donate:["B-","B+","AB-","AB+"],description:"Support 4 blood types",bg:"bg-gradient-to-br from-rose-100 to-rose-200",border:"border-rose-400"},{type:"B+",badge:"Common",donate:["B+","AB+"],description:"Help B and AB types",bg:"bg-gradient-to-br from-red-50 to-red-100",border:"border-red-300"},{type:"AB-",badge:"Rarest",donate:["AB-","AB+"],description:"Precious for AB types",bg:"bg-gradient-to-br from-pink-100 to-pink-200",border:"border-pink-400"},{type:"AB+",badge:"\uD83C\uDF1F Universal Recipient",donate:["AB+"],description:"Can receive from anyone",bg:"bg-gradient-to-br from-red-200 to-red-300",border:"border-red-500"}].map((e,t)=>(0,r.jsxs)("div",{className:"".concat(e.bg," p-5 rounded-2xl shadow-lg border-2 ").concat(e.border," hover:shadow-xl transition-all duration-300 transform hover:scale-105"),children:[(0,r.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-bold text-2xl text-gray-900 mb-1",children:e.type}),(0,r.jsx)("span",{className:"inline-block bg-white px-3 py-1 rounded-full text-xs font-bold text-gray-700 shadow-sm",children:e.badge})]})}),(0,r.jsxs)("p",{className:"text-xs text-gray-700 font-semibold mb-3 italic",children:['"',e.description,'"']}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-bold text-gray-800 mb-2",children:"\uD83D\uDC89 Donates to:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:e.donate.map((e,t)=>(0,r.jsx)("span",{className:"px-3 py-1.5 bg-white font-bold text-gray-800 rounded-lg text-xs shadow border-2 border-gray-300",children:e},t))})]})]},t))}),(0,r.jsx)("div",{className:"mt-8 bg-gradient-to-r from-red-50 to-pink-50 rounded-xl p-5 border-l-4 border-red-600",children:(0,r.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,r.jsx)("span",{className:"font-bold text-red-700",children:"\uD83D\uDCA1 Pro Tip:"})," O- blood type donors are the most sought after because they can donate to anyone. AB+ recipients can receive from all blood types. Understanding compatibility helps you plan better blood requests."]})})]})}},819:function(e,t,s){"use strict";s.d(t,{default:function(){return g}});var r=s(7437),o=s(2265),a=s(5293),n=s(535),i=s(1994),l=s(3335);let d=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function c(e){let{className:t,variant:s,size:o,asChild:n=!1,...c}=e,u=n?a.g7:"button";return(0,r.jsx)(u,{"data-slot":"button",className:function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,l.m6)((0,i.W)(t))}(d({variant:s,size:o,className:t})),...c})}var u=s(2718),m=s(2489),x=s(1817),h=s(4743);function g(){let[e,t]=(0,o.useState)(!1),[s,a]=(0,o.useState)([]),[n,i]=(0,o.useState)(""),[l,d]=(0,o.useState)(!1),g=(0,o.useRef)(null),[p,b]=(0,o.useState)(void 0),f=()=>{var e;null===(e=g.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};if((0,o.useEffect)(()=>{f()},[s]),(0,o.useEffect)(()=>{try{let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);b(t)}}catch(e){console.warn("Failed to read user from localStorage",e),b(null)}},[]),(0,o.useEffect)(()=>{if(!p||s.length>0)return;let e=p.role||"user",r="Hi! I'm Pulse Bot, your AI assistant. I can help with donations, requests, scheduling, and more. How can I help you today?";"donor"===e?r="Hi donor! I'm Pulse Bot. I can help with eligibility, scheduling donations, and marking your availability. Are you planning to donate soon or would you like to schedule an appointment?":"hospital"===e?r="Hi hospital user! I can help you create and manage blood requests, find nearby donors, and track responses. Would you like to create a new request or view existing requests?":"recipient"===e&&(r="Hi recipient! I can assist with submitting a blood request, tracking its status, and finding nearby hospitals. Do you want to create a request now or check an existing one?"),a([{id:Date.now().toString(),text:r,sender:"bot",timestamp:new Date}]),t(!0)},[p]),null==p)return null;let y=async()=>{if(!n.trim())return;let e={id:Date.now().toString(),text:n,sender:"user",timestamp:new Date};a(t=>[...t,e]),i(""),d(!0);try{let e=null;try{let t=localStorage.getItem("user");t&&(e=JSON.parse(t))}catch(e){console.warn("Failed to parse user from localStorage",e)}let t=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n,conversationHistory:s,user:e})}),r=await t.json(),o={id:(Date.now()+1).toString(),text:r.reply||"Sorry, I couldn't process that. Please try again.",sender:"bot",timestamp:new Date};a(e=>[...e,o])}catch(t){console.error("Error sending message:",t);let e={id:(Date.now()+2).toString(),text:"Sorry, I'm having trouble connecting. Please try again later.",sender:"bot",timestamp:new Date};a(t=>[...t,e])}finally{d(!1)}};return(0,r.jsxs)(r.Fragment,{children:[!e&&(0,r.jsx)("button",{onClick:()=>t(!0),className:"fixed bottom-6 right-6 bg-gradient-to-r from-red-600 to-red-700 text-white p-4 rounded-full shadow-lg hover:shadow-xl transition hover:from-red-700 hover:to-red-800 z-40","aria-label":"Open chatbot",children:(0,r.jsx)(u.Z,{className:"w-6 h-6"})}),e&&(0,r.jsxs)("div",{className:"fixed bottom-6 right-6 w-96 max-h-96 bg-white rounded-xl shadow-2xl flex flex-col z-50 border-2 border-red-200",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-red-600 to-red-700 text-white p-4 flex justify-between items-center rounded-t-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(u.Z,{className:"w-5 h-5"}),(0,r.jsx)("h3",{className:"font-bold",children:"Pulse Bot"}),(0,r.jsx)("span",{className:"text-xs bg-red-500 px-2 py-1 rounded-full",children:"AI Assistant"}),p?(0,r.jsx)("span",{className:"text-xs capitalize bg-white/20 text-white px-2 py-1 rounded-full ml-2",children:p.role||"user"}):null]}),(0,r.jsx)("button",{onClick:()=>t(!1),className:"hover:bg-red-500 p-1 rounded transition",children:(0,r.jsx)(m.Z,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[s.map(e=>(0,r.jsx)("div",{className:"flex ".concat("user"===e.sender?"justify-end":"justify-start"),children:(0,r.jsx)("div",{className:"max-w-xs rounded-lg p-3 ".concat("user"===e.sender?"bg-red-600 text-white rounded-br-none":"bg-white text-gray-800 border border-red-200 rounded-bl-none"),children:(0,r.jsx)("p",{className:"text-sm",children:e.text})})},e.id)),l&&(0,r.jsx)("div",{className:"flex justify-start",children:(0,r.jsx)("div",{className:"bg-white text-gray-800 border border-red-200 rounded-lg rounded-bl-none p-3",children:(0,r.jsx)(x.Z,{className:"w-5 h-5 animate-spin text-red-600"})})}),(0,r.jsx)("div",{ref:g})]}),(0,r.jsx)("div",{className:"border-t border-red-200 p-4 bg-white rounded-b-lg",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),onKeyPress:e=>"Enter"===e.key&&y(),placeholder:"Ask me anything...",className:"flex-1 border border-red-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500"}),(0,r.jsx)(c,{onClick:y,disabled:l||!n.trim(),className:"bg-red-600 hover:bg-red-700 text-white p-2",children:(0,r.jsx)(h.Z,{className:"w-4 h-4"})})]})})]})]})}},8985:function(e,t,s){"use strict";s.d(t,{s:function(){return n}});var r=s(2265),o=s(8680);let a=null;function n(){let e=(0,r.useRef)(null);return(0,r.useEffect)(()=>(a||((a=(0,o.io)("http://localhost:5000",{reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:5})).on("connect",()=>{console.log("✅ Socket connected:",null==a?void 0:a.id)}),a.on("disconnect",()=>{console.log("❌ Socket disconnected")}),a.on("error",e=>{console.error("Socket error:",e)})),e.current=a,()=>{}),[]),e}},3609:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]])},7877:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]])},9397:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},525:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},5805:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[216,653,705,971,117,744],function(){return e(e.s=3599)}),_N_E=e.O()}]);