(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[226],{3033:function(e,t,s){Promise.resolve().then(s.bind(s,5431))},5431:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var n=s(7437),r=s(2265),a=s(4474),l=s(2660),o=s(8997),d=s(3609),i=s(1047),c=s(7648);let u=(0,s(166).default)(()=>s.e(251).then(s.bind(s,6251)),{loadableGenerated:{webpack:()=>[6251]},ssr:!1});function h(){let[e,t]=(0,r.useState)(null),[s,h]=(0,r.useState)("Hospital"),[x,f]=(0,r.useState)([]),[m,p]=(0,r.useState)([]),[g,j]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=localStorage.getItem("user");if(e){let s=JSON.parse(e);t(s._id||s.id||null),h(s.fullName||"Hospital")}if(!e){let e=localStorage.getItem("token");if(e)try{let s=(0,a.o)(e);t(s.userId||s._id||null)}catch(e){}}},[]),(0,r.useEffect)(()=>{s&&(j(!0),Promise.all([fetch("http://localhost:5000/request/all").then(e=>e.json()),fetch("http://localhost:5000/hospital/schedules/".concat(encodeURIComponent(s))).then(e=>e.json())]).then(e=>{let[t,n]=e;f((t.requests||[]).filter(e=>e.hospital===s));let r=n.schedules||[],a=new Date,l=new Set;p(r.filter(e=>{if(!e.status||"completed"!==e.status.toLowerCase())return!1;try{if(new Date("".concat(e.date," ").concat(e.time))>a)return!1}catch(e){return!1}let t="".concat(e.donorName,"-").concat(e.date,"-").concat(e.time);return!l.has(t)&&(l.add(t),!0)}).sort((e,t)=>{let s=new Date("".concat(e.date," ").concat(e.time));return new Date("".concat(t.date," ").concat(t.time)).getTime()-s.getTime()})),j(!1)}).catch(e=>{console.error("Error fetching history:",e),j(!1)}))},[s]),(0,n.jsxs)("main",{className:"min-h-screen bg-gradient-to-br from-white via-red-50 to-white",children:[(0,n.jsx)("header",{className:"bg-gradient-to-r from-red-600 to-red-700 text-white p-6 sticky top-0 z-30 shadow-lg",children:(0,n.jsxs)("div",{className:"max-w-6xl mx-auto flex items-center gap-4",children:[(0,n.jsx)(c.default,{href:"/hospital/dashboard",className:"hover:opacity-80 transition",children:(0,n.jsx)(l.Z,{className:"w-6 h-6"})}),(0,n.jsx)(o.Z,{className:"w-8 h-8 fill-white"}),(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Hospital History"})]})}),(0,n.jsx)("div",{className:"max-w-6xl mx-auto p-6",children:g?(0,n.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,n.jsx)("p",{className:"text-gray-600 text-lg",children:"Loading history..."})}):(0,n.jsxs)("div",{className:"space-y-8",children:[x.length>0?(0,n.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 border-2 border-red-200",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,n.jsx)(d.Z,{className:"w-8 h-8 text-red-600"}),(0,n.jsx)("h2",{className:"text-3xl font-bold text-red-700",children:"Blood Requests Created"})]}),(0,n.jsx)("div",{className:"space-y-4",children:x.map((e,t)=>{var s;return(0,n.jsxs)("div",{className:"p-6 border-2 border-red-100 rounded-xl hover:shadow-lg transition",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-2xl font-bold text-red-700",children:e.bloodType}),(0,n.jsxs)("p",{className:"text-gray-600 mt-1",children:[e.unitsNeeded," units needed"]})]}),(0,n.jsx)("span",{className:"px-4 py-2 rounded-full font-semibold text-sm ".concat("critical"===e.urgency?"bg-red-100 text-red-700":"high"===e.urgency?"bg-orange-100 text-orange-700":"bg-yellow-100 text-yellow-700"),children:(null===(s=e.urgency)||void 0===s?void 0:s.toUpperCase())||"NORMAL"})]}),(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 mb-4 text-gray-700",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(i.Z,{className:"w-5 h-5 text-red-600"}),(0,n.jsx)("span",{children:new Date(e.createdAt).toLocaleDateString()})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(o.Z,{className:"w-5 h-5 text-red-600"}),(0,n.jsxs)("span",{children:["Status: ",e.status||"Pending"]})]})]}),e.location&&e.location.latitude&&e.location.longitude?(0,n.jsx)("div",{className:"mt-4 h-48 overflow-hidden rounded-lg border-2 border-red-100",children:(0,n.jsx)(u,{activeDonors:[{location:e.location,fullName:e.hospital}]})}):null]},t)})})]}):(0,n.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 border-2 border-red-200 text-center",children:[(0,n.jsx)(d.Z,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600 text-lg",children:"No blood requests created yet"})]}),m.length>0?(0,n.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 border-2 border-green-200",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,n.jsx)(i.Z,{className:"w-8 h-8 text-green-600"}),(0,n.jsx)("h2",{className:"text-3xl font-bold text-green-700",children:"Completed Donations"})]}),(0,n.jsx)("div",{className:"space-y-4",children:m.map((e,t)=>(0,n.jsxs)("div",{className:"p-6 border-2 border-green-100 rounded-xl hover:shadow-lg transition",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"text-xl font-bold text-green-700",children:["Donor: ",e.donorName]}),(0,n.jsxs)("p",{className:"text-gray-600 mt-1",children:["Blood Type: ",e.bloodType]})]}),(0,n.jsx)("span",{className:"px-4 py-2 rounded-full font-semibold text-sm bg-green-100 text-green-700",children:"COMPLETED"})]}),(0,n.jsxs)("div",{className:"grid md:grid-cols-3 gap-4 text-gray-700",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(i.Z,{className:"w-5 h-5 text-green-600"}),(0,n.jsxs)("span",{children:[e.date," at ",e.time]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(d.Z,{className:"w-5 h-5 text-green-600"}),(0,n.jsxs)("span",{children:[e.unitsNeeded," units collected"]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(o.Z,{className:"w-5 h-5 text-green-600"}),(0,n.jsx)("span",{children:"Successfully donated"})]})]})]},t))})]}):(0,n.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 border-2 border-green-200 text-center",children:[(0,n.jsx)(i.Z,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600 text-lg",children:"No completed donations yet"})]})]})})]})}},2660:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1047:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(9205).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},3609:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(9205).Z)("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]])},8997:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(9205).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},166:function(e,t,s){"use strict";s.d(t,{default:function(){return r.a}});var n=s(5775),r=s.n(n)},5775:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a}});let n=s(7043);s(7437),s(2265);let r=n._(s(5602));function a(e,t){var s;let n={loading:e=>{let{error:t,isLoading:s,pastDelay:n}=e;return null}};"function"==typeof e&&(n.loader=e);let a={...n,...t};return(0,r.default)({...a,modules:null==(s=a.loadableGenerated)?void 0:s.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},1523:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return r}});let n=s(8993);function r(e){let{reason:t,children:s}=e;if("undefined"==typeof window)throw new n.BailoutToCSRError(t);return s}},5602:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i}});let n=s(7437),r=s(2265),a=s(1523),l=s(49);function o(e){return{default:e&&"default"in e?e.default:e}}let d={loader:()=>Promise.resolve(o(()=>null)),loading:null,ssr:!0},i=function(e){let t={...d,...e},s=(0,r.lazy)(()=>t.loader().then(o)),i=t.loading;function c(e){let o=i?(0,n.jsx)(i,{isLoading:!0,pastDelay:!0,error:null}):null,d=t.ssr?(0,n.jsxs)(n.Fragment,{children:["undefined"==typeof window?(0,n.jsx)(l.PreloadCss,{moduleIds:t.modules}):null,(0,n.jsx)(s,{...e})]}):(0,n.jsx)(a.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(s,{...e})});return(0,n.jsx)(r.Suspense,{fallback:o,children:d})}return c.displayName="LoadableComponent",c}},49:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return a}});let n=s(7437),r=s(544);function a(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let s=(0,r.getExpectedRequestStore)("next/dynamic css"),a=[];if(s.reactLoadableManifest&&t){let e=s.reactLoadableManifest;for(let s of t){if(!e[s])continue;let t=e[s].files.filter(e=>e.endsWith(".css"));a.push(...t)}}return 0===a.length?null:(0,n.jsx)(n.Fragment,{children:a.map(e=>(0,n.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:s.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},4474:function(e,t,s){"use strict";s.d(t,{o:function(){return r}});class n extends Error{}function r(e,t){let s;if("string"!=typeof e)throw new n("Invalid token specified: must be a string");t||(t={});let r=!0===t.header?0:1,a=e.split(".")[r];if("string"!=typeof a)throw new n(`Invalid token specified: missing part #${r+1}`);try{s=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var s;return s=t,decodeURIComponent(atob(s).replace(/(.)/g,(e,t)=>{let s=t.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}catch(e){return atob(t)}}(a)}catch(e){throw new n(`Invalid token specified: invalid base64 for part #${r+1} (${e.message})`)}try{return JSON.parse(s)}catch(e){throw new n(`Invalid token specified: invalid json for part #${r+1} (${e.message})`)}}n.prototype.name="InvalidTokenError"}},function(e){e.O(0,[216,971,117,744],function(){return e(e.s=3033)}),_N_E=e.O()}]);